# SC-300 Practice Test 155 Questions

[Microsoft Certified: Security Operations Analyst Associate](https://learn.microsoft.com/en-us/credentials/certifications/security-operations-analyst/?practice-assessment-type=certification)  

---

## Q00X:

---

### Answer:

---

### References

---

## Q009-Q012:

> General Backgrounf

You work at a company that specializes in managing information systems. The company's main office is based in your region and has several branches outside your country. The company uses Microsoft Sentinel.

> Current Environment

- A user in the IT department has created a storage account in Azure for their own personal use without their coordinator noticing.

- A member of the accounting team reports that several workbooks related to customers' data have been deleted in the Microsoft Sentinel workspace of the company.

- A member of the IT department reports that five incidents of high severity occurred in the past week.

- A new employee starts working at your company. You create a new account for the employee in Microsoft Entra ID. A colleague of the new employee reports that the new employee created a role assignment the moment they started working on their company device.

> New Environment

- An analytics rule should be created where the rule query logic will alert the IT coordinator when any user creates a storage account.

- The manager wants to view all delete operations performed in the company's Microsoft Sentinel workspace.

- The manager wants to run an investigation about the incidents occurring within the past 10 days so better analysis can be achieved.

- The manager wants to know when any new user in Microsoft Entra ID creates a role assignment.

---

## Q012:

You need to create a query for the rule logic to alert the IT coordinator when a storage account is created, as requested.
How should you complete the query? To answer, complete the commands by selecting the correct parts from the drop-down menus.

OPT1:
OperationName
Update Case Comments
Update Cases

OPT2:
ActivityStatusValue
OperationName
Update Settings

```
AzureActivity
| where [OPT1] == "Create Storage Account"
| where [OPT2] == "Succeeded"
| make-series dcount (ResourceId) default=0 on EventSubmissionTimestamp
in range (ago (7d), now(), 1d) by Caller
```

```
AzureActivity
| where OperationName == "Create Storage Account"
| where ActivityStatusValue == "Succeeded"
| make-series dcount (ResourceId) default=0 on EventSubmissionTimestamp
in range (ago (7d), now(), 1d) by Caller
```

---

### Answer:

You should complete the query as follows:

```
AzureActivity 
| where OperationName == "Create Storage Account 
| where ActivityStatusValue == "Succeed"
| make-series dcount (Resourceld) default=0 on EventSubmissionTimestamp in range (ago (7d), now(), id) by Caller
```

You should use OperationName in the first line. This expression is a required expression in the query for the
rule being created. OperationName is the expression that is used to define the operation that the IT
coordinator should be notified about. You can see that the expression is followed by the Create Storage Account expression, so the coordinator will be notified upon the creation of a storage account, as requested.
You should not use Update cases in the first line. This expression defines the action of updating a case when you investigate it. This is part of the Security Insights category, not Azure Activity.
You should not use Create case comments in the first line. This expression defines the action of creating comments for cases being investigated, which is a beneficial activity while investigating a case. This activity is also part of the Security Insights category and not Azure Activity.
You should use Activity Status Value in the second line. This expression is required in the above query to define if the activity performed by the user succeeded and, for example, if account storage is created. In such a way, the rule would detect that the activity has been done successfully in order to inform the IT coordinator about it. The Activity Status Value expression can be followed by succeeded or failed expressions. The last portion of the provided query is also required to count all the records within your Azure that match the conditions you specify related to the defined activity of creating a storage account during the specified time frame.
You should not use OperationName in the second line. This expression is used to define the activity performed by a user, as seen in the first line. There is no 'succeeded' operation or activity in the query.
You should not use Update settings in the second line. This expression defines the activity of updating settings in Security Insights. It cannot be used here for two reasons: the first is that this is not the required activity, and the second is that this expression cannot be used to define if the operation succeeded or not.

---

### References

[Audit Microsoft Sentinel queries and activities](https://learn.microsoft.com/en-us/azure/sentinel/audit-sentinel-data)  
[Azure Sentinel Create custom analytics rules to detect threats](https://connectioncloudsupport.zendesk.com/hc/en-us/articles/900006664846-Azure-Sentinel-Create-custom-analytics-rules-to-detect-threats#:~:text=Azure%20Sentinel%20-%20Create%20custom%20analytics%20rules%20to,5%20View%20the%20rule%20and%20its%20output%20)  

---

## Q011:

You need to use the AzureActivity table query to fulfill the manager's request of viewing delete operations.

```
AzureActivity
| where OperationNameValue contains "?"
| where OperationName contains "?"
| where ActivityStatusValue contains "Succeeded"
```

Which two sections of code should you use to complete the query? 
Each correct answer presents part of the solution.

- ago(1d)
- SecurityInsights
- Delete alert rules
- Delete data connectors
- Delete workflow
- Delete

---

### Answer:
- SecurityInsights
- Delete

You should complete the query as follows:

1. AzureActivity
2. | where OperationNameValue contains "SecurityInsights"
3. | where OperationName contains "Delete"
4. | where ActivityStatusValue contains "Succeeded"

You should use SecurityInsights in line 2. This filter condition narrows down the results to only those logs where the OperationNameValue field contains the term SecurityInsights. This ensures that only activities related to security insights are included in the results.
Additionally, you should use Delete in line 3. This further filters the logs to only include records where the Operation Name field contains the term Delete. This filters for delete operations specifically, such as deleting resources or configurations related to security insights.
You should not use ago(1d). This expression is used to define time. This expression could be used in another query that states, for example, the operations carried out in the workspace in the past 24 hours. In this scenario, you need to define where you can view delete operations.
You should not use Delete workflow. This expression defines the activity of deleting a workflow in Microsoft Sentinel performed by a user. This expression is not related to deleting a workbook. Workflows in Microsoft Sentinel are created for several reasons, such as to create an automated response for alerts where Microsoft Sentinel acts upon suspicious activity done by a user.
You should not use Delete data connectors. This expression is related to the operation of deleting a data connector. Data connectors are used to connect data resources with each other upon implementing Microsoft Sentinel. This operation is not mentioned in the scenario.
You should not use Delete alert rules. This expression is related to deleting alert rules. Alert rules are configured within analytics rules to alert the user when a match occurs. Analytic rules detect and identify threats by matching the presence of signs and signals that impact the existence of a cyber-attack. They can also identify the origin of a cyber-attack and the potential loss of data that occurred due to the attack. This is not a mentioned requirement in the scenario.


---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  
[Audit Microsoft Sentinel queries and activities](https://learn.microsoft.com/en-us/azure/sentinel/audit-sentinel-data)  

---

## Q010:

You need to find a solution that provides data for the manager about creating new role assignments.
What action should you perform?

- Use the SecurityIncident table in Microsoft Sentinel.
- Use data retention in Microsoft Defender for Endpoint.
- Use a Windows Security Events connector.
- Use Azure Lighthouse.

---

### Answer:
- Use the SecurityIncident table in Microsoft Sentinel.

You should use the SecurityIncident table in Microsoft Sentinel. This table is found in the Logs section in Microsoft Sentinel, where you can view all the incidents that are created or updated, including those related to creating role assignments by new users. This meets the scenario requirement. Every time an incident is created or updated, a new log is added to the SecurityIncident table.
You should not use data retention in Microsoft Defender for Endpoint. Data retention is used for retaining data, like documents and files, that you need, and getting rid of items that you do not need. Data retention cannot be used to view the logs of creating a new role assignment.
You should not use Azure Lighthouse. Azure Lighthouse is a solution that allows you to manage an Microsoft Sentinel workspace outside your tenant. Microsoft Sentinel is a security information event management (SIEM) system that provides security analytics for companies. Azure Lighthouse will not provide data about creating new role assignments.
You should not use a Windows Security Events connector. Windows Security Events connector is used to stream security events from any Windows server linked with your Microsoft Sentinel workspace. Nothing in the scenario mentions a Windows server.


---

### References

[Manage your SOC better with incident metrics](https://learn.microsoft.com/en-us/azure/sentinel/manage-soc-with-incident-metrics)  

[Configure general Defender for Endpoint settings](https://learn.microsoft.com/en-us/defender-endpoint/preferences-setup)  

[Using Azure Lighthouse and Microsoft Sentinel to Investigate Attacks Across Multiple Tenants](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/using-azure-lighthouse-and-azure-sentinel-to-investigate-attacks/ba-p/1043899)  

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference?tabs=LAA)  

---

## Q009:

You need to recommend a solution that enables you to run an investigation as required by the manager.

Which solution should you recommend?

- Create a hunting bookmark.
- Use Microsoft Graph.
- Create a workbook in Microsoft Sentinel.
- Use Data Loss Prevention (DLP) Policies.

---

### Answer:
- Create a workbook in Microsoft Sentinel.

You should recommend creating a workbook in Microsoft Sentinel. Workbooks in the Azure portal provide a broad canvas for data analysis and the production of sophisticated visual reports. They enable you to connect to numerous data sources throughout Azure and integrate them into cohesive interactive experiences. In addition to that, they use queries to run investigations related to incidents occurring in the company within a defined time frame, such as 10 days before the incident occurred. This option meets the scenario requirement.
You should not recommend creating a hunting bookmark. Hunting bookmarks are a Microsoft Sentinel tool that allow you to preserve queries that have already run in the Microsoft Sentinel - Logs service, in addition to the query results. This solution also allows you to add notes and tags in order to record your contextual observations for incidents. This does not meet the scenario requirement.
You should not recommend using Data Loss Prevention (DLP) policies. Using a DLP policy will allow you to ban the accidental sharing of sensitive information with people outside the organization. DLP can display a pop-up tip to employees to warn them about possible attempts to share sensitive data with people outside the organization. This solution does not allow you to run an investigation as required by the manager.
You should not recommend using Microsoft Graph. Microsoft Graph is a tool that enables users to create solutions that are authenticated once and use a single API call to act on security insights from security solutions. It does not allow you to run an investigation as required by the manager.

---

### References

[Visualize collected data](https://learn.microsoft.com/en-us/azure/sentinel/get-visibility)  

[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  

[Learn about Endpoint data loss prevention](https://learn.microsoft.com/en-us/purview/endpoint-dlp-learn-about?view=o365-worldwide)  

[Keep track of data during hunting with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/bookmarks)  

---

## Q006-Q008:

Your organization is a Managed Service Provider (MSP) tasked with managing Microsoft Sentinel workspaces for multiple customers. Many customers require the management of multiple workspaces for different environments or business units.
You need to manage Microsoft Sentinel workspaces across multiple Microsoft Entra tenants. The precise control over the delegated scopes and allowed permissions for each customer must be maintained.

---

## Q008:

Solution: Extend Microsoft Sentinel accross workspaces

Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. While extending Microsoft Sentinel across workspaces enables a unified incident view across multiple workspaces, and facilitating centralized management and monitoring of incidents, it operates seamlessly within a single Microsoft Entra tenant.

---

### References

[Extend Microsoft Sentinel across workspaces and tenants](https://learn.microsoft.com/en-us/azure/sentinel/extend-sentinel-across-workspaces-tenants)  

---

## Q007:

Solution: Use workspace manager

Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Workspace Manager is a feature within the Microsoft Sentinel service that enables organizations to manage multiple workspaces for different environments or business units within a single Microsoft Entra tenant.

---

### References

[Centrally manage multiple Microsoft Sentinel workspaces with workspace manager](https://learn.microsoft.com/en-us/azure/sentinel/workspace-manager) 

---

## Q006:

Solution: Use Azure Lighthouse

Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. Azure Lighthouse is a suitable solution for managing Microsoft Sentinel workspaces across multiple Microsoft Entra tenants. Azure Lighthouse allows Managed Service Providers (MSPs) to manage customers' Azure resources from their own Microsoft Entra tenant, including Microsof Sentinel workspaces. With Azure Lighthouse, precise control over the delegated scopes and allowed permissions for each customer is maintained.

---

### References

[What is Azure Lighthouse?](https://learn.microsoft.com/en-us/azure/lighthouse/overview)  

---

## Q001-Q005:

> Overview

You are a Security & Compliance Analyst for CompanyA, which has an existing Microsoft 365 tenant. CompanyA has recently migrated its services to Microsoft 365 and is using the following services:

- Microsoft Entra ID to manage identity
- OneDrive for Business to facilitate users' home folders
- Exchange Online for email services
- SharePoint Online for document management
- Microsoft Teams to facilitate collaboration between internal teams and external partners

Now that the services are active, your organization has asked you to look at deploying Microsoft Defender for Endpoint to help to protect and remediate security issues on end-user devices. As the Security & Compliance Analyst, you are responsible for managing the security and compliance posture of the tenant.

> Existing Environments

The following table shows details of Microsoft Defender for Endpoint permissions for users:

|   Username  | Permissions |
|------------ | ----------- |
| AdminA@companyA.com  | Full access |
| AdminB@companyA.com  | Read-only Access |
| AdminC@companyA.com  | Read-only access |
| AdminD@CompanyA.com  | Full access |


The following table shows the end-user device details:

| Device Type | Operating System | OS Version | No. of devices |
|-------------|------------------|------------|----------------|
| Laptop      | Windows 10       | 1511       | 150 |
| Laptop      | Windows 10       | 1607       | 850 |
| Desktop     | Windows 10       | 1511       | 200 |

- Old third party antivirus has been removed from Desktop devices and substituted with Microsoft Defender Antivirus.
- Microsoft Defender Antivirus has recently been deployed to all Laptop Windows 10 OS devices.
- Cloud-based protection is enabled.
- The Microsoft Defender for Endpoint blocking file features are configured.

The following table shows the device browser details:


| Operating System  | No. of Devices  | Installed Browser Details|
|-------------------|---------------------|----------------------|
| Windows 10        | 150  | Microsoft Edge, Mozilla Firefox     |
| Windows 10        | 850  | Google Chrome, Mozilla Firefox      |
| Windows 10        | 200  | Mozilla Firefox                     |

- All users have the Microsoft Defender for Endpoint Plan 2 license.
- All installed browsers are configured with Internet browsing proxy settings.
- All users can access to the internet using respective browser installed on their systems.

> Requirements:

- AdminC is new to the team and requires the relevant permissions to be assigned.
- You need to ban potentially malicious files or suspected malware.
- You need to onboard all end-user devices into the Defender for Endpoint portal.
- You need to implement real-time endpoint detection and built-in remediation via Intune to add an additional layer of protection to devices.
- You need to configure device isolation to help to prevent attackers from being able to control devices.

---

## Q005:

AdminD configures device isolation on the end-user devices. However, during testing you find that it is not working on any of the devices.
What is the cause for the device isolation failing to work?

- The Windows 10 devices need to be upgraded to Windows 11.
- You need a Microsoft 365 E5 license.
- The Windows 10 devices need to be version 1703 or later.
- AdminD needs elevated permissions to the Microsoft Defender for Endpoint portal.

---

### Answer:
- The Windows 10 devices need to be version 1703 or later.

Windows 10 devices need to be version 1703 or later. Full isolation of devices is available for devices running Windows 11, Windows 10, version 1703 or later, Windows Server 2022, Windows Server 2019, and Windows Server 2016.
The fact that AdminD requires elevated permissions to the Microsoft Defender for Endpoint portal is not the cause of the issue. As shown in the permissions table, AdminD has full access, which will allow them to successfully implement device isolation.
Windows 10 devices does not need to be upgraded to Windows 11. Although this would resolve the issue, it is not a requirement, as the devices need to be Windows 10 version 1703 or later. Upgrading to Windows 11 would be an option but not a requirement.
You do not need a Microsoft 365 E5 license. As shown in the Existing Environment section, users currently have Microsoft Defender for Endpoint Plan 2, which is sufficient to allow the implementation of device isolation.

---

### References

[Take response actions on a device](https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts?view=o365-worldwide)  


---

## Q004:

Once the end-user devices have been correctly onboarded, you need to configure additional capabilities to meet the business requirements.
Which capability should you configure to add the requirement for an additional layer of protection to devices?

- Next-Generation Protection (NGP)
- Microsoft Defender Vulnerability Management
- Microsoft Defender Experts capability
- Attack Surface Reduction

---

### Answer:
- Microsoft Defender Vulnerability Management

You should configure Microsoft Defender Vulnerability Management to meet the requirements for real-time endpoint detection and built-in remediation via Intune. This is a component of Defender for Endpoint that provides admins and operators with many features including built-in remediation.
You should not configure Next-Generation Protection (NGP) to meet the requirements for real-time endpoint detection and built-in remediation via Intune. NGP is a feature of Microsoft Defender Antivirus that enables next generation protection of end-user devices. As the requirement is for real-time endpoint detection and built-in remediation via Intune, NGP does not allow to facilitate these specific requirements.
You should not configure Attack Surface Reduction to meet the requirements for real-time endpoint detection and built-in remediation via Intune. Attack Surface Reduction enables attack surface reduction capabilities in Defender for Endpoint to help protect devices and application from new emerging threats. As the requirement is for real-time endpoint detection and built-in remediation via Intune, Attack Surface
Reduction does not allow to facilitate these specific requirements.
You should not configure Microsoft Defender Experts capability to meet the requirement for real-time endpoint detection and built-in remediation via Intune. This is a managed hunting service that enables SOC team's expert level monitoring and analysis to assist them with critical threats.

---

### References

[Configure Microsoft Defender for Endpoint capabilities](https://learn.microsoft.com/en-us/defender-endpoint/onboard-configure?view=o365-worldwide)  


---

## Q003:

AdminD is working on onboarding all end-user devices in the Microsoft Defender for Endpoint portal. However, they find that 200 of the devices are not being displayed in the portal. You need to investigate the issue.

Which two actions should you perform to successfully onboard end-user devices in the Microsoft Defender for Endpoint? Each correct answer presents part of the solution.

- Ensure the devices have an internet connection.
- Verify the Microsoft Windows HTTP (WinHTTP) settings.
- Ensure that Microsoft Defender Antivirus is not disabled by a policy.
- Ensure Google Chrome is installed.
- Ensure Internet Explorer is installed.

---

### Answer:
- Verify the Microsoft Windows HTTP (WinHTTP) settings.
- Ensure that Microsoft Defender Antivirus is not disabled by a policy.

You should Verify the Microsoft Windows HTTP (WinHTTP) settings. WinHTTP provides a standardized interface to send HTTP and HTTPS requests and receive responses from web servers. In order to report sensor data and communicate with the Microsoft Defender for Endpoint service, the use of Microsoft Windows HTTP (WinHTTP) is required by the sensor of Microsoft Defender for Endpoint. Because WinHTTP operates independently from the proxy settings used for internet browsing and other applications that are context-dependent, it is necessary for WinHTTP to identify the available proxy servers within the specific environment it is being used in.
You should also ensure that Microsoft Defender Antivirus is not disabled by a policy. To function correctly, the Microsoft Defender for Endpoint agent requires the Early Launch Antimalware (ELAM) driver to be activated. It is important to confirm that a system policy has not disabled it. Depending on the policy implementation tool being used, it is necessary to check that the Windows Defender policies listed below are not enabled:

- DisableAntiSpyware
- Disable AntiVirus

Because old third party antivirus has been removed from Desktop devices and substituted with Microsoft Defender Antivirus, it is possible, that the above mentioned policies are still activated as a previous requirement for removed third party antivirus software. As such, the policy have to be verified and disabled.
You should not ensure that devices have internet connection. According to the Existing environment section, all users can access the internet using respective browser installed on their systems.
You should not ensure that any specific browser is installed. Onboarding into Microsoft Defender for Endpoint does not specify any specific browser requirements. Specific browser only required to access Microsoft Defender for Endpoint administration portal, but not for onboarding.

---

### References

[Troubleshoot Microsoft Defender for Endpoint onboarding issues](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-onboarding)  

[About WinHTTP](https://learn.microsoft.com/en-us/windows/win32/winhttp/about-winhttp)  

[Minimum requirements for Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/minimum-requirements?view=o365-worldwide)  

---

## Q002:

You need to use PowerShell to assign AdminC the relevant permissions to the Microsoft Defender for Endpoint portal.
Which cmdlets should you use? To answer, complete the commands by selecting the correct options from the drop-down menus.

OPT1:

Add-MsolRoleMember
Get-MsolRoleMember
Add-MsolGroupMember
New-MsolUser

OPT2:

"Security Reader"
"Compliance Reader"
"Security Operator"
"Security Administrator"

OPT3:

-RoleMemberEmailAddress
-RoleMemberType
-RoleMemberObjectId
-TenantId

```
[OPT1] -RoleName [opt2] [OPT3] "AdminC@companyA.com"
```

---

### Answer:

```
Add-MsolRoleMember -RoleName "Security Reader" `
-RoleMemberEmailAddress  "AdminC@companyA.com" 
```

You should complete the PowerShell cmdlet as follows:

```
Add-MsolRoleMember -RoleName "Security Reader" -RoleMemberEmailAddress "AdminC@companyA.com"
```

You need to use the Add-MsolRoleMember cmdlet. This allows you to add a user with an administrator role. In this case, you need to grant AdminC read only permissions. Therefore, you should use the 'Security Reader' RoleName parameter. Finally, you need to use the - RoleMemberEmailAddress parameter to specify AdminC's email address so that the permissions are granted to them.
You should not use the Add-MsolGroupMember cmdlet, as this adds users to an existing security group. The Get-Msol RoleMember group should not be used as this only gives you information on a specific role, rather than allowing you to assign permissions. The New-MsolUser should not be used as this allows you to create a new user in Azure AD, rather than adding elevated permissions to a user.
You should not use the 'Security Administrator' parameter, as this would grant AdminC full access to the Microsoft Defender for Endpoint portal. The 'Security Operator' role would also give AdminC more elevated permissions than read only. The 'Compliance Admin' role would give AdminC access to the Microsoft Purview Compliance portal, not the Microsoft Defender for Endpoint portal.
You should not use the -Tenantld, RoleMember Objectld or the RoleMemberType parameter, as these parameters would not assign the relevant permissions to the user via the email address that has been used in the cmdlet.

---

### References

[Use basic permissions to access the portal](https://learn.microsoft.com/en-us/defender-endpoint/basic-permissions?view=o365-worldwide)  

Add-MsolRoleMember
Add-MsolGroup Member
Get-MsolRoleMember
New-MsolUser

---

## Q001:

AdminA tries to implement indicators for files in order to ban potential malicious files or suspected malware However, you find that it does not work on the existing user devices.

Which action should you take to implement indicators for files? 
You need to minimize administrative effort.

- Upgrade Windows 10 to Windows 11.
- Upgrade Windows 10 to version 1703 or later.
- Give AdminA more elevated permissions.
- Upgrade Microsoft Defender Antivirus to client version 4.18.1901.x or later.

---

### Answer:
- Upgrade Windows 10 to version 1703 or later.

You should upgrade Windows 10 OS to version 1703 or later. A prerequisite of implementing indicators for files is that end-user devices are required to be Windows 10, version 1703 or later. The Windows Server supported OS are Server 2016 and 2019.
You should not upgrade Windows 10 to Windows 11. Although this would resolve the issue, upgrading Windows 10 to Windows 11 would create additional administrative effort compared to upgrading the Windows 10 OS version, which is a simple Windows update.
You should not upgrade Microsoft Defender Antivirus to client version 4.18.1901.x or later. As highlighted in the existing environment section, Microsoft Defender Antivirus has recently been installed. The latest
versions are more recent than version 4.18.1901.x.
You should not elevate AdminA's permissions. AdminA currently has full access to the Microsoft Defender for Endpoint portal, which grants them the relevant permissions to implement indicators for files.

---

### References

[Manage indicators](https://learn.microsoft.com/en-us/training/modules/configure-settings-for-alerts-detections-microsoft-defender-for-endpoint/5-manage-indicators)  

---