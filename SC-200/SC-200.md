# SC-300 Practice Test 155 Questions

[Microsoft Certified: Security Operations Analyst Associate](https://learn.microsoft.com/en-us/credentials/certifications/security-operations-analyst/?practice-assessment-type=certification)  

---

## Q015X:

---

### Answer:

---

### References

---

## Q0155:

You are editing a workbook and you want to add a static element that displays the label of the current time range that is selected.
You add a text control to the workbook.
You need to add the correct TimeRange parameters.
Which two parameters should you use? Each correct answer presents part of the solution.

Choose the correct answers

- (TimeRange:value)
- {TimeRange:query)
- (TimeRange:label}
- (TimeRange)

---

### Answer:
- (TimeRange:label}
- (TimeRange)


You should use (TimeRange). (TimeRange) is the basic Time range picker parameter type that simply displays the selected time range label.
You should also use (TimeRange:label). (TimeRange:label) is the basic Time range picker parameter type with the label option appended to it. This syntax accomplishes the same as the regular (TimeRange) selection, but it can be helpful in clarifying that your goal is to simply display the label.
You should not use (TimeRange:query). This parameter will display the exact Kusto Query Language (KQL) text string that was used in the parameter's function. For example, if you are looking at the last 24 hours, it would display > ago(1d).
You should not use (TimeRange:value). This parameter will display the value from the query, which in the case of TimeRange will always be identical to the (TimeRange:query) string.

---

### References

[Workbook time parameters](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-time)

---

## Q0154:

You are creating a custom workbook in Microsoft Sentinel.
You need to add a parameter that allows workbook users to filter by Azure resources from a drop-down list.
Which four actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions
Select Drop down for the Parameter type.
Select Add query.

Actions in order

1. Select Add parameters.
2. Click the blue Add Parameter button on the top banner.
3. Select Resource picker for the Parameter type.
4. Click Save.

---

### Answer:

You should perform the following steps in order:

1. Select Add parameters.
2. Click the blue Add Parameter button on the top banner.
3. Select the Resource picker parameter type.
4. Click Save.

Parameters allow you to select values that can be used to alter the scope of the data shown in a workbook. Parameters can be used for nearly infinite filtering possibilities, such as setting time ranges to view data or narrowing the workbook to only show certain resource groups. In this scenario, you need to use parameters to filter data by resources from a drop-down list.
First, you should select Add parameters in the workbook. This will indicate that you are looking to add a parameter, and the Add Parameter button will pop up on the banner.
Then you should click the blue Add Parameter button on the top banner. This will bring you to the actual parameter creation screen where you can select the specific parameter you want to add.
Next, you should select the Resource picker parameter type. This parameter type will add a drop-down to your workbook that allows the user to filter by resource, as per the requirements of the scenario.
Finally, you should click Save. This finalizes all settings for the new parameter and adds it to the workbook.
You should not select Drop down for the Parameter type. The Resource picker parameter type is by default always a drop-down list. The Drop down parameter type is a legitimate parameter type, but it has a different function. You can use this parameter type to integrate user/app generated values in the parameter drop- downs.
You should not select Add query. Queries use Kusto Query Language (KQL) to parse workbook data. They control what data is seen before any filters (added via parameters) are applied.

---

### References

[Commonly used Microsoft Sentinel workbooks](https://learn.microsoft.com/en-us/azure/sentinel/top-workbooks)  

[Workbook parameters](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-parameters)  

[Workbook resource parameters](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-resources)  

---

## Q0153:

You want to improve your Microsoft Sentinel workbook based on user feedback. You want to add more parameters to make data filtering more effective and relevant.
You need to ensure that users are able to view the workbook data of the last 24 hours, the last 48 hours, or the last seven days by choosing from a drop-down list. The solution should minimize the administrative effort.

Which two actions should you perform? Each correct answer presents part of the solution.

Choose the correct answers

- Select Drop down as the parameter type.
- Select the checkboxes next to 24 hours, 48 hours, and Allow custom time range under Available time ranges.
- Select the Time range picker parameter type.
- Select the checkboxes next to 24 hours, 48 hours, and 7 days under Available time ranges.

---

### Answer:
- Select the Time range picker parameter type.
- Select the checkboxes next to 24 hours, 48 hours, and 7 days under Available time ranges.

Parameters allow you to select values that can be used to alter the scope of the data shown in a workbook. Parameters can be used for setting time ranges to view data, selecting which subscriptions and/or resource groups should be included in the workbook data, and an infinite number of other filtering possibilities. All parameters are presented as drop-down lists that can be placed at the top of a workbook.
You should select the Time range picker parameter type under the Settings section. This parameter type allows you to filter time ranges via a drop-down list.
You should also select the checkboxes next to 24 hours, 48 hours, and 7 days under Available time ranges. This section is not available if you choose Drop down as the parameter type.
You should not select Drop down as the parameter type. The Time range picker parameter type is always a drop-down list, by default. The Drop down parameter type is a legitimate parameter type, but it has a different function. You can use this parameter type to integrate user/app generated values in the parameter drop-downs.
You should not select the checkboxes next to 24 hours, 48 hours, and Allow custom time range under Available time ranges. The Available time ranges section offers a wide variety of time ranges (from the last five minutes to the last 90 days). If one of the options you want to add is not on the list, you can add it yourself by marking the Allow custom time range selection checkbox. Since 7 days is an option on the Available time ranges section, marking the Allow custom time range selection is not a required action.

---

### References

[Commonly used Microsoft Sentinel workbooks](https://learn.microsoft.com/en-us/azure/sentinel/top-workbooks)  

[Workbook parameters](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-parameters)  

---

## Q0152:

Your manager wants to implement one of the Analytics Efficiency workbook templates in Microsoft Sentinel to gain insights into the data your analysts get on an unexpected or undesirable events that involves some degree of disruption, harm, or damage.
You need to recommend an appropriate Analytics Efficiency workbook template that suits best in this scenario.

Which template should you recommend?

Choose the correct answer

- Cybersecurity Maturity Model Certification (CMMC)
- Detection efficiency
- Incident Overview
- SOC efficiency

---

### Answer:
- Incident Overview

You should recommend the Incident Overview workbook template. This pre-designed workbook template enables you to personalize the information provided to your analysts regarding a particular incident. It allows you to view auditing data, recommendations, and other pertinent details. The workbook includes the subsequent metrics:
• Incident's title, alerts, status, bookmark, severity, owner, etc.
• Closing reasons of similar incidents
• Recent actions that were taken on the incident
• Incident's comments
• Time to closure/triage
You should not recommend the Cybersecurity Maturity Model Certification (CMMC) workbook template. The Microsoft Sentinel CMMC workbook is a pre-built workbook that helps organizations that need to comply with CMMC requirements. It includes a set of dashboards and visualizations that allow users to monitor their compliance with the CMMC standards, such as the implementation of security controls and the management of access to sensitive data. In this scenario, however, you are requested to recommend a workbook template to help security analysts gain insights into the data your analysts get on an unexpected or undesirable events that involves some degree of disruption, harm, or damage.
You should not recommend the Detection efficiency workbook template. This is a pre-built workbook that provides users with insights into the effectiveness of their security incidents detections. It allows security analysts to evaluate the quality of their detections, identify areas for improvement, and optimize their detection rules to improve the accuracy and efficiency of their threat detection capabilities.
You should not recommend the SOC efficiency workbook template. The SOC efficiency workbook in Microsoft Sentinel is a pre-built workbook that provides security teams with insights into the efficiency of their Security Operations Center (SOC) operations. It allows security analysts to evaluate their SOC performance, identify areas for improvement, and optimize their workflows to increase the efficiency of their security operations.

---

### References

[The Toolkit for Data-Driven SOCs](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/the-toolkit-for-data-driven-socs/ba-p/2143152)  

[Commonly used Microsoft Sentinel workbooks](https://learn.microsoft.com/en-us/azure/sentinel/top-workbooks)    

[What's New: Cybersecurity Maturity Model Certification (CMMC) Workbook in Public Preview](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/what-s-new-cybersecurity-maturity-model-certification-cmmc/ba-p/2111184)

[Investigate incidents with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases)

[Visualize and monitor your data by using workbooks in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/monitor-your-data?tabs=azure-portal)

---

## Q0151:

Your manager wants to compare the trends of traffic within the past 10 days. You plan to create a workbook query.
You need to complete the query to fulfill the manager's request.
How should you complete the query? To answer, select the appropriate options from the drop-down menus.

Choose the correct options

OTPION-1
SecurityEvent
Update case comments
Update cases

OTPION-2
TimeGenerated > ago(10d)
startTime
IncidentNumber

```
[OTPION-1]
| where [OTPION-2]
| summarize count() by bin (TimeGenerated, 1d)
| extend Week iff (TimeGenerated>ago (7d), "This Week", "Last Week"),
  TimeGenerated iff(TimeGenerated>ago(7d), TimeGenerated, TimeGenerated + 7d)
```

```
SecurityEvent
| where TimeGenerated > ago(10...
| summarize count() by bin (TimeGenerated, 1d)
| extend Week iff (TimeGenerated>ago (7d), "This Week", "Last Week"),
  TimeGenerated iff(TimeGenerated>ago(7d), TimeGenerated, TimeGenerated + 7d)
```

---

### Answer:

You should complete the query as follows:

```
SecurityEvent
| where TimeGenerated > ago (10d)
| summarize count() by n (TimeGenerated, 1d)
| extend Week iff (TimeGenerated>ago (7d), "This Week", "Last Week"),
  TimeGenerated. iff (TimeGenerated>ago (7d), TimeGenerated, TimeGenerated + 7d)
```

You should select Security Event. This expression defines the resource that the query is based on. Since the manager wants to compare trends of traffic, which includes sensitive data like IP addresses of users and log data, the Windows Security Event resource is the suitable expression in this case.
You should not select Update cases. This expression defines the action of updating a case upon investigating it, and it is included in the category of Security Insights in Azure. This does not meet the scenario's requirement.
You should not select Create case comments. This expression defines the action of creating comments for cases being investigated, which is a useful tool while investigating a case. This activity is defined under the Security Insights category and cannot be used to compare the trends of traffic.
You should select TimeGenerated > ago (10d). This expression defines the time frame that you want to investigate. This expression defines a time frame of 10 days ago, which is exactly what the manager wants in the scenario.
You should not select Incident Number. Incident Number is used to define an incident by the number Microsoft Sentinel assigned to it.
You should not select startTime. This expression defines the beginning of the time frame in which the incident occurred in the company, but it cannot be used in a query that compares traffic trends.

---

### References

[Visualize and monitor your data by using workbooks in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/monitor-your-data?tabs=azure-portal)  
[Manage your SOC better with incident metrics](https://pts.measureup.com/web/PBS/LMS/index.php?l=1&k=8674395&tam=2426582&role=1&course=at_test202212230605081671775508)  
[Visualize collected data](https://learn.microsoft.com/en-us/azure/sentinel/get-visibility)  

---

## Q0150:

You create a custom Microsoft Sentinel workbook including security blocks to interpret data and a query.
Your manager wants to preview the content of the new workbook before it is completed and to test the result of the query to be added to the workbook.
You need to create a custom Microsoft Sentinel workbook to fulfill the manager's request.
Which five actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions
Modify the Visualization field.
Choose the Add Links/tabs option on the Add pane.

Actions in order

1. Choose the Add workbook option.
2. Choose the Add Text option on the Add pane.
3. Select the Preview tab.
4. Choose the Add Query option on the Add pane.
5. Choose the Run Query option.

---

### Answer:

You should perform the following steps in order:
1. Choose the Add workbook option.
2. Choose the Add Text option on the Add pane.
3. Select the Preview tab.
4. Choose the Add Query option on the Add pane.
5. Choose the Run Query option.

To create a custom Microsoft Sentinel Workbook, you should first choose the Add workbook option. This step is done on the Workbooks page and allows you to create a new custom workbook and start editing it.
The second step is to choose the Add Text option on the Add pane. This action allows you to add security blocks that enable you to analyze the security data.
You should then select the Preview tab. This action is done on the New Workbook page and allows you to preview how the content will appear, which is what the scenario requires.
The next step is to choose the Add Query option on the Add pane. This action allows you to add query items and visualize data as charts.
Finally, you should choose the Run Query option. This option is done on the header bar of the query and allows you to test the result of the query you added.
You should not modify the Visualization field. This action is done on the query page of the new workbook and allows you to choose a specific visualization of the displayed query like Tiles, Grid, Pie Chart, etc.
You should not choose the Add Links/tabs option on the Add pane. This action allows you to customize the navigation section on the new workbook with lists, paragraphs, tabs, etc.

---

### References

[Commonly used Microsoft Sentinel workbooks](https://learn.microsoft.com/en-us/azure/sentinel/top-workbooks)  

[Create or edit an Azure Workbook](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-create-workbook) 

[Azure Workbooks](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-overview)  

[Visualize and monitor your data by using workbooks in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/monitor-your-data?tabs=azure-portal)  

---

## Q0149:

The cyber forensic team is investigating a long-term data exfiltration breach. You are tasked with creating a search job to find specific events across all your logs, including events in Analytics and Archived log plans.
You need to identify what type of queries Microsoft Sentinel utilizes for searching data.

What type of queries should you identify?

Choose the correct answer

- Cross-database queries
- Single queries
- Asynchronous queries
- Asynchronous queries

---

### Answer:
- Cross-cluster queries

You should identify asynchronous queries. Asynchronous queries are executed asynchronously, meaning they run independently of other processes and do not require immediate responses. In Microsoft Sentinel, search jobs are conducted using asynchronous queries, allowing for parallel processing across large datasets without impacting workspace performance or availability. This makes them well-suited for searching large datasets in Sentinel.
The other query types listed above are not applicable to search jobs in Microsoft Sentinel by design. These types of queries are designed to be utilized in other scenarios:
A single query allows you to search and correlate data from multiple workspaces.
Cross-cluster queries enable you to query data across multiple sources.
Cross-database queries enable you to query data across multiple databases within the same cluster.

---

### References

[Search across long time spans in large datasets](https://learn.microsoft.com/en-us/azure/sentinel/search-jobs?tabs=azure-portal)  

[Start an investigation by searching for events in large datasets](https://learn.microsoft.com/en-us/azure/sentinel/investigate-large-datasets)  

[Kusto Query Language in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/kusto-overview)    

[Extend Microsoft Sentinel across workspaces and tenants](https://learn.microsoft.com/en-us/azure/sentinel/extend-sentinel-across-workspaces-tenants)    

[Best practices for Kusto Query Language queries](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/best-practices)    

[Cross-cluster and cross-database queries](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/cross-cluster-or-database-queries)  

---

## Q0148:

You create and run multiple threat hunting queries regularly. Recently, you noticed that some newly created, very complex queries run very slowly, produce a lot of results, and end up timing out.
You need to minimize disruptions.

Which KQL operator should you use as the first optimization step?

Choose the correct answer

- where
- take
- limit
- count

---

### Answer:

- count
You should use the count operator as the first optimization step. Before executing a query that you think may yield a substantial number of results, you should evaluate it initially using the count operator. The count operator helps you to evaluate the number of data sets your query returns. Knowing this information assists you in making decisions about your next optimization steps.
You should not use neither the limit nor the take operators as the first optimization step. These operators are typically used to avoid large result sets. The initial step should focus on evaluating queries or determining appropriate sizing.
You should not use the where operator as the fist optimization step. The where operator is typically used to apply filters to reduce the data set.

---

### References

[Advanced hunting query best practices](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-best-practices)  

[KQL quick reference](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/kql-quick-reference) 

---

## Q0147:

You have an Azure subscription with Microsoft Sentinel activated.
You need to identify detections that are available, but not currently configured in your Microsoft Sentinel workspace.


How should you use MITRE ATT&CK to meet the requirement in the most efficient way?

Choose the correct answer

- Wait for an incident and map it to MITRE tactics and techniques.
- Leverage the simulation capability of the MITRE view.
- Create a hunting query and associate it with MITRE tactics and techniques.
- Tag a custom detection rule with the relevant MITRE tactics and techniques.

---

### Answer:
- Leverage the simulation capability of the MITRE view.

You should leverage the simulation capability of the MITRE view to explore the built-in features and capabilities of Microsoft Sentinel. The MITRE ATT&CK framework provides a comprehensive catalog of tactics and techniques used by threat actors. By reviewing your simulated coverage, you can assess the potential security posture of your organization.
You should not create a hunting query and associate it with MITRE tactics and techniques. This is a valid approach to proactively search for threats and anomalous activities in your Azure environment. However, it requires manual effort to create and refine the hunting queries, which may not be so efficient for identifying not configured detections.
You should not tag a custom detection rule with the relevant MITRE tactics and techniques. This is more suitable for enhancing existing detections or creating custom detection rules. It does not specifically address the identification of non-configured detections.
You should not wait for an incident and map it to MITRE tactics and techniques since this is a reactive approach that relies on incidents occurring before mapping them to MITRE tactics and techniques. It is not the most efficient way to identify non-configured detections.

---

### References

[Understand security coverage by the MITRE ATT&CK® framework](https://learn.microsoft.com/en-us/azure/sentinel/mitre-coverage)  

[Joint forces MS Sentinel and the MITRE framework](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/joint-forces-ms-sentinel-and-the-mitre-framework/ba-p/3191589)  

---

## Q0146:

You have an Azure subscription with Microsoft Sentinel enabled.
You need to query data that is archived beyond your workspace's retention period.
What should you use to query the data?
Choose the correct answer

- Data connector
- Log Analytics workspace
- Azure Data Lake Storage
- Search job

---

### Answer:
- Search job

You should use a search job. In Microsoft Sentinel, when data is archived beyond the retention period of your workspace, you can use the search job feature to query and retrieve that archived data. Search jobs allow you to perform searches against the archived data stored in long-term storage, such as Azure Data Lake Storage or Azure Blob Storage.
You should not use a Log Analytics workspace. Log Analytics is a central repository for collecting, storing, and analyzing log and monitoring data from various sources, including Azure services and on-premises resources. Although a Log Analytics workspace is an integral part of Microsoft Sentinel, it is not specifically designed and used for querying data that is archived beyond a workspace's retention period.

You should not use data connectors. Data connectors in Microsoft Sentinel enable you to ingest data from external sources into your Microsoft Sentinel workspace. They facilitate the collection and integration of data from different security solutions, such as firewalls, antivirus systems, or threat intelligence feeds. Data connectors are not directly related to querying archived data beyond the workspace's retention period.
You should not use Azure Data Lake Storage. It is a scalable and secure storage solution in Azure that allows you to store and analyze large amounts of structured and unstructured data. Although Azure Data Lake Storage can be used as a storage location for archived data, it is not specifically used for querying the data. The search job feature is used to query the archived data, regardless of the storage location.

---

### References

[Ingest, Archive, Search, and Restore Data in Microsoft Sentinel](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/ingest-archive-search-and-restore-data-in-microsoft-sentinel/ba-p/3195126)    

[Search across long time spans in large datasets](https://learn.microsoft.com/en-us/azure/sentinel/search-jobs?tabs=azure-portal)   

[Log Analytics tutorial](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-tutorial)   

[Microsoft Sentinel data connectors](https://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources?tabs=azure-portal)    

[What is a Data Lake?](https://azure.microsoft.com/en-us/resources/cloud-computing-dictionary/what-is-a-data-lake/#what-is-a-data-lake)  

---

## Q0145:

You are a Security Operations Center (SOC) analyst at a large pharmaceutical organization. Your organization has an Azure subscription that uses Microsoft Sentinel.
You are building a customized incident detection solution in your organization using Microsoft Sentinel hunting queries. 

Your solution must satisfy the following three requirements:

1. It must allow you to create interactive sessions that let you test newly-created queries as events occur.
2. It must allow you to receive notifications from the sessions when a match is found.
3. It must allow you to launch investigations if necessary.

You need to design the solution.

What should you use?

Choose the correct answer

- Entity identifiers
- Bookmarks
- Watchlists
- Livestream

---

### Answer:
- Livestream

You should create livestream hunting queries, as this will enable you to satisfy all three requirements. In summary, Microsoft Sentinel livestreams allow you to identify signs of intrusions in real time and take proactive steps towards incident response and resolution.
You should not use entity identifiers. Microsoft Sentinel classifies the data items contained in alerts into categories, which are referred to as entities. Each entity type has its own unique attributes, which are referred to as identifiers. In this scenario, since the objective is to create hunting queries that can track intrusions in real time, you need to use livestream hunting queries.
You should not use watchlists. The watchlists feature in Microsoft Sentinel enables you to provide a data source and correlate its data with the events in your Microsoft Sentinel environment. For example, you might want to create a watchlist with a list of high-value assets, or service accounts in your environment. Since the objective in the scenario is to create hunting queries that can track intrusions in real time, you need to use livestream hunting queries.
You should not use bookmarks. Microsoft Sentinel's hunting bookmarks help you to preserve the queries you run in Microsoft Sentinel Logs, along with the query results that you deem relevant. You can also record your contextual observations and reference your findings by adding notes and tags. Bookmarked data is visible to you and your teammates for easy collaboration.

---

### References

[Use hunting livestream in Microsoft Sentinel to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/livestream)  

[Classify and analyze data using entities in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/entities)  

[Use watchlists in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/watchlists)    

[Keep track of data during hunting with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/bookmarks)  

---

## Q0144:

You are using Microsoft Sentinel's threat hunting capabilities.
Your company has been adding to the built-in queries by creating its own custom queries. One of the queries, titled Query A, does not seem to be producing relevant data and may need to be tweaked.
You need to test Query A to see if matches are happening when events occur.

Which action should you perform on the Microsoft Sentinel Hunting page?

Choose the correct answer

- On the Livestream tab, select the livestream titled Query A.
- On the Livestream tab, Select + New livestream.
- On the Queries tab, right-click Query A and select Add to livestream.
- On the Bookmarks tab, select Bookmark A and click Investigate.

---

### Answer:
- On the Queries tab, right-click Query A and select Add to livestream.

Microsoft Sentinel threat hunting has many related components. At the core of the hunts are queries. These queries use Kusto Query Language (KQL) to perform an advanced search on ingested Microsoft Sentinel data. You can either use built-in or custom queries. A livestream in Microsoft Sentinel refers to the real-time continuous stream of security events that are being ingested and processed by the solution. This livestream includes data from different sources, such as logs from network devices, endpoints, cloud services, and applications. The livestream is processed and analyzed by Microsoft Sentinel using various techniques such as machine learning, behavioral analytics, and threat intelligence to detect and prioritize security events that require further investigation or action. As live events happen, you can leverage the hunting livestream to test your queries and to generate alerts when matches are found.
You should right-click Query A and select Add to livestream. This process allows you to create a livestream from an existing query, in this case Query A. This option ensures that you will not have to write your own KQL query; you can simply use one that you have created for Query A previously.
You should not select + New livestream on the Livestream tab. This allows you to create a livestream from scratch. You would create a new KQL query as the input for the livestream. While this is a valid path to the creation of a livestream, it is not a correct option since the scenario instructs you to use Query A.
You should not select Bookmark A and click Investigate on the Bookmarks tab. Bookmarks are a different hunting component. They are used to highlight interesting data that you may return to later or escalate to an incident. You may choose to name a bookmark Bookmark A, but this name can be set manually and does not necessarily mean that it is directly related to Query A.
You should not select the livestream titled Query A on the Livestream tab. You have not yet created the livestream, either from scratch or using an existing query. However, after creating livestreams, this is a valid place to come and view or edit them. You could name a livestream Query A, but this name can be set manually and does not necessarily mean that it is directly related to Query A.

---

### References

[Observe threats over time with livestream](https://learn.microsoft.com/en-us/training/modules/hunt-threats-sentinel/5-livestream)  

[Use hunting livestream in Microsoft Sentinel to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/livestream)  

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)  


---

## Q0143:

Edit the Query information section before saving.
Add relevant tags and notes in the Add bookmark pane before saving.
In the query results, mark the checkboxes for any rows you want to preserve and select Add bookmark.
Select Bookmark Logs from the command bar on the Bookmarks tab on the Hunting Page.

---

### Answer:

Bookmarks are a tool within Microsoft Sentinel threat hunting that you can use to highlight key events. These may be noteworthy data that you want to review later or events that should be escalated to incidents. Root causes and loCs (indicators of compromise) are good examples of bookmark-worthy events.
In the query results, you should mark the checkboxes for any rows you want to preserve and then select Add bookmark. This action allows you to create a bookmark, which meets the requirement of marking the data for later review.
You should also add relevant tags and notes in the Add bookmark pane before saving. This action allows you to make the bookmark easy to reference alongside related data. By using tags, you will be able to easily compare the bookmark you are setting with similar bookmarks you create as you continue investigating.
You should not select Bookmark Logs from the command bar on the Bookmarks tab on the Hunting Page. This action allows you to view all bookmark metadata. This may be part of bookmark management as your investigation continues, but it does not meet the scenario requirements of marking and referencing data.
You should not edit the Query information section before saving. This section is filled automatically with info from the query. You can edit it if needed, but you will not usually need to. Furthermore, the query information section, unlike tagging, is not an efficient tool for searching related bookmarks.

---

### References

[Keep track of data during hunting with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/bookmarks)

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)  

---

## Q0142:

You are a member of the security operations team at a company using Microsoft Defender for Office 365. To improve response times for threat identification and mitigation, you use automated investigation and response (AIR) capabilities. An alert has triggered and an automated investigation has been initiated.
On analyzing the progress of the automated investigation, you see that it resulted in a status of Terminated By System.
What two reasons can there be for this status to be displayed? Each correct answer presents a complete solution.

Choose the correct answers


- The investigation was held in queue for too long.
- Pending actions timed out after 48 hours.
- One or more investigation analyzers did not properly complete.
- Pending actions timed out after one week.
- Actions are too numerous to run all analyzers.

---

### Answer:

- Pending actions timed out after one week.
- Actions are too numerous to run all analyzers.

The Terminated By System status can occur when pending actions time out with no action taken for one week. Prior to this one week time-out, the investigation would first resolve to the Pending Action status. To avoid this time-out, you should review and manage remediation of any pending actions in a timely manner.

The Terminated By System status can also occur when there are simply too many actions for the investigation to run all analyzers. While Microsoft does not give a specific numeric limitation, an example that could trigger such a status is a massive group of users at a company clicking on a malicious link in a phishing email. This differs from a Failed status since it is caused by the analyzers essentially being overwhelmed, while the Failed status is simply one or more analyzers running into any variety of technical issues that cause it to fail/not complete.
Pending actions do not time out after 48 hours, so this would not generate this status. At 48 hours, if the investigation had pending actions, it would still be in the Pending Action status. It is important to remember the one week limit for pending actions to try and avoid a Terminated By System status.
Investigations that are held in queue for too long result in a Terminated By Throttling status. This differs from the Terminated By System status as queued investigations have not yet started, while the Terminated By System status indicates an investigation was complete and had actions to review for a week without being
addressed.
If one or more investigation analyzers do not properly complete, this results in a Failed status. This differs from the Terminated By System status as that is the result of the analyzers in the investigation being overrun with actions. The Failed status is a general failure of one or more investigation analyzers. You should always view the details of the investigation when you see this status to determine what happened with any remediation actions, if applicable.

---

### References

[How automated investigation and response works in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/air-examples?view=o365-worldwide)  

[Details and results of an automated investigation in Microsoft 365](https://learn.microsoft.com/en-us/defender-office-365/air-view-investigation-results?view=o365-worldwide)    

[Automate, investigate, and remediate](https://learn.microsoft.com/en-us/training/modules/m365-threat-remediate/automate-investigate-remediate)  

---

## Q0141:

Your company has a Microsoft Sentinel deployment.
Some employees in the accounting department upload sensitive data to the cloud without taking into consideration potential risks.
You need to find the most efficient way to query for suspicious activities carried out by accounting department employees.

Which two actions should you perform? Each correct answer presents part of the solution.

Choose the correct answers

- Select the New Query option on the Hunting page.
- Select the Create a new AML workspace option on the Notebooks page.
- Select Playbooks in the Microsoft Sentinel portal.
- Select the Hunting option in the Microsoft Sentinel portal.
- Select the Run All Queries option on the Hunting page.

---

### Answer:
- Select the Hunting option in the Microsoft Sentinel portal.
- Select the Run All Queries option on the Hunting page.

You should select the Hunting option in the Microsoft Sentinel portal. Microsoft Sentinel offers strong search and query features for dynamically searching for security risks across an organization's data sources, including the Hunting feature, which fulfills this exact purpose. Using the Hunting option in the Microsoft Sentinel portal is the first action you would take if you wanted to query suspicious activities within an organization.
You should also select the Run All Queries option on the Hunting page. Running all the queries will enable you to track all Azure Activities performed within your company, including suspicious activities carried out by employees in the accounting department. These two actions meet the scenario requirement.
You should not select the New Query option on the Hunting page. This action in Microsoft Sentinel allows you to create a new query which will be used to detect activities carried out by users. By creating a new query, you will be receiving new activities done by users. You will not be able to view any previous actions that were considered suspicious.
You should not select Playbooks in the Microsoft Sentinel portal. Microsoft Sentinel Playbooks are automation workflows that allow security analysts to respond to security incidents in a more efficient and automated way. Playbooks can automate routine tasks, such as triaging and categorizing alerts, enriching data, and executing remediation actions. While Microsoft Sentinel Playbooks can be used as a part of a broader threat hunting strategy to automate routine tasks and help security teams to focus on more complex and high-priority tasks, they are not specifically designed for threat hunting. As such Microsoft Sentinel
Playbooks are not the most efficient way to query for suspicious activities.
You should not select the Create a new AML workspace option on the Notebooks page. This action is included in the process of creating an Azure Machine Learning (AML) workspace from Microsoft Sentinel. This will not allow you to query suspicious activities.

---

### References

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)  

[Use Jupyter Notebook to hunt for security threats](https://learn.microsoft.com/en-us/azure/sentinel/notebooks) 

[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)  

---

## Q0140:

You are tasked with reviewing the Threat Analytics report in Microsoft Defender XDR.
You observe that some devices are marked as 'exposed', but you cannot find any abnormalities or recommendations by inspecting the Defender Vulnerability Management report for Microsoft Defender for Endpoint. Additionally, there are no reported events, alerts or incidents.

You need to understand the cause of the issue.

What is causing the issue?

Choose the correct answer

- Microsoft Defender XDR is not installed.
- Devices do not transmit data to the service.
- Devices have installed third-party antivirus solutions.
- Devices are configured with restrictive firewall rules.

---

### Answer:
- Devices have installed third-party antivirus solutions.

The fact that devices have installed third-party antivirus solutions is causing the issue. Statistics regarding antivirus activities rely on the settings of Microsoft Defender Antivirus. Devices equipped with third-party

antivirus solutions may be flagged as 'exposed'.
You should not identify 'Devices do not transmit data to the service' and 'Devices are configured with restrictive firewall rules' as the issue causing the problem. Both of these issues prevent data transmission to the service, resulting in the devices being categorized as 'unavailable' rather than 'exposed'.
You should not identify Microsoft Defender XDR not installed as an issue. Microsoft Defender XDR integrates data from the Microsoft 365 security services you have deployed. Upon activation, incident management, automation, and threat hunting functionalities become operational within the framework of these deployed products. In the absence of proper deployment for any of these products, Microsoft Defender XDR will not showcase any data. Thus device will be categorized as 'unavailable'.

---

### References

[Frequently asked questions when turning on Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/m365d-enable-faq)  

[Threat analytics in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/threat-analytics)  

[STEP 1: Configure your network environment to ensure connectivity with Defender for Endpoint service](https://learn.microsoft.com/en-us/defender-endpoint/configure-environment)  


---

## Q0139:

Your manager wants you to build a hunting query, named Hunting Targets, for the company's Microsoft Sentinel workspace.
You need to complete the request body of the query.
How should you complete the request body of the query? To answer, complete the query by selecting the appropriate options from the drop-down menus.

Choose the correct options

```
"properties": {
  "Category": "Hunting Queries"
  "DisplayName": "HuntingTargets
  "Query": "SecurityEvent" | where EventID == \"15\" | where CommandLine contains \"-noni -ep bypass $\"",
  "Tags": [
    {
    "Name": "Description",
    "Value": "Test Hunting Query"
    },
    {
    "Name": "Tactics",
    "Value": "Execution, Discovery"
    }
  ]
}
```

---

### Answer:

You should use "Category": "Hunting Queries" in line 3. This is a required expression that defines the category of the query created, which in this case is a hunting query.
You should not use 'Active' in line 3. This expression defines the status of an incident. An active incident means that it is still happening. The incident severity can be one of three: High, Medium, or Low. This expression cannot be used in building a hunting query.

You should not use "actionType": "LogicApp" in line 3. Logic apps are used in automation, providing several action types. Action types define the triggers of the workflow. This expression is required in the syntax of an automation template. This does not meet the scenario's requirement.
You should use "DisplayName": "HuntingTargets" in line 4. This expression defines the name of the hunting query you want to display to the users. This will name the query Hunting Targets.
You should not use startTime in line 4. This expression defines the beginning of the time frame in which the incidents occurred in the company. It cannot be used to build a hunting query.

You should not use Update cases in line 4. This expression defines the action of updating a case upon investigating one. It is not included in building a hunting query. This does not meet the scenario's requirement since this expression cannot be used in what the manager wants.
You should use "Query": "Security Event" in line 5. This expression defines the data type used in the query, which is related to security events. This is logical since hunting queries are created to hunt threats and monitor security events in the company. This meets the scenario's requirement.
You should not use Create case comments in line 5. This expression defines the action of creating comments for cases being investigated. This is a beneficial activity while investigating a case. This activity is defined under the Security Insights category and cannot be used to build a hunting query.
You should not use OperationName == "Add user" in line 5. This expression defines the operation of adding a new user within Microsoft Entra ID. This does not meet the scenario's requirement as nothing in the scenario mentions creating a new account for the employee in Microsoft Entra ID.

---

### References

[Visualize and monitor your data by using workbooks in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/monitor-your-data?tabs=azure-portal)  

[Manage your SOC better with incident metrics](https://learn.microsoft.com/en-us/azure/sentinel/manage-soc-with-incident-metrics)    

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)    

[Audit Microsoft Sentinel queries and activities](https://learn.microsoft.com/en-us/azure/sentinel/audit-sentinel-data)    

[Manage hunting and livestream queries in Microsoft Sentinel using REST API](https://learn.microsoft.com/en-us/azure/sentinel/hunting-with-rest-api)

[Automate remediation responses](https://learn.microsoft.com/en-us/azure/defender-for-cloud/workflow-automation)  

---

## Q0138:

You have a Microsoft 365 E5 subscription.
You need to identify the ratio of malicious and spam emails to legitimate emails received by the user.
How should you complete the query? To answer, select the appropriate option from the drop-down menu.

Choose the correct options

OPTIONS: evaluate | count | summarize

```
Email Events
| project Recipient EmailAddress, ThreatTypes
| OPTIONS pivot(ThreatTypes)
| sort 
```

```
Email Events
| project Recipient EmailAddress, ThreatTypes
| evaluate pivot(ThreatTypes)
| sort by Recipient EmailAddress asc
```

---

### Answer:

You should complete the query as follows:

```
EmailEvents
| project RecipientEmailAddress, ThreatTypes
| evaluate pivot (ThreatTypes)
| sort by RecipientEmailAddress asc
```

The evaluate operator in Kusto Query Language (KQL) is a tabular operator that provides the ability to utilize query language extensions named plugins. Unlike other language constructs, plugins can be enabled or disabled based on specific requirements and not constrained by statically determined output schema. In this scenario, the evaluate operator is used to evaluate and transform tabular data using the pivot operator. The pivot operator transforms a tabular result set by converting column values into separate columns. It allows you to rotate or pivot the data based on a specified column; in this case, ThreatTypes. The query will create new columns for each unique value in the Threat Types column. The values in the ThreatTypes column will become column headers, and the corresponding cells will contain the data from the original columns (RecipientEmailAddress and any other columns present). The result set will have a new structure, with separate columns for each unique value in ThreatTypes. For example, if the original Threat Types column had values like "Malware," "Phishing," or "Spam," the pivot operation will create three new columns with those names. The data in these new columns will correspond to the original columns (RecipientEmailAddress, in this case).
The count operator determines the total number of records within each summarization group, or provides the overall count if there is no grouping applied during the summarization process. It cannot be used to utilize query language extensions.
The summarize operator is used to aggregate data and generate summary results based on specific grouping criteria, while the evaluate operator is a more flexible operator used for data evaluation and invoking plugins to extend the functionality of KQL. In the given scenario, you have to use the evaluate operator since summarize is not designed to work with plugins.

---

### References

[Fun With KQL - Pivot](https://arcanecode.com/2023/01/16/fun-with-kql-pivot/)  
[evaluate plugin operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/evaluate-operator)  
[count operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/count-operator)  
[summarize operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/summarize-operator)  

---

## Q0137:

You are tasked with developing an advanced hunting query in Microsoft Defender XDR to detect potential compromises of email recipients' accounts.

Which tables from unified audit log should you use?

Choose the correct answer

- EmailAttachementinfo, EmailEvents, and IdentityLogonEvents
- EmailAttachementinfo and IdentityLogonEvents
- EmailEvents and IdentityLogonEvents
- EmailAttachementinfo and EmailEvents


---

### Answer:
- EmailEvents and IdentityLogonEvents

You should use the Email Events and Identity LogonEvents tables. These tables cover the email-related activities and user logon events, which are key factors in assessing the security of email accounts and identifying any suspicious or unauthorized access. The Email Events table captures various email-related events in the unified audit log. It includes information about sent emails, received emails, email drafts, email deletions, and other email-related activities. This table helps in tracking email communications, identifying patterns, and detecting any anomalous or unauthorized email activities. The Identity LogonEvents table records user logon events in the unified audit log. It includes details about user sign-ins, sign-outs, failed sign-in attempts, and other authentication-related events. This table is crucial for monitoring user activity, detecting suspicious logon events, and identifying potential compromises or unauthorized access to user accounts.

The EmailAttachmentInfo table contains information about email attachments in the unified audit log. It includes details such as the file name, file type, size, and other metadata associated with the email attachments. This table is useful for investigating any suspicious or potentially malicious attachments that might have been sent or received.

---
### References

[Email Events](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-emailevents-table)  

[IdentityLogonEvents](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-identitylogonevents-table)   

[EmailAttachmentInfo](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-emailattachmentinfo-table)  

[Understand the advanced hunting schema](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-schema-tables)  

---

## Q0136:

You are a security analyst. Based on incidents reported by the security operation center (SOC), you suspect a cyberattack that uses a specific type of malware to mine cryptocurrency.
You need to query the unified audit log to gain insights into the prevalence of the specific malware associated with different files.

How should you complete the query? To answer, select the appropriate option from the drop-down menu.

Choose the correct options

OPTIONS: count() | avg() | sum()

```
let MalwareIndicator = "specific_malware_name";

Device Events
| where Timestamp >= ago(7d)
| where ActionType == "Allowed" or ActionType == "Blocked"
| where FileName contains MalwareIndicator
| summarize Events = OPTIONS by FileName, DeviceName
| order by Events desc
```

```
let MalwareIndicator = "specific_malware_name";

Device Events
| where Timestamp >= ago(7d)
| where ActionType == "Allowed" or ActionType == "Blocked"
| where FileName contains MalwareIndicator
| summarize Events = count() by FileName, DeviceName
| order by Events desc
```

---

### Answer:

You should complete the query as follows:

1. let MalwareIndicator = "specific_malware_name";
2. DeviceEvents
3. where Timestamp >= ago (7d)
4. where ActionType == "Allowed" or ActionType == "Blocked"
5. where FileName contains MalwareIndicator
6. summarize Events = count() by FileName, DeviceName
7. order by Events desc

The summarize statement in line 6 should include the count() function. The count() function is used to calculate the number of records or rows in a dataset. It counts the occurrences of a specific field or all records in the dataset. It does not consider the actual values of the field, but only the presence of non-null values.
By including these fields in the summarize statement, you can analyze the count of events (Events) based on the file name (FileName) and device name (DeviceName) associated with the suspected malware (filtering in line 5). You can group them based on FileName) and DeviceName. This allows you to gain insights into the prevalence of the specific malware and its association with different files and devices for further investigation.
You should not use the the avg() function. This function calculates the average or mean value of a numeric field in a dataset. It considers the numeric values of the field and calculates the sum of those values divided by the count of non-null values. In this scenario the requirement is to identify prevalence of the specific malware, but not the average value.
You should not use the sum() function. This function is applied to a table with a single column value to calculate the sum of the numbers.

---

### References

[count() (aggregation function)](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/count-aggregation-function)  

sum() (aggregation function)
avg() (aggregation function)


[DeviceEvents](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceevents-table)  

[Hunt for ransomware](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-find-ransomware)    

[Proactively hunt for threats with advanced hunting in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-overview)   

[Kusto Query Language (KQL) overview](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/)  

---

## Q0135:

You have an Azure subscription that uses Microsoft Sentinel.
You are creating a Microsoft Sentinel custom hunting query to find hosts with a high reverse DNS count.

You need to produce a single table as an aggregate of the contents of the input table.

How should you complete the query? To answer, select the appropriate options from the drop-down menus.

Choose the correct options

OPTION-1: summarize | union | where
OPTION-2: count() | countif() | dcount()
OPTION-3: threshold | dcount(Name) | count

```
let threshold = 10;

DnsEvents
| where Name has "in-addr.arpa"
| OPTION-1 StartTime = min (TimeGenerated), EndTime = max (TimeGenerated),
            NameCount = dcount (Name), Names make set (Name),
            ClientIPCount = OPTION-2 by ClientIP
| where NameCount > OPTION-3
| extend timestamp = StartTime, IPCustomEntity = ClientIP
```

```
let threshold = 10;

DnsEvents
| where Name has "in-addr.arpa"
| summarize StartTime = min (TimeGenerated), EndTime = max (TimeGenerated),
            NameCount = dcount (Name), Names make set (Name),
            ClientIPCount = count() by ClientIP
| where NameCount > threshold
| extend timestamp = StartTime, IPCustomEntity = ClientIP
```
---

### Answer:

You should complete the query as follows:

```
let threshold = 10; 

DnsEvents 
| where Name has "in-addr.arpa" 
| summarize StartTime = min (TimeGenerated), EndTime = max (TimeGenerated), NameCount = dcount (Name), Names = make set (Name), ClientIPCount 
| where NameCount > threshold 
| extend timestamp = StartTime, IPCustomEntity = ClientIP = count() by ClientIP
```
You should select the summarize operator, the count() function, and the threshold value to complete the Microsoft Sentinel hunting query. In this scenario, the summarize operator produces a table which aggregates the content of the input table. The count() aggregate function counts the number of records per summarization group. Your threshold is a real literal that will depend on your specific use-case scenario.
You should not use the where operator. The where operator filters a table to the subset of rows that satisfy a predicate. This is not a required condition when trying to produce a single table as an aggregate of the
contents of the input table.
You should not use the union operator. The union operator takes two or more tables and returns the rows of all of them.
You should not use the countif() function. The countif() function counts the rows in which the predicate evaluates to true. You would not use it in this scenario since there is no predicate filter in the query which you are checking against. You would use the countif() function instead of count() if you had a query with a predicate filter, for example, MyCompanyEvents | summarize
Total=count(),Total Damage-countif(Damaged Products >0) by County.
You should not use the dcount() function. The dcount() function calculates an estimate of the number of distinct values that are taken by a scalar expression in the summary group. An example of when you would use dcount() function instead of count() is: MyCompany Events | summarize DiffEvents-dcount(EventType) by County | order by DiffEvents.

In the third drop-down, you should not select either count or dcount(Name). You would use count in a scenario in which you want to count the number of records per summarization group, and you would use dcount() when your aim is to estimate the number of distinct values in a scalar expression. The objective in this scenario is to compare the number of names with the defined threshold, where the NameCount is greater than the threshold.
References

---

### References

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)  

[Microsoft Sentinel - List of hunting queries](https://github.com/Azure/Azure-Sentinel/tree/master/Hunting%20Queries)  

[Microsoft Sentinel Windows Server DNS Hunting Query for DNS_HighReverseDNSCount](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Windows%20Server%20DNS/Hunting%20Queries/DNS_HighReverseDNSCount.yaml)    

[summarize operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/summarize-operator)  

[where operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/where-operator)  

[union operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/union-operator?pivots=azuremonitor)

[count() (aggregation function)](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/count-aggregation-function)

[countif() (aggregation function)](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/countif-aggregation-function)    

[dcount() (aggregation function)](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/dcount-aggfunction)  

---

## Q0134:

You have an Azure subscription that uses Microsoft Sentinel.

You are creating a Microsoft Sentinel custom hunting query.

You need to identify accounts that have been locked out by smart lockout policies.

How should you complete the query? To answer, select the appropriate options from the drop-down menus.

Choose the correct options

OPTION-1: SigninLogs | AuditLogs | AzureActivity | AzureDiagnostics

OPTION-2: IPAddress | StartTime | UserID | UserPricipalName


```
id: 07a91ad1-234a-1258-de9a-a78x3as3afcl
name: Smart Lockouts
description: |
'This query identifies accounts that have been locked out by smart lockout policies.'

...
...
...
...

query: |
    [OPTION-1]
    | where ResultType == 50053
    | extend AccountCustomEntity UserPrincipalName, IPCustomEntity = [OPTION-2]
entityMappings:
    - entityType: Account
      fieldMappings:
        - identifier: FullName
          columnName: AccountCustomEntity
    - entityType: IP
      fieldMappings:
        - identifier: Address
        columnName: IPCustomEntity
```



```
id: 07a91ad1-234a-1258-de9a-a78x3as3afcl
name: Smart Lockouts
description: |
'This query identifies accounts that have been locked out by smart lockout policies.'

...
...
...
...

query: |
    SigninLogs
    | where ResultType == 50053
    | extend AccountCustomEntity UserPrincipalName, IPCustomEntity = IPAddress
entityMappings:
    - entityType: Account
      fieldMappings:
        - identifier: FullName
          columnName: AccountCustomEntity
    - entityType: IP
      fieldMappings:
        - identifier: Address
        columnName: IPCustomEntity
```

---

### Answer:

In this scenario, you should use SigninLogs for the entity mapping. Given that you are trying to identify accounts that have been locked out by smart lockout policies, you need to run the query against the SigninLogs table. Additionally, you should select IPAddress in the second drop-down since the query shows that the type of entity (entityType) is IP.
You should not use AzureActivity. You would use the AzureActivity table if you were querying for specific incidents regarding Azure services and their activities. For example, you might create a hunting query which examines users starting an Azure CloudShell session, as this would help in identifying abuse of the CloudShell to modify Azure resources, or you might create a hunting query to identify any Azure VM Run Command operations that are executed from a specific Azure IP address.
You should not use AuditLogs. You would use the AuditLogs table if you were querying for specific incidents against the audit logs for different services, for example, data extracted from Microsoft Entra audit logs. For example, you could create a hunting query which identifies accounts that have been added to a privileged PIM-managed group, you could create one which looks for users retrieving BitLocker keys, or you could create one for when a new user is granted access and starts granting access to other users. These queries would help you to identify malicious user behavior in a system.
You should not use Azure Diagnostics. You would use the Azure Diagnostics table if you were querying for specific incidents against the Azure Diagnostics logs for specific services. For example, you might create a hunting query which identifies when a user is added to, and then removed from an Azure Key Vault access policy within a short period of time, or you could create a hunting query for a list of ports in order to identify all critical ports that have rules such 'Any' for their sourcelp, which means that they are open to everyone.
You should not use Userld. You would use Userld if your identity mapping was User, and if you were tracking something very specific to an incident related to a particular user.
You should not use StartTime. You would use StartTime if your entity mapping catered to an incident with very specific start and end times. There is no such requirement in this scenario.
You should not use UserPrincipalName. You would use UserPrincipalName if your entity mapping catered to an incident related to a specific user who can be identified with a unique UserPrincipalName. In this
scenario, there is no such requirement.

---

### References

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)  

[Microsoft Sentinel List of hunting queries](https://github.com/Azure/Azure-Sentinel/tree/master/Hunting%20Queries)    

[Microsoft Sentinel hunting query for SigninLogs SmartLockouts.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/SigninLogs/SmartLockouts.yaml)    

---

## Q0133:

You are using the Microsoft Sentinel connector for Microsoft Defender XDR for your Azure subscription to ingest data from data sources into Microsoft Sentinel.
You query data for Microsoft Defender for Endpoint events to hunt for threats, as exhibited below.
You need to complete the Kusto query below in order to retrieve the relevant data for Lenovo devices.
How should you complete the query? To answer, complete the commands by selecting the correct option from the drop-down menus.
Choose the correct options

OPTIONS: 
DeviceTvmHardwareFirmware | 
DeviceTvmIfoGathering | 
DeviceInfo | 
DeviceEvents | 


```
// Count the number of Lenovo devices
let queryl = DeviceTvmHardwareFirmware
| where ComponentType "Hardware" and Manufacturer == "lenovo-n2vuj22w" ==
| summarize count ()
| take 1;

// Find all devices with a specific BIOS version.
let query2 = DeviceTvmHardwareFirmware
| where ComponentType == "Bios" and ComponentVersion contains "N2VUJ22W" 
| project DeviceId, DeviceName
| take 1;

queryl
| union query2;
```

---

### Answer:

In this scenario, you need to use Azure service-to-service integration as the data ingestion method for integrating Microsoft Defender XDR data sources into Microsoft Sentinel. Specifically, for Defender for Endpoint events, the relevant Log Analytics table is DeviceTvmHardwareFirmware, which you need to use in your Kusto query. The DeviceTvmHardwareFirmware table in the advanced hunting schema contains information on the hardware and firmware of devices. This data is retrieved as per Microsoft Defender Vulnerability Management. The relevant information includes the system model, processor, and BIOS, among others.
You should not use the DeviceInfo table. The DeviceInfo table in the advanced hunting schema contains information about devices in the organization, including the OS version, active users, and computer name. Since the scenario requires you to extract information about the hardware and firmware of devices, you need to use the DeviceTvmHardwareFirmware table.
You should not use the DeviceEvents table. The DeviceEvents table in the advanced hunting schema contains information about various event types, including security control-triggered events, such as Microsoft Defender Antivirus and exploit protection. Since the scenario requires you to extract information about the hardware and firmware of devices, you need to use the DeviceTvmHardwareFirmware table.
You should not use the DeviceTvmInfoGathering table. The DeviceTvmInfoGathering table in the advanced hunting schema contains Microsoft Defender Vulnerability Management assessment events. These events include things like the status of various configurations and attack surface area states of devices. Since the scenario requires you to extract information about the hardware and firmware of devices, you need to use the DeviceTvmHardwareFirmware table.

---

### References

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference)  

[DeviceTvmHardware Firmware](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicetvmhardwarefirmware-table?view=o365-worldwide)  

[DeviceInfo](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceinfo-table?view=o365-worldwide)    

[Device Events](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceevents-table?view=o365-worldwide)  

[DeviceTvmInfoGathering](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicetvminfogathering-table?view=o365-worldwide)  

---

## Q0132:

You are using Microsoft Sentinel for proactive threat hunting. You use built-in queries, but you are worried about an industry-specific threat that will require a custom query to track. You want to start checking your environment for this threat immediately.

You need to quickly create a new query using only the required fields.
Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.

Create a list in the correct order

Possible actions

Fill in the Description field and complete the Entity mapping section.
On the Create custom query page, click the View query results link.
On the Hunting page, go to the Livestream tab.

Actions in order

1. On the Hunting page, select New query.
2. Fill in the Name and Custom query fields.
3. Select Create.

---

### Answer:

1. On the Hunting page, select New query.
2. Fill in the Name and Custom query fields.
3. Select Create.

In Microsoft Sentinel, threat hunting is made possible by running built-in or custom queries. These queries are advanced searches that use Kusto Query Language (KQL) and look for interesting data, such as indicators of compromise (loCs). The process of creating a new query for threat hunting is relatively straightforward.
First, you should select New query on the Hunting page. This will open the page that allows you to configure a new query.
Then, you should fill in the Name and Custom query fields. These are the only required fields when creating a query. The name will allow you to identify your query. The Custom query field is where the actual Kusto Query Language (KQL) content of the query is entered. This is the heart of the query seeing as the syntax of the KQL content will control what data you wish to include in the search, and what you are specifically looking for within that data.
Finally, you should select Create. Once the required fields are completed, selecting Create saves the query and you are ready to threat hunt.
You should not go to the Livestream tab on the Hunting page. Livestream is an offshoot of hunting queries. You can use a livestream to generate interactive sessions in which you can test new queries as events occur. From there, you can receive notifications of when a match is found and then launch an investigation if you need to, based on what the livestream discovers. Livestreams use an existing query as the input to create a session, so you would need a query that has already been created.
You should not fill in the Description field and complete the Entity mapping section. You only need to use the required fields since, in this scenario, you need to create a query quickly for a possibly imminent threat. While writing a description and completing entity mapping can be helpful, these are not required elements when creating a new query.
You should not click the View query results link on the Create custom query page. This allows you to quickly test your query. This might be helpful as a best practice to ensure your query does what you want it to do, but it is not a required part of query creation.

---

### References

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal) 

---

## Q0131:

You are threat hunting using Microsoft Sentinel. You have created a query designed to identify a specific event on your domain controller.
You need to create several similar queries because you have multiple domain controllers and want to keep each query separate. The solution should minimize administrative effort.

Which three actions should you perform in sequence to clone a query? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.

Create a list in the correct order

Possible actions

Select the ellipsis in the line of the query you want to modify and select Edit query.
On the Hunting page of Microsoft Sentinel, select New query.

Actions in order
1. On the Hunting page of Microsoft Sentinel, find the query you wish to clone.
2. Choose Clone query by clicking the ellipsis icon at the end of the row.
3. On the Create custom query page, make your edits then click the Create button.

---

### Answer:

1. On the Hunting page of Microsoft Sentinel, find the query you wish to clone.
2. Choose Clone query by clicking the ellipsis icon at the end of the row.
3. On the Create custom query page, make your edits then click the Create button.

First, you should find the query you wish to clone. You will do this by navigating to the Hunting page within Microsoft Sentinel and then looking through the list of queries. This will allow you to ensure the right initial query is cloned in the next step.
Next, you should choose the Clone query option. This is accessible via the ellipsis at the end of the row for the query you found in step one. This will make a copy of the query you identified in the first step and will take you to the page where you can make changes to that copy.
Finally, you should make your edits and then click the Create button. These edits will be made on the Create custom query page, which is the page you are taken to after selecting Clone query in step two. This will allow you to tweak the copy to your needs. When you click Create, the initial query you copied will still exist in its original state and a new query with the changes you make in this step will be generated and saved.
This process would allow you, for example, to alter the IP or hostname in the query to match your other domain controllers (DCs) but keep the rest of the query the same. As mentioned above, it also leaves the original query untouched. This is a fast and efficient way to make several queries that are related but that require minor tweaks to meet the desired outcome. Starting each query from scratch would take much longer and would be more likely to result in human error in the query syntax.
You should not select New query on the Hunting page of Microsoft Sentinel. Although this option could ultimately be chosen to generate the queries for your other DCs, as mentioned above, you would be starting from scratch. If you only need to change a few minor things in your query, going to New query is a waste of time as the clone option gives you a better starting point.

You should not select the ellipsis in the line of the query you want to modify and select Edit query. This would allow you to edit an existing query, but it would not create a copy of it. Any edits made here would alter the original query. With the Clone query option, you leave the original unaltered, while efficiently creating new queries based on it.

---

### References

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)  

---

## Q0130:

You are using Microsoft Defender for Cloud and Microsoft Sentinel to protect your cloud workloads and monitor your environment.
You need to use the Kusto Query Language (KQL) to construct a query that identifies Microsoft Defender for Cloud alerts.
Which query should you write to meet this requirement? To answer, complete the query by selecting the correct options from the drop-down menus.

Choose the correct options

OPTIONS-1/2: SecurityAlert | Microsoft Defender for Cloud | Microsoft Sentinel

`OPTIONS-1 | where ProductName == "OPTIONS-2" `

`SecurityAlert | where ProductName == "Microsoft Defender for Cloud" `

---

### Answer:

You should complete the query as follows:

`SecurityAlert | where ProductName == "Microsoft Defender for Cloud"`

This completes a basic query to identify all security alerts in Microsoft Defender for Cloud. Placing SecurityAlert first queries the SecurityAlert table, and then using | where ProductName == "Microsoft Defender for Cloud" afterwards ensures that in that Security Alert table you are only looking for entries where the ProductName column has the value of Microsoft Defender for Cloud. From here, you can expand. For example, you could use KQL to specify time frames or specific devices to query. Kusto Query Language (KQL) is the language that you will use when building queries in Microsoft Sentinel. Queries serve as a way to search through the massive amount of data that Microsoft Sentinel has access to.
You should not begin the query with Microsoft Defender for Cloud. The structure of a query requires that you first identify the key table that you will be querying. The SecurityAlert table includes the security alerts that are being digested by Microsoft Sentinel. You should first query this table, then narrow the search down to the alerts coming from the Microsoft Defender for Cloud product.
You should not begin the query with Microsoft Sentinel. Again, the structure of a query requires that you first identify the key table that you will be querying. In this case, that would be the SecurityAlert table. More importantly, while Microsoft Sentinel is the solution which is aggregating this data and performing the query, it should not be used as the ProductName. This should be specified as the Microsoft Defender for Cloud.
You should not end the query with Microsoft Sentinel. As mentioned in the paragraph above, the ProductName (solution source) for the Security Alert (alerts) table that you should query is Microsoft Defender for Cloud. The query would be run in Microsoft Sentinel, but do not confuse the solution being queried with the one that is running the query.
You should not end the query with Security Alert. Here you need to name the solution that you want to query. In this case, that is Microsoft Defender for Cloud. SecurityAlert would not be a valid ProductName.

---

### References

[Ingest Microsoft Defender for Cloud alerts to Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-defender-for-cloud)  

---

## Q0129:

You are using Microsoft Defender XDR to be proactive and search for threats in your environment before receiving alerts. You enter the Microsoft Defender portal to create a query using Kusto Query Language (KQL). This query is seeking out a specific process executing in your environment.
You need to narrow the focus of this query so that it includes only the last two weeks and only 50 results, sorted by the time range column.
Which two lines should you add to the query to meet these requirements? Each correct answer presents part of the solution.

Choose the correct answers

- | limit 50 by Timestamp
- | limit Timestamp > ago (14d)
- | join Timestamp > ago (14d)
- | top 50 by Timestamp
- | where Timestamp > ago (14d)

---

### Answer:
- | top 50 by Timestamp
- | where Timestamp > ago (14d)


You should add the following lines to the query:

| where Timestamp > ago (14d)
| top 50 by Timestamp

To understand a KQL query, you require strong knowledge of syntax and operators. First, as both of these lines would come further down in the query after starting with the table name, we use the pipe (1) to add elements to the query. Second, you need to know which operators to use. For the time frame portion of the solution, the where operator would filter the table to only rows that match our indicated selection, in this case: TimeStamp. You should then use the > ago(14d) syntax to set the query to 2 weeks/14 days. For the second portion of the solution, the top operator returns a selected number of records. You then use by Timestamp to specify what you will sort by.
It is important to note that all of the operators used are real and have their purposes. Microsoft defines the additional operator descriptions as follows:
limit - Return up to the specified number of rows.
join - Merge the rows of two tables to form a new table by matching values of the specified column(s) from each table.
You should not use | join Timestamp > ago(14d). You would only use Join if you were taking multiple tables,
looking for matching columns, and then creating a new table with the results. This can be powerful with complex queries, but our query only requires one table, so join is not needed.
You should not use | limit 50 by Timestamp. While this would also return 50 results, it does not do the sorting that the top operator does. As the question mentions that the query needs to be sorted by the time range column, the top operator is needed.
You should not use | limit Timestamp > ago (14d). Instead of selecting the Timestamp table and filtering to the rows needed, like the where operator does, the limit operator would simply reduce the amount of rows returned in the query to a set number. You need to limit the specific data retrieved from the Timestamp table, in this case, to two weeks of data, not just the number of rows returned.

---

### References

[Learn the advanced hunting query language](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-query-language?view=o365-worldwide)  

---

## Q0128:

You are using Microsoft Sentinel with integrated Microsoft Defender XDR to investigate an incident that occurred at your company.
You need to establish an advanced hunting query that counts the failed sign-in authentications on two devices named User1Laptop and User2Laptop.
Which four expressions should you write in sequence? To answer, move the appropriate expression from the list of possible expressions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible expressions
DeviceFileEvents

Expressions in order

1. DeviceLogonEvents
2. | where DeviceName in ("UserlLaptop, "User2Laptop) and
3. ActionType == FailureReason
4. | summarize LogonFailure=count() by DeviceName, LogonType

---

### Answer:

You should write the following expressions in order:

1. DeviceLogonEvents
2. where DeviceName in ("User1Laptop, "User2Laptop) and
3. ActionType == FailureReason
4. summarize LogonFailure=count() by DeviceName, LogonType

To establish an advanced hunting query, you should first write the following expression:

`DeviceLogonEvents`

This expression is used for sign-ins, as well as other authentication events.
You should then write the following expression:

`| where DeviceName in ("UserlLaptop, "User2Laptop) and`

This expression will allow you to specify the names of the devices on which the failed sign-ins occurred. This expression is required after defining the sign-in event in the query.

Next, you should write the following expression:

`ActionType == FailureReason`

This expression will allow you to define the action that occurred when the users attempted to sign in. The activity of signing in refers to logon in the first line of the code. ActionType is used to specify the activity or action that triggered the event, and FailureReason is used to provide information about why the activity or action has failed.
Finally, you should write the following expression:

`| summarize LogonFailure=count() by DeviceName, LogonType`

This expression will allow you to count the number of times that the users tried to sign to their devices and failed. This expression must follow the expression that defines the type of action that occurred.
You should not write the following expression:

`DeviceFileEvents`

This expression is used for defining events done by users like creating files, modifying files, and other file system events. The scenario does not mention anything about files.

---

### References

[DeviceLogonEvents](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicelogonevents-table?view=o365-worldwide)  

[Learn the advanced hunting query language](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-query-language?view=o365-worldwide)    

[Proactively hunt for threats with advanced hunting in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-overview?view=o365-worldwide)    

[DeviceFileEvents](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicefileevents-table?view=o365-worldwide)  

[Microsoft Defender XDR integration with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration?tabs=azure-portal)    

[Hunt for threats with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunting?tabs=azure-portal)  

---

## Q0127:

You manage Microsoft Sentinel in your organization. You are requested to configure a new analytics rule to detect advanced multistage attacks.
You need to create an analytics rule.

What rule type should you use?

Choose the correct answer

- Threat Intelligence
- Fusion
- Anomaly
- Microsoft security

---

### Answer:

- Fusion

You should use the Fusion rule type. Fusion rules in Microsoft Sentinel combine multiple signals or alerts from different data sources to detect complex threats or attack patterns. These rules enable analysts to correlate various security events and create a unified view of potential security incidents.
You should not use the Anomaly rule type. Anomaly detection rules identify abnormal behavior or deviations from normal patterns within the data. These rules use statistical analysis or machine learning algorithms to detect unusual activities that may indicate potential security threats.
You should not use the Microsoft security rule type. Microsoft security rules are predefined rules developed by Microsoft to detect common security threats or attack techniques based on known indicators of compromise (IOCs) or behavioral patterns. These rules leverage Microsoft's threat intelligence and security expertise to provide comprehensive protection against various types of cyber threats.
You should not use the Threat Intelligence rule type. Threat intelligence rules use external threat intelligence feeds or sources to identify known malicious indicators or patterns of attack. These rules compare network activities or security events against threat intelligence data to detect and block malicious behavior or suspicious activities.

---

### References

[Types of analytics rules](https://learn.microsoft.com/en-us/training/modules/analyze-data-in-sentinel/4-analytics-rules)  

[Threat detection with Microsoft Sentinel analytics](https://learn.microsoft.com/en-us/training/modules/analyze-data-in-sentinel/)  

---

## Q0126:

Your organization has recently purchased an Azure subscription. You have enabled Microsoft Defender for Cloud for all supported resource types.
You want to implement security best practices across your organization to satisfy the following requirements:
Create rules that can centrally manage automation in Microsoft Sentinel.
Perform basic incident handling.
• Inspect the contents of an incident and initiate further action.
You need to implement a solution to remediate attacks.

What should you include in the solution?

Choose the correct answer

- Azure Functions
- WebJobs
- Azure Logic Apps
- Azure Resource Manager

---

### Answer:
- Azure Logic Apps

In this scenario, you can satisfy the requirements by creating Microsoft Sentinel automation rules. Automation rules are a way to centrally manage automation in Microsoft Sentinel, seeing as you can define and coordinate a small set of rules that can be applied in various situations. There are three components in Automation rules: Triggers, Conditions and Actions. Furthermore, given the last requirement, the recommended best practice would be to leverage a playbook. A Microsoft Sentinel playbook is a collection of different remediation actions that can be run from Microsoft Sentinel as a routine. To execute a Microsoft Sentinel playbook, you require an automated workflow in Azure Logic Apps. Thus, the recommended solution for this use-case scenario requires you to include Azure Logic Apps in the implementation.
You should not use Azure Functions. Azure Functions is a serverless solution which allows you to write less code, maintain less infrastructure, and save on costs. In this scenario, you need to use Microsoft Sentinel playbooks, which requires the automated workflow in Azure Logic Apps.
You should not use WebJobs. WebJobs is a feature of Azure App Service that enables you to run a program or script in the same instance as a web app, API app, or mobile app.
You should not use Azure Resource Manager. Azure Resource Manager is the deployment and management service for Azure. It provides a management layer that enables you to create, update, and delete resources in your Azure account.

---

### References

[Automate threat response in Microsoft Sentinel with automation rules](https://learn.microsoft.com/en-us/azure/sentinel/automate-incident-handling-with-automation-rules?tabs=onboarded)  

[What is Azure Logic Apps?](https://learn.microsoft.com/en-us/azure/logic-apps/logic-apps-overview) 

R[un background tasks with WebJobs in Azure App Service](https://learn.microsoft.com/en-us/azure/app-service/webjobs-create?tabs=windowscode) 

[What is Azure Resource Manager?]()

[Azure Functions overview]()


---

## Q0125:

You create a Microsoft Sentinel playbook.
After several months you notice some areas for improvement. You decide to make a copy of your playbook and make changes to the copy instead of the original.
Which two Logic Apps actions should you select? Each correct answer presents part of the solution.

Choose the correct answers

- Edit
- Clone
- Refresh
- Update Schema
- Export

---

### Answer:

- Edit
- Clone

Once you create playbooks, you can use the Logic Apps header bar as a location to run actions on them.
You access the Logic Apps header bar by navigating to the Playbooks page and selecting an existing playbook.
You should select Clone. This action will create a copy of your playbook. You maintain the original playbook and you can use its copy as your playground for testing. Unless you want both playbooks running at the same time, you may want to disable the original playbook while testing with the copy.
You should also select Edit. This action opens the selected playbook on the Logic Apps Designer page and allows you to edit the copy of the playbook. You can make all the changes you want and save them. If you want to test out your playbook after making these edits, you can do so using the Run Trigger action.
You should not select Export. This action exports the logic app from the playbook to Microsoft Power Automate or Microsoft Power Apps. You would use this action if your underlying logic app was something you knew might be useful in Microsoft Power Automate or Microsoft Power Apps.
You should not select Update Schema. While this action sounds similar to editing, you would only run it if you needed to make a significant change to the logic within a playbook, not for minor edits. You should use Update Schema to make major logic changes and when a playbook/logic app does not seem to be functioning properly.
You should not select Refresh. This action is used to retrieve the most current playbook or logic app activity status. It can be useful in troubleshooting, but it does not meet either of the scenario requirements.

---

### References

[Trigger a playbook in real-time](https://learn.microsoft.com/en-us/training/modules/threat-response-sentinel-playbooks/4-playbook-trigger)  


---

## Q0124:

You are using Microsoft Sentinel for automated responses to alerts and incidents in your environment, but you are experiencing issues with a playbook not running. While troubleshooting, you notice that the playbook has a trigger kind of Not initialized.
You need to remediate this issue and make the playbook functional.

What should you do?

Choose the correct answer

- Add triggers or actions to the playbook.
- Edit the analytics rule that generates the incident you want to define an automated response for.
- From the Automation rules tab in the Automation blade, create a new automation rule and specify the appropriate conditions and desired actions.
- Run the playbook manually.

---

### Answer:
- Add triggers or actions to the playbook.


You should add triggers or actions to the playbook. The reason for this ties back to the trigger kind. A trigger kind of Not initialized means that the playbook has been created, but that it does not contain any components. It needs triggers or actions in order to function as desired. Once the appropriate components are added, the trigger kind will change. Valid trigger kinds include Microsoft Sentinel Incident/Alert, Using Microsoft Sentinel Action, and Other.
You should not run the playbook manually. Since the playbook has a trigger kind of Not initialized, you will not be able to run the playbook automatically or manually. Playbooks can only be run manually on alerts, not incidents. Even if the playbook had a valid trigger kind, only playbooks with an alert trigger could be run automatically or manually.
You should not edit the analytics rule that generates the incident you want to define an automated response for. Analytics rules cover a broader range than playbooks. A playbook can be a component of the Automated response tab (under Alert automation) in the Analytics rule wizard. Analytics rules search for specific events, or sets of events, across the data being ingested by Sentinel. By setting rule logic, incident settings, and automated response configurations in the Analytics rule wizard, you use analytics rules to lay out a scenario in which a playbook will run. Analytics rules look for events defined by Kusto Query Language (KQL) queries, including alerts, whereas automation rules look for incidents. They both can use playbooks as their response mechanism.
You should not create a new automation rule and specify the appropriate conditions and desired actions from the Automation rules tab in the Automation blade. Like analytics rules, automation rules are a broader Sentinel tool that can use playbooks as a component. Creating a new automation rule would have no impact on the trigger kind type or the playbook not functioning. However, automation rules are a mechanism by which you can run playbooks in response to incidents. Automation rules look for incidents, whereas Analytics rules look for events defined by Kusto Query Language (KQL) queries, including alerts. Despite those differences they can both use playbooks as their response mechanism.

---

### References

[Automate threat response with playbooks in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/automate-responses-with-playbooks)  

[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)    

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  



---

## Q0123:

Your company is using Microsoft Sentinel Security Orchestration, Automation and Response (SOAR) capabilities to respond to incidents.
You have many playbooks set for automatic response, but you have identified an alert that you need to run a playbook on manually.
You need to run a playbook on demand.
Which three actions should you perform in sequence? 
To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.

Create a list in the correct order

Possible actions
On the Automation page, select the Playbooks tab.
On the Incidents page, click the Actions button.

Actions in order

1. On the Incidents page, select an incident and click on View full details.
2. In the Alerts tab, click on the alert you want to run the playbook on.
3. Click View playbooks and select a playbook to run from the list of available playbooks on the subscription.

---

### Answer:

You should perform the actions in the following order:

1. On the Incidents page, select an incident and click on View full details.
2. In the Alerts tab, click on the alert you want to run the playbook on.
3. Click View playbooks and select a playbook to run from the list of available playbooks on the subscription.

First, you should select an incident and click on View full detail on the Incidents page. This action will bring up all of the alerts that make up the incident, which is essential to perform the next step.
Then, you should click on the alert you want to run the playbook on in the Alerts tab. This will select that specific alert and allow you to take actions on it, including viewing what playbooks you can run on it.
Finally, you should click View playbooks and select a playbook to run from the list of available playbooks on the subscription. This will run the chosen playbook on your selected alert.
You should not navigate to the Incidents page and click the Actions button. This option offers several choices to perform critical tasks to investigate incidents and explore the threat chain. However, manual/on- demand playbooks can only be run at the alert level. The Actions cog is taking action at the incident level as it is found on the Incidents page.
You should not select the Playbooks tab on the Automation page. You can only run an on-demand playbook from an alert. The playbooks tab allows you to create and edit playbooks. You could create or edit a playbook that you later run manually/on demand, but you will always first have to find an alert to target.

---

### References

[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook?tabs=LAC%2Cincidents)  

[Best practices for Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/best-practices)  



---

## Q0122:

You use Microsoft Sentinel as a Security Information and Event Management (SIEM) solution. You want to increase its Security Orchestration, Automation and Response (SOAR) capabilities.
You need to create a playbook that uses an Azure logic app to communicate with other systems and services via API calls to a known, commonly-used product or service.

Which connector should you configure?

Choose the correct answer

- Microsoft Sentinel connector
- Managed connector
- Custom connector
- Trigger

---

### Answer:
- Managed connector

You should configure a managed connector. A managed connector is defined as a set of actions and triggers that uses API calls going out to particular products or services. In other words, they are the pre-built connectors for known, commonly-utilized solutions. Azure Logic Apps provides hundreds of these managed connectors which communicate with both Microsoft and non-Microsoft services.

You should not configure a custom connector. This type of connector is used to communicate with a product or service not found among the common, known pre-built connectors (also known as managed connectors). Depending on your use case, you may need an Azure logic app to communicate with services that are not found in the managed connectors by using custom connectors. Custom connectors allow you to create a connector and define the triggers and actions that connector will be involved with.
You should not configure a Microsoft Sentinel connector. You need to communicate with a known, common product or service. With a Microsoft Sentinel connector, you communicate or interact with Microsoft Sentinel. This does not meet the scenario's requirement.

You should not configure a trigger. A trigger initiates a playbook and can be defined as a component of a connector. As a component of a connector and not a connector itself, triggers cannot handle communication with known, common products of services. Triggers ensure that alerts or incidents start a playbook. An alert trigger simply receives an alert as input, whereas an incident trigger receives the incident and all related information (alerts and details/entities).

---

### References

[Automate threat response with playbooks in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/automate-responses-with-playbooks)  

[Microsoft Sentinel data connectors](https://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources?tabs=azure-portal)  

---

## Q0121:

Your manager wants a solution that runs playbooks as a response to incidents that are likely to occur at the company.
You need to recommend a solution that fulfills the manager's request.
What solution should you recommend?

Choose the correct answer

- Notebooks in Microsoft Sentinel
- Attack surface reduction rules
- Automation rules in Microsoft Sentinel
- Microsoft Defender for Cloud Apps anomaly detection policies

---

### Answer:

- Automation rules in Microsoft Sentinel
You should recommend automation rules in Microsoft Sentinel. In Microsoft Sentinel, automation rules assist you in incident triage. They can allocate issues to the appropriate employees automatically, close noisy incidents or known false positives, alter their severity, and add tags. They are also the method for executing playbooks in reaction to events. To create automation rules, you should access the Automation page in the Microsoft Sentinel portal and then set the event that the automation rule will act upon.
You should not recommend Microsoft Defender for Cloud Apps anomaly detection policies. Anomaly detection policies in Microsoft Defender for Cloud Apps work by analyzing data collected from various sources, such as log files, network traffic, and user behavior, to identify deviations from normal behavior patterns. When an anomaly is detected, Microsoft Defender for Cloud Apps generates an alert, allowing security teams to investigate and respond to potential threats. This solution can trigger the next steps, which are run according to defined automation rules in Microsoft Sentinel.

You should not recommend notebooks in Microsoft Sentinel. In Microsoft Sentinel, you can use notebooks to perform advanced data analysis and visualization. Notebooks are interactive documents that allow you to run code, display data, and create visualizations. You can use them to explore and analyze data, create custom detections, and investigate incidents. Notebooks cannot be used to run playbooks in response to incidents as required in the scenario.
You should not recommend attack surface reduction rules. Attack surface reduction rules are a set of security controls in Microsoft Defender for Endpoint that help reduce the attack surface of your devices or networks. These rules are designed to block common attack vectors and prevent malicious code from running in your environment. Attack surface reduction will not help you to run playbooks in response to likely incidents.

---

### References

[Anomaly detection policies in Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy)  

[Use Jupyter Notebook to hunt for security threats](https://learn.microsoft.com/en-us/azure/sentinel/notebooks)  

[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)

[Attack surface reduction rules overview](https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction)  

---

## Q0120:

You are creating a custom rule in Microsoft Sentinel.
You have decided to group the alerts this rule generates into a single incident by Severity.
You need to select the right alert grouping option in the Analytics rule wizard.

Which option should you select to group the alerts?

Choose the correct answer

- Group all alerts triggered by this rule into a single incident
- Re-open closed matching incidents
- Group alerts into a single incident if the selected entities and details match
- Group alerts into a single incident if all the entities match


---

### Answer:
- Group alerts into a single incident if the selected entities and details match

You should select the Group alerts into a single incident if the selected entities and details match option. This is the correct option because Severity is one of the entities that you can use to group matching alerts. There are other options that will group alerts into a single incident, but this is the only selection that allows you to use the Severity of the alerts as the criteria that must match. After selecting this option via the radio button, you will use the drop-down to select the entity to match; in this case, the alert Severity.
You should not select the Re-open closed matching incidents option. This refers to the process of deciding to either re-open a closed incident when an alert comes along that matches it, versus the alternative of simply opening a new incident.
You should not select the Group alerts into a single incident if all the entities match option. Although Severity would be one of the items matched here, this option dictates that every single entity the alerts have tied to them must match to bring them together in an incident. In other words, there would be many other entities besides Severity that would be matching here. This is the default setting. This ensures that incidents consist of alerts that are truly strongly related.
You should not select the Group all alerts triggered by this rule into a single incident option. This is ultimately saying that any alert triggered by this rule will become part of the incident the rule is generating. The alerts could have nothing in common except being generated by the rule. Perhaps most significant in this scenario, there would be alerts of varying severity grouped together with this option. As such, it does not fulfill your requirements.

---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  

---

## Q0119:

As a security analyst in a Security Operations Center (SOC), you receive an alert regarding a potential data breach.
You need to quickly initiate a series of predefined investigation and remediation actions to contain the threat.
What feature or capability in Microsoft Sentinel should you use to automate and orchestrate these actions seamlessly?

Choose the correct answer

- Threat Hunting
- Threat Detection
- Notebook
- Playbook


---

### Answer:

- Playbook

You should use a playbook. In this scenario, where rapid response is critical to contain a potential data breach, the appropriate feature in Microsoft Sentinel to automate and orchestrate predefined investigation and remediation actions seamlessly is a Playbook. Playbooks allow security analysts to define a series of automated responses to specific alerts or incidents. They can include various actions such as querying data sources, running scripts, sending notifications, and taking remediation steps. By utilizing playbooks, SOC teams can streamline their response efforts, reduce manual intervention, and mitigate security threats more effectively.
You should not use Threat Detection. Threat detection refers to the process of identifying potential security threats or suspicious activities within an organization's network, systems, or applications. This process involves monitoring various data sources, such as logs, events, network traffic, and endpoint activities, to detect indicators of compromise (IOCs), anomalous behavior, or known attack patterns. While threat detection is crucial for identifying potential security threats, it does not directly facilitate the automation and orchestration of response actions like a playbook does.

You should not use Threat Hunting. Threat hunting is a proactive cybersecurity practice aimed at identifying and mitigating advanced threats that may evade traditional security measures. Unlike traditional threat detection, which relies on automated systems to identify known patterns or anomalies, threat hunting involves human-driven analysis and investigation to uncover hidden threats that may not be detected by automated systems alone. Threat hunting does not offer predefined automated response actions like a playbook.
You should not use a notebook. Notebooks in Microsoft Sentinel are useful for performing data analysis and creating custom visualizations, but they are not specifically designed for automating and orchestrating response actions like a playbook.

---

### References

[Investigate incidents with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases)  

[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)    

[Detect threats out-of-the-box](https://learn.microsoft.com/en-us/azure/sentinel/threat-detection)    

[Use Hunts to conduct end-to-end proactive threat hunting in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/hunts)    

[Use Jupyter notebooks to hunt for security threats](https://learn.microsoft.com/en-us/azure/sentinel/notebooks)  

---

## Q0118:

As a member of an incident response team in Microsoft Sentinel, you receive a new incident named Suspicious Network Activity with a severity marked as High.
You need to triage the incident.
What is the first step you should take?

Choose the correct answer

- Analyze the timestamp of the incident.
- Review the username associated with the suspicious activity.
- Assign the incident to an appropriate owner.
- Update the status of the incident.

---

### Answer:

- Assign the incident to an appropriate owner.

You should assign the incident to an appropriate owner. Assigning the incident to an appropriate owner ensures that responsibility is delegated for further investigation and resolution. This step helps in organizing and prioritizing incident response efforts effectively.
You should not Analyze the timestamp of the incident. Analyzing the timestamp provides insights into when the incident occurred but it is not the first triage step.
You should not Review the username associated with the suspicious activity. Reviewing the username may be part of the investigation but it is not the first triage step.
You should not Update the status of the incident. Updating the status of the incident prematurely changes the status before it has been investigated. In the context of incident response, changing the status of an incident prematurely can lead to inaccurate reporting or oversight of unresolved issues.

---

### References

[Security incident management in Microsoft Sentinel](https://learn.microsoft.com/en-us/training/modules/incident-management-sentinel/)  

[Incident management](https://learn.microsoft.com/en-us/training/modules/incident-management-sentinel/5-manage-incidents)

---

## Q0117:

You are the lead of an incident investigation reported in Microsoft Sentinel.
You need to ensure that your team members know that you are investigating the incident.
Which two actions should you perform? Each correct answer presents part of the solution.
Choose the correct answers

- When closing the incident, include your name in the Comments section.
- Change the status to New.
- Change the Owner to "Assign to me".
- Change the status to In Progress.

---

### Answer:

- Change the Owner to "Assign to me".
- Change the status to In Progress.

You should change the Owner to "Assign to me". In case you want to assign the incident to someone else, you can do this from the same location. Establishing the ownership of an incident is a critical step to ensuring investigations happen without overlapping, wasted effort.
You should also change the status to In Progress. You can continue and assign every incident in your organization to an owner, but if the Status remains set to New, your team members will assume that the incident has not yet been addressed.
You should not include your name in the Comments section when you close the incident. This would only be visible to users who click into the incident and view the comments, so it is not an effective way to show who is handling the incident. The Comments section is reserved for content that might help others who are looking into the incident, like specific information about the investigation's findings or its resolution.
You should not change the status to New. This is the default status of investigations before they are changed and the incident status is very rarely changed to New. Setting the Status back to New could indicate to your team members that the incident needs to be addressed by someone else. In that case, if you assigned yourself as owner, you may want to change ownership to unassigned or to assign it to a team member.

---

### References

[Investigate incidents with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases)  

---

## Q0116:

You are wrapping up an investigation within Microsoft Sentinel.
After significant research into the alerts within the incident, you conclude that the incident was not malicious and that several of the alerts were generated by analytics rules that do not work properly.
You need to categorize the incident.
Which classification should you use?

Choose the correct answer

- Undetermined
- False Positive - inaccurate data
- Benign Positive - suspicious but expected
- False Positive - incorrect alert logic

---

### Answer:
- False Positive - incorrect alert logic

You should use False Positive incorrect alert logic. Choosing one of the false positive options declares the event as something that should have never been called an incident. The question scenario states that this false positive was the result of faulty logic in the analytics rule producing the alerts, so this is the correct answer.
You should not use False Positive inaccurate data. Choosing one of the false positive options declares the event as something that should have never been called an incident. However, the inaccurate data option is saying that the actual data, typically logs of some kind, is not correct. For example, you might choose this option if a log says a user was logging in from a foreign IP address, but you determine that this was not the case.
You should not use Undetermined. This classification is rarely used. If your company has service level
agreements (SLAs) around closing out incidents, you may need to select this option. However, spending more time investigating and developing a more accurate classification of the incident is highly preferable.
You should not use Benign Positive suspicious but expected. A Benign Positive activity is real and correct data and logic that identify an event that was non-malicious in nature. An example of this might be an administrator clearing system logs. Deleting system logs could be the malicious actions of a hacker covering their tracks (which would be a True positive), but clearing logs may also be the actions of a Systems administrator making space on a disk drive (which would be Benign Positive suspicious but expected). The key is identifying the intent and the individual taking the action.

---

### References

[Investigate incidents with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases)

[Handle false positives in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/false-positives)  



---

## Q0115:

Your company is being targeted by a threat actor that utilizes virtual private network (VPN) access to infiltrate the internal networks of their victims. You suspect that the VPN credentials of a user were compromised.
You need to use Microsoft Sentinel to investigate anomalous VPN logon activity for this user.
Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions
On the Sentinel Incidents page, type VPN into the Search bar.
After selecting an individual incident, select Investigate to view the accounts, machines, and other data points involved.

Actions in order

1. On the Sentinel Workbooks page, navigate to the User and Entity Behavior Analytics (UEBA) workbook.

2. Search for the user's name and select their name in the Top users to investigate table.

3. Scroll down to the Incidents Breakdown and Anomalies Breakdown tables to view the incidents and anomalies associated with the selected user.

---

### Answer:

You should perform the following steps in order:

1. On the Sentinel Workbooks page, navigate to the User and Entity Behavior Analytics (UEBA) workbook.
2. Search for the user's name and select their name in the Top users to investigate table.
3. Scroll down to the Incidents Breakdown and Anomalies Breakdown tables to view the incidents and anomalies associated with the selected user.

First, you should navigate to the User and Entity Behavior Analytics (UEBA) workbook on the Sentinel Workbooks page. Microsoft Sentinel is a powerful tool to aid in investigations. Workbooks can provide a great place to start those investigations. When users are involved, the User and Entity Behavior Analytics (UEBA) workbook is a crucial aid.
Then, you should search for the user's name and select their name in the Top users to investigate table. This is the location that will feature users that Microsoft Sentinel has determined warrant additional investigation.
Finally, you should Scroll down to the Incidents Breakdown and Anomalies Breakdown tables to view the incidents and anomalies associated with the selected user. This will present content and information Microsoft Sentinel deemed suspicious for that specific user.
You should not type VPN into the Search bar on the Sentinel Incidents page. Although this search may pull
up incidents that include the string VPN somewhere in the title, tags, or other search parameter, this is not an area where you can search by user or narrow the search to only VPN anomalies. You need the UEBA workbook for this specific use case.
You should not select Investigate to view the accounts, machines, and other data points involved after selecting an individual incident. Although this step may be helpful once you identify which incidents are truly related to anomalous VPN logons, it does not meet any of the scenario requirements.

---

### References

[Tutorial: Investigate incidents with UEBA data](https://learn.microsoft.com/en-us/azure/sentinel/investigate-with-ueba)  


---

## Q0114:

You are using Microsoft Sentinel to investigate a series of incidents that occurred within the last 48 hours.
You need to narrow down your investigation to the incidents that most recently had additional
details/information added, and those that are categorized as High severity.
Which two actions should you perform on the Incidents page? Each correct answer presents part of the solution.

Choose the correct answers

- Change the Severity filter from All to High.
- Select the Last update time column header to sort by this parameter.
- Change the Status filter from New, Active to New.
- Go to Search and add the Alert severity parameter.

---

### Answer:

- Change the Severity filter from All to High.
- Select the Last update time column header to sort by this parameter.

You should change the Severity filter from All to High. This action will filter out all non-High severity incidents, which meets the scenario requirements. Filtering will remove incidents from the displayed list, while column sorting using the selected parameter simply reorders the incidents in the list.
You should also select the Last update time column header to sort by this parameter. Whether you perform this action before or after setting the Severity filter, this will take all options displayed on the page and sort them by this parameter. Keep in mind that the created time is when the incident first appeared/was formed. If you are looking for the incidents that have been most recently altered, the Last update time column is what you need to sort by.
You should not go to Search and add the Alert severity parameter. Alert severity is a parameter accessible in advanced search. The scenario requires the use of the Severity filter at the incident level. It does not mention anything about alert severity.
You should not change the Status filter from New, Active to New. An incident being recently updated and having a new Status are not correlated. Status is simply related to whatever you, the investigator, set it to. All incidents start as new. While investigating, you should change the status to Active. Finally, you should set the status to Closed when the investigation into the incident is complete. None of these statuses has any correlation to how new an incident is. An incident that is 30 seconds old could be closed by a quick investigation, while a two-week old investigation still sits in New status after being overlooked.

---

### References

[Investigate incidents with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases)  

---

## Q0113:

An incident occurs at your company where sensitive data has been compromised. Your company uses Microsoft Sentinel. Your manager requests that the incident be investigated.
You need to investigate the incident using Microsoft Sentinel.
Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.

Create a list in the correct order

Possible actions

Select the Classification option on the Incident page.
Fill in the incident owner field in the Microsoft Sentinel portal.

Actions in order

1. Choose the Incidents option in the Microsoft Sentinel portal.
2. Choose the incident that occurred from a list shown in the Microsoft Sentinel portal.
3. Select the Investigate button on the Incident page.

---

### Answer:

1. Choose the Incidents option in the Microsoft Sentinel portal
2. Choose the incident that occurred from a list shown in the Microsoft Sentinel portal
3. Select the Investigate button on the Incident page

To investigate an incident, you should first choose the Incidents option in the Microsoft Sentinel portal. This action will allow you to access the Incidents page, which contains all the incidents that have occurred in the company. To apply this step, you will click on the Incidents option, found on the left-hand side of the screen in the Microsoft Sentinel portal.
The next step is to choose the incident that occurred from a list, shown in the Microsoft Sentinel portal. This action allows you to click on any incident to display information related to it on the right-hand side of the screen.
Finally, you should select the Investigate button on the Incident page. This action, performed in the Microsoft Sentinel portal, will allow you to investigate the incident that you have chosen in the previous step. By clicking on this option, Microsoft Sentinel will start investigating the incident. Microsoft Sentinel investigates an incident by displaying an investigation graph of the incident, helping you to identify the entities included in an attack and the relationships between these attacked entities. Microsoft Sentinel also allows the user to click on an attacked entity to view important incident metadata, which is useful in the analysis of the attack and crucial in taking the next steps to prevent such attacks from occurring again.
You should not fill in the incident owner field in the Microsoft Sentinel portal. This step allows you to assign an incident to a specific user simply by accessing the incident owner field and filling it in. This does not meet the scenario's requirement as the manager did not ask you to assign the incident to any user.
You should not select the Select Classification option on the Incidents page. This step, done in the Microsoft Sentinel portal, will allow you to classify the activity as a True positive (suspicious activity), Benign positive (suspicious but expected), False positive (incorrect alert logic), False positive (Inaccurate data), or Undetermined activity.

---

### References

[Investigate incidents with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases)  

---

## Q0112:

Your organization has recently experienced a security breach.
You have been tasked with taking preventive measures to avoid such incidents in the future. You have decided to start by performing threat hunting.
You need to search the Device Process Events table of Microsoft Graph activity logs for events triggered by the powershell.exe process.
How should you complete the query? To answer, select the appropriate options from the drop-down menus.

Choose the correct options

OPTIONS:
Microsoft.Graph.Security |  Microsoft.Powershell.Security

OPTIONS:
Start-MgSecurityHuntingQuery | Get-ExecutionPolicy

```
Import-Module [OPTIONS]
$params = @{
Query = "DeviceProcessEvents | where Initiating ProcessFileName =~ "powershell.exe""
}
[OPTIONS] HuntingQuery -BodyParameter $params
```

```
Import-Module Microsoft.Graph.Security
$params = @{
Query = "DeviceProcessEvents | where Initiating ProcessFileName =~ "powershell.exe""
}
Start-MgSecurityHuntingQuery -BodyParameter $params
```

---

### Answer:

```
Import-Module Microsoft.Graph.Security
$params = @{
Query = "DeviceProcessEvents | where InitiatingProcessFileName =~ "powershell.exe""
}
Start-MgSecurityHuntingQuery -BodyParameter $params
```

You should first import the Microsoft.Graph. Security module. This command imports the Microsoft Graph Security module, which provides cmdlets for interacting with security-related data and operations using the Microsoft Graph API.
Then, the parameters for the hunting query are defined using the $params variable. It is a hashtable (@{}) (key-value pairs) containing the Query parameter. In this scenario the content of the variable $params will be the following:

> Name: Query
> Value: DeviceProcessEvents where InitiatingProcessFileName = ~ 'powershell.exe'

Then, the Query parameter specifies the query to be executed during the threat hunting process. In this scenario, the query searches the DeviceProcessEvents table for events where the Initiating ProcessFileName property matches the value "powershell.exe". The ~ operator is used for pattern matching.
Finally, you should run the Start-MgSecurity HuntingQuery cmdlet. This cmdlet initiates the security hunting query with the specified parameters. It takes the $params variable as the Body Parameter, which contains the query to be executed.
Overall, this scriptlet is used to start a threat hunting query to search for events related to the powershell.exe process in the DeviceProcessEvents table within the organization's security data.
You should not use Microsoft.PowerShell.Security. Microsoft.PowerShell. Security is a PowerShell module that provides cmdlets and functions related to security features and settings in the PowerShell environment. This module includes cmdlets for managing execution policies, digital signatures, certificates, and other security-related configurations. This module cannot be used to access Microsoft Graph activity logs.

You should not use Get-Execution Policy. The Get-Execution Policy PowerShell cmdlet is used to retrieve the current execution policy that determines the level of security enforced for running scripts on a system. The execution policy defines the conditions under which PowerShell scripts are allowed to run. This cmdlet cannot be used to execute the provided body parameter defined in the variable.

---

### References

[security: runHunting Query](https://learn.microsoft.com/en-us/graph/api/security-security-runhuntingquery?view=graph-rest-1.0&tabs=http)  

[Microsoft.PowerShell Security](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/?view=powershell-7.4)   

[Get-Execution Policy](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-executionpolicy?view=powershell-7.4)  

---

## Q0111:

You are investigating threats using Content search in Microsoft Purview. You are requested to configure search permission filtering to search only a subset of mailboxes and sites in the organization.
You need to connect to the proper modules to be able to run the search.
Which two modules should you connect to? Each correct answer presents part of the solution.

Choose the correct answers

- The Security and Compliance PowerShell module
- The Exchange Online PowerShell module
- The SharePoint Online PowerShell module
- The Microsoft Graph PowerShell module

---

### Answer:

- The Security and Compliance PowerShell module
- The Exchange Online PowerShell module

You should connect to the Exchange Online and the Security and Compliance PowerShell modules. These are Microsoft's defined prerequisites to provide a way for cmdlets to interact with mailbox properties. You can use Exchange Online PowerShell module cmdlets to manage Exchange Online settings and configurations, which is essential for configuring search permission filtering when investigating threats related to email content in Microsoft Purview. You can use Security and Compliance PowerShell module cmdlets to manage security and compliance-related settings in Microsoft 365. It includes cmdlets for managing compliance policies, data loss prevention (DLP) policies, eDiscovery, and other security-related configurations.
You should not connect to the SharePoint Online PowerShell module. You can use this module to manage SharePoint Online configurations and settings using PowerShell commands. While it is useful for managing SharePoint Online sites and content, it is not a requirement defined by Microsoft to configure search permission filtering for investigating threats using Content search in Microsoft Purview.
You should not connect to the Microsoft Graph PowerShell module. This module provides cmdlets to interact with Microsoft Graph, which is Microsoft's unified API endpoint for accessing various Microsoft 365 services and data. While it allows you to manage Microsoft 365 resources programmatically, it is not a requirement defined by Microsoft to configure search permission filtering for investigating threats in
Microsoft Purview unless specific Graph API endpoints are required for the task.

---

### References

[Investigate threats with Content search in Microsoft Purview](https://learn.microsoft.com/en-us/training/modules/investigate-threats-with-content-search-in-microsoft-purview/)    

[Configure search permissions filtering](https://learn.microsoft.com/en-us/training/modules/investigate-threats-with-content-search-in-microsoft-purview/6-configure-search-permissions-filters)  

[Microsoft Entra version 2 cmdlets for group management](https://learn.microsoft.com/en-us/entra/identity/users/groups-settings-v2-cmdlets)  

---

## Q0110:

You have a Microsoft 365 E5 subscription.
You need to investigate a specific alert of impossible travel activity using Unified AuditLog. You create a KQL query to list related logon activities, which are specific to your investigation.
How should you complete the query? To answer, select the appropriate options from the drop-down menus.

Choose the correct options

OPTIONS: project | join | union | select

```
AlertInfo
| where AlertId == "271876ba-e911-4719-8b1a-8555efc7e8cc" 
| [OPTIONS] AlertTime = Timestamp, Title, Severity, AlertId
| [OPTIONS] AlertEvidence on AlertId
| where EntityType == "user"
| [OPTIONS] AccountObjectId, AlertTime
| [OPTIONS] Identity LogonEvents on AccountObjectId
| where Timestamp between ((AlertTime 1h).. (AlertTime +1h))
```

```
AlertInfo
| where AlertId == "271876ba-e911-4719-8b1a-8555efc7e8cc" 
| project AlertTime = Timestamp, Title, Severity, AlertId
| join AlertEvidence on AlertId
| where EntityType == "user"
| project AccountObjectId, AlertTime
| join Identity LogonEvents on AccountObjectId
| where Timestamp between ((AlertTime 1h).. (AlertTime +1h))
```

---

### Answer:

1. AlertInfo
2. where AlertId == "271876ba-e911-4719-8b1a-8555efc7e8cc"
3. project AlertTime = Timestamp, Title, Severity, AlertId
4. join AlertEvidence on AlertId
5. where EntityType == "user"
6. project AccountObjectId, AlertTime
7. join IdentityLogonEvents on AccountObjectId
8. where Timestamp between ((AlertTime 1h) (AlertTime +1h))

In Kusto Query Language (KQL), the join operator is used to combine two or more tables based on a common field or set of fields. It allows you to perform relational operations between tables and retrieve data that satisfies certain join conditions. In this scenario, to gather the required information for the investigation the Alertinfo table and the AlertEvidence table have to be joined (line 4) by content in column Alertld (line 2) to retrieve the needed information about the alert and its respective alert evidence.
In line 5, the result of joined tables is filtered by EntityType user. In line 7, the filtered result is joined with the IdentityLogonEvents table by content of the strong identifier AccountObjectid to find related logon event, which happened one hour before and after the alert time as it is stated in line 8.
In lines 3 and 6, the most relevant columns are selected using the project operator. In KQL, the project operator is used to select and project specific columns or properties from a dataset. It allows you to shape the output of a query by specifying which columns or properties you want to include in the result set. The project operator is a powerful tool for shaping your query results in KQL, allowing you to select specific columns, rename them, perform calculations, and work with nested structures.
The union operator combines the results of two or more tables or queries vertically, meaning it appends rows from one table or query to another. It is used when you want to merge the results of multiple tables or queries that have the same column structure. The union operator does not require a common field between the tables or queries. It simply concatenates the rows from each input. In this scenario, data from multiple tables based on common fields should be combined and related; therefore, the join operator should be used.
select is a SQL statement. It is typically used at the beginning of the query to specify the columns you want
to include. The SQL SELECT statement and the KQL project operator serve similar purposes of selecting
columns, but they have different syntax and are used within the context of their respective query languages.
As the given query is based on KQL language, the select statement is not appropriate in this scenario.

---

### References

Kusto Query Language (KQL) overview

project operator
join operator

[union operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/union-operator?pivots=azuredataexplorer)  

[SQL SELECT Statement](https://www.w3schools.com/sql/sql_select.asp)

[Good UAL Hunting](https://techcommunity.microsoft.com/t5/microsoft-security-experts-blog/good-ual-hunting/ba-p/3718421)  
---

## Q0109:

You have a Microsoft 365 E5 subscription. You suspect DisgruntledAdmin1 is trying to exfiltrate organization's confidential information. You create the below hunting query to identify sharing activities for DisgruntledAdmin1 in your organization's cloud apps:
CloudAppEvents
| where ActivityType == "Share" and IsAdminOperation == true
You need to mark DisgruntledAdmin1 as compromised if sharing activities take place.
Which two actions should you perform? Each correct answer presents part of the solution.

Choose the correct answers

- Add Accountld to query a condition.
- Create a detection rule.
- Create a playbook.
- Create a custom function.
- Set a Defender for Identity entity tag.

---

### Answer:
- Add Accountld to query a condition.
- Create a detection rule.

You should add Accountid to query a condition to specifically target the activities of DisgruntledAdmin1. By including the Accountld in the query condition, you ensure that the query filters out sharing activities performed by other admins and focuses only on the activities of the admin in question. As such the query should be created as follows:
CloudAppEvents | where ActivityType == "Share" and AccountId == "DisgruntledUser1" and IsAdminOperation == true
You should also create a detection rule. This is a crucial step in identifying and flagging suspicious activities. By creating a detection rule, you can automate the process of monitoring and identifying sharing activities by the specific admin, DisgruntledAdmin1. Once the detection rule is triggered, you can take appropriate actions to mark the admin as compromised.
You should not create a custom function. The query provided in the question is already using the necessary built-in functions and operators to identify sharing activities by an admin.
You should not create a playbook. Playbooks are typically used to automate responses or remediation actions once an alert or detection is triggered. Although it can be useful to have a playbook in place to respond to potential threats, the scenario does not specify the requirement of creating a playbook.
You should not set a Defender for Identity entity tag. Defender for Identity is a security feature that helps to detect identity-related, not content-related, attacks. Defender for Identity entity tags enable organizations to apply additional context, prioritize monitoring, and enhance the detection and response capabilities to better protect against identity-related attacks. In this scenario, identity is not compromised, but there is an attempt to exfiltrate content. As such, entity tags are not directly related to marking a user as compromised in this scenario.

---

### References

[Create and manage custom detections rules](https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules)   

[Use custom functions.](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-custom-functions)  

[Incident response playbooks](https://learn.microsoft.com/en-us/security/operations/incident-response-playbooks)  

[Defender for Identity entity tags in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-for-identity/entity-tags?toc=%2Fmicrosoft-365%2Fsecurity%2Fdefender%2Ftoc.json&bc=%2Fmicrosoft-365%2Fsecurity%2Fdefender%2Fbreadcrumb%2Ftoc.json)  

[Good UAL Hunting](https://techcommunity.microsoft.com/t5/microsoft-security-experts-blog/good-ual-hunting/ba-p/3718421)  

---

## Q0108

You are a security analyst in your company. You suspect that some users have created inbox rules that automatically forward or redirect incoming emails to external recipients or email addresses. Attackers can exploit this feature to secretly divert sensitive or confidential information outside the organization without detection.
You need to verify your suspicion in the most effective way by querying the unified audit log.

Which parameter should you use to complete the query? 
To answer, select the appropriate option from the drop-down menu.

Choose the correct options

OPTIONS: -Operations | -FreeText  | -RecordType


`Search-Unified AuditLog -StartDate 2023-04-01 -EndDate 2023-04-15 [OPTIONS] New-InboxRule`

`Search-Unified AuditLog -StartDate 2023-04-01 -EndDate 2023-04-15 -Operations New-InboxRule`

---

### Answer:
`Search-Unified AuditLog -StartDate 2023-04-01 -EndDate 2023-04-15 -Operations New-InboxRule`

You should use the Operations parameter and complete the query as follows:

`Search-UnifiedAuditLog -StartDate 2023-04-01 -EndDate 2023-04-15 -Operations New-InboxRule`

The -Operations parameter is used to filter the audit log entries based on specific operations or activities. In this scenario, by using New-InboxRule as the value, the query will only retrieve entries where the operation performed is the creation of a new inbox rule. This helps to focus the search on the specific activity of
interest.
You should not use the -RecordType parameter. This parameter is used to filter the audit log entries based on the type of records. However, there is no specific record type called New-InboxRule. Therefore, this option is not correct for querying the unified audit log to verify inbox rule creation.

You should not use the -FreeText parameter. This parameter is used to perform a text-based search within the audit log entries. By specifying New-InboxRule as the value, the query will perform a general text search across the entire log entry trying to find any occurrences of the text "New-InboxRule". However, this may not be the most efficient way to search for inbox rule creation events. It may retrieve false positives or miss relevant entries if the term "New-InboxRule" appears in other contexts within the log, such as descriptions, comments, or unrelated fields.
It is worth noting that the unified audit log consolidates log data from various products into a single repository. Due to the vast amount of data in this log, it is necessary to categorize and filter it for effective analysis. The log data within the Unified Audit Log is organized into three main categories: workloads, record types, and operations. By utilizing these categories as filters during searches, it becomes easier to navigate and prioritize the extensive dataset in the unified audit log.

- Workloads: The initial categorization of data based on different products or services, such as AzureActiveDirectory, Exchange, or OneDrive.

- Record types: The process of organizing operations within a product into logical groups based on specific categories. Examples are ExchangeAdmin, SharePointFileOperation, Microsoft Teams, etc.

- Operations: The specific occurrence or event that took place, for instance New-InboxRule, MailltemsAccessed, FileDownloaded, or UserLoggedIn.

---

### References

[Good UAL Hunting](https://techcommunity.microsoft.com/t5/microsoft-security-experts-blog/good-ual-hunting/ba-p/3718421)  

[Search the audit log](https://learn.microsoft.com/en-us/purview/audit-search?tabs=microsoft-purview-portal)  

[Audit log activities](https://learn.microsoft.com/en-us/purview/audit-log-activities)  

---

## Q0107:

You investigate a medium severity alert triggered by the execution of a suspicious program file on a user's device. You are requested to analyze the behavior of the program file when it runs by using the Deep
analysis feature of Microsoft Defender for Endpoint.
You need to identify which file types the Deep analysis feature currently supports for extensive analysis.

What two options should you identify? Each correct answer presents a complete solution.

Choose the correct answers

- msi
- .com
- dll
- .exe

---

### Answer:
- dll
- .exe


The .exe and .dll files are the only ones supported. The Deep analysis feature provides extensive analysis of files' behavior when executed by running them within a protected cloud environment equipped with comprehensive instrumentation. It offers insights into the file's actions, detected behaviors, and related elements, including created files, changes to the registry, and interactions with specific IP addresses.
The .msi and.com files are not supported by the Deep analysis feature. If these types of files have to be analyzed, they can be executed for behavioral analysis in a secure sandbox environment or within a virtual machine isolated from the production network and systems. These environments are specifically designed to contain any potential threats and prevent them from causing harm to the actual infrastructure.
Microsoft Installer .msi files are commonly used for installing software on Windows systems. On the other hand, com files are executable program files in the Component Object Model (COM) format on Windows systems.

---

### References

[Investigate a file](https://learn.microsoft.com/en-us/training/modules/perform-evidence-entities-investigations-microsoft-defender-for-endpoint/2-investigate-file)  

[Perform evidence and entities investigations using Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/training/modules/perform-evidence-entities-investigations-microsoft-defender-for-endpoint/)  

---

## Q0106:

Your company uses Microsoft Defender for Endpoint.
While you are checking the Microsoft Defender incidents dashboard, you receive an incident that a malicious file was blocked from running on a user's machine. You want to ensure that there is no remnants of the file in the user's profile on the machine.
You need to access the user's device remotely.

What action should you initiate?

Choose the correct answer

- Automated Investigation
- Microsoft Defender Antivirus scan
- Live response session
- App execution restriction

---

### Answer:
- Live response session

You should initiate a live response session. A live response session allows you to remotely access and interact with the user's device in real-time. This enables you to investigate and take immediate action, such as searching for and removing any remnants of the blocked malicious file from the user's profile on the machine. Through the live response session, you can perform various tasks to address security incidents and ensure the integrity of the device.
You should not initiate an Automated Investigation. Automated investigations are useful for analyzing security incidents and potentially malicious activities across multiple endpoints or devices. However, in this scenario, you specifically need to access the user's device for a detailed inspection.
You should not initiate a Microsoft Defender Antivirus scan. This option involves running a scan using Microsoft Defender Antivirus on the user's device to detect and remove any malicious files or remnants. While running an antivirus scan is a standard practice for detecting malware, it may not provide real-time access to the device for immediate investigation and remediation of the incident described.
You should not initiate App execution restriction. This involves restricting the execution of certain. applications on the device to prevent potential security risks. While this measure can enhance security by limiting the execution of unauthorized or potentially harmful applications, it does not directly address the need to access the device remotely for investigation and remediation purposes.

---

### References

[Investigate entities on devices using live response](https://learn.microsoft.com/en-us/defender-endpoint/live-response)  

[Take response actions on a device](https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts)  

---

## Q0105:

You have an Azure subscription with Microsoft Sentinel activated and the UEBA feature enabled. You are requested to recommend a solution to present a timeline view that displays the entity's activities over a specific period to trace the sequence of events and identify potential attack vectors, indicators of compromise (loC), or patterns that indicate a coordinated attack.
What solution should you recommend? The solution must minimize the administrative effort.

Choose the correct answer
- Analytics
- Entity pages
- Workbooks
- Playbooks

---

### Answer:
- Entity pages

You should recommend entity pages within Microsoft Sentinel. Entity pages in Microsoft Sentinel provide a consolidated view of information and activities related to a specific entity, such as a user, host, or application. They offer a quick and comprehensive overview of an entity's behavior and can help to trace the sequence of events, identify potential attack vectors, indicators of compromise (loC), or patterns indicating a coordinated attack. By accessing the entity page of the specific entity under investigation, you can quickly navigate through the timeline view, which presents a chronological representation of the entity's activities over a specific period. This allows you to efficiently trace the sequence of events and identify any suspicious or malicious activities.
Although workbooks, playbooks, and analytics are valuable components of Microsoft Sentinel, they may
require additional configuration, customization, or data analysis, which could increase the time spent on investigation. In this specific scenario, the administrative effort should be minimized so entity pages offer a focused and streamlined approach to accessing and analyzing the timeline view of entity activities.
Workbooks in Microsoft Sentinel are customizable and interactive dashboards that allow users to visualize and analyze data from various sources, including logs, alerts, and external threat intelligence. They are designed to provide insights, facilitate investigations, and enable data exploration within the Microsoft Sentinel environment.
Playbooks in Microsoft Sentinel are automated workflows that help streamline and orchestrate security incident response processes. They enable users to define and execute a series of predefined actions and responses based on specific triggers or conditions. Playbooks automate repetitive tasks, accelerate incident response, and ensure consistent and efficient handling of security incidents.
• Analytics in the context of Microsoft Sentinel refers to the use of machine learning, statistical models, and data analysis techniques to detect and identify security threats, anomalies, and patterns within the collected security data. Microsoft Sentinel leverages advanced analytics capabilities to provide automated and intelligent security monitoring

---

### References

[Entity pages in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/entity-pages?tabs=azure-portal)  

[Use a Microsoft Sentinel playbook to stop potentially compromised users](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)

[Threat detection in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/threat-detection)     

---

## Q0104:

You have an Azure subscription with Microsoft Sentinel activated and the UEBA feature enabled.
After defining a single custom activity, all out-of-the-box activities on timeline in your entity pages have disappeared.
You need to fix the issue.

What should you do?

Choose the correct answer

- Modify the UEBA feature settings in Microsoft Sentinel.
- Create an activity for each out-of-the-box template.
- Disable the UEBA feature in Microsoft Sentinel.
- Recreate Microsoft Sentinel resource to restore the out-of-the-box activities.

---

### Answer:

- Create an activity for each out-of-the-box template.
You should create an activity for each out-of-the-box (OOTB) template. After defining a single custom activity, your entity pages will exclusively display activities listed on the My activities tab. To ensure the visibility of OOTB activities on your entity pages, it is necessary to create an activity for each template you want to track and display.
You should not disable the User and Entity Behavior Analytics (UEBA) feature in Microsoft Sentinel. UEBA is a cybersecurity technology that focuses on monitoring and analyzing the behavior of users and entities (such as devices, applications, or systems) within an organization's network or digital environment. UEBA combines machine learning, statistical analysis, and algorithms to detect patterns, anomalies, and potential security threats. By disabling this feature, all behavior analytics and associated activities, including both custom and OOTB activities, will be turned off. This option may not be desirable if you still want to leverage the UEBA capabilities provided by Microsoft Sentinel.
You should not modify the UEBA feature settings in Microsoft Sentinel. The UEBA feature settings primarily focus on configuring the synchronization between Microsoft Sentinel and directory services, selecting the currently available data sources, and activating them for entity behavior analytics. It does not specifically. control the visibility of OOTB activities on the entity pages.
You should not recreate Microsoft Sentinel resource to restore the out-of-the-box activities. Recreating Microsoft Sentinel resource is an extreme measure and is not necessary for addressing the issue in this scenario. It is more efficient to explore other troubleshooting steps, consult documentation or seek assistance from Azure Support before considering a complete recreation.

---

### References

[Customize activities on entity page timelines](https://learn.microsoft.com/en-us/azure/sentinel/customize-entity-activities?tabs=azure)  

[What is Microsoft Sentinel?](https://learn.microsoft.com/en-us/azure/sentinel/overview?tabs=azure-portal)  

[Advanced threat detection with User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior-analytics)  

---

## Q0103:

You administer Microsoft Defender XDR in your organization. You want to encourage your employees to submit suspicious emails and email attachments for further investigation. To minimize implementation costs, you decide to utilize the built-in functionality of an email client.
You need to recommend a solution for your users, while minimizing your efforts.

What should you recommend?

Choose the correct answer

- Users should use Outlook add-ins.
- Users should use Outlook on the web.
- Users should use the Outlook desktop app.
- Users should use Microsoft Mail and Calendar.

---

### Answer:
- Users should use Outlook on the web.

You should recommend your users to use Outlook on the web. The built-in Report button for suspicious emails and attachments is readily accessible in the web-based version of Outlook only. By using Outlook on the web, your employees can easily submit any suspicious content for further investigation.
You should not recommend your users to use the Outlook desktop app. At the time of writing, the built-in Report button is available in Outlook on the web only. To provide such a button in the Outlook desktop app,
you would need to install add-ins. Add-ins are not a part of Outlook built-in functionality.
You should not recommend your users to use Microsoft Mail and Calendar. This app is primarily used for managing emails and calendars, but it lacks the specific built-in Report button for suspicious content. It does not offer the same security features as Outlook or Outlook on the web.
You should not recommend your users to use Outlook add-ins. These add-ins are available for Outlook, but they are not part of the built-in functionality. Users would need to install and enable these add-ins separately, which may not be the most straightforward solution for employees. Add-in implementation is associated with costs and efforts, which have to be minimized.

---

### References

[How do I report a suspicious email or file to Microsoft?](https://learn.microsoft.com/en-us/defender-office-365/submissions-report-messages-files-to-microsoft)   

[Report phishing and suspicious emails in Outlook for admins](https://learn.microsoft.com/en-us/defender-office-365/submissions-outlook-report-messages)  

[Enable the Microsoft Report Message or the Report Phishing add-ins](https://learn.microsoft.com/en-us/defender-office-365/submissions-users-report-message-add-in-configure)  

---

## Q0102:


You use Microsoft Defender for Cloud Apps in your organization. You suspect that some of the employees use unsanctioned cloud apps, generating a security risk.
You need to identify and flag the unsanctioned cloud apps in the most efficient way possible.

What should you do?

Choose the correct answer

- Review app permissions in the Azure portal.
- Conduct manual audits of app usage.
- Monitor user activity on sanctioned apps.
- Analyze network traffic logs.  

---

### Answer:
- Analyze network traffic logs.  

You should analyze network traffic logs. Microsoft Defender for Cloud Apps monitors network traffic logs and predefined risk indicators. It analyzes patterns of app usage, access requests, and behavior to identify unsanctioned apps. This method is proactive and automated, allowing the system to flag potential risks without manual intervention. It is the most effective for identifying unsanctioned cloud apps, as it combines automation with real-time risk assessment
You should not monitor user activity on sanctioned apps. Unsanctioned apps cannot be identified by
monitoring user activity on sanctioned apps. While monitoring this activity is essential for overall security, it specifically focuses on approved apps. It does not directly identify unsanctioned apps. Monitoring user behavior helps ensure compliance and adherence to policies but does not target unsanctioned apps.
You should not review app permissions in the Azure portal. Reviewing app permissions involves examining the access rights granted to specific apps within the Azure portal. However, this approach assumes that you already know which apps to review. It is a manual process and may not directly identify previously unknown unsanctioned apps.
You should not conduct manual audits of app usage. Manual audits involve systematically checking app usage across the organization. While this method can uncover unsanctioned apps, it is time-consuming and resource-intensive. Manual audits are reactive and require human effort.

---

### References

[Microsoft Defender for Cloud Apps overview](https://learn.microsoft.com/en-us/defender-cloud-apps/what-is-defender-for-cloud-apps)  

[Find your cloud app and calculate risk scores](https://learn.microsoft.com/en-us/defender-cloud-apps/risk-score)  

---

## Q0101:

You use the Microsoft Purview insider risk management solution in your organization. You receive a notification about atypical actions on your data. You decide to thoroughly investigate and take action on the issue generated by the risk indicator defined in your policy.
You need to create an insider risk management case for the investigation.
What should you use as a starting point?

Choose the correct answer

- Incident
- Anomaly
- Alert
- Event

---

### Answer:
- Alert

You should use an alert. An alert serves as an early warning system, triggered by specific events or conditions. It indicates potential security issues. Alerts prompt further investigation. When predefined conditions, such as unusual login activity, data access patterns, or any other atypical (meaning not normal or anomalous) action, are met, an alert is generated. Alerts act as starting points for creating insider risk management cases.
Incidents represent security-related events or occurrences that require a response. When a security incident occurs, such as a detected breach or unauthorized access attempt, it may trigger an alert to notify security personnel or an incident response team. Incidents are typically the result of one or more security events that have been analyzed and confirmed to pose a threat or risk to the organization.
Security events, such as login attempts, firewall logs, or antivirus detections, can generate alerts when they meet predefined criteria indicating suspicious or malicious activity. Events are typically raw data points collected from various sources within an organization's IT environment, and alerts are generated based on rules or algorithms applied to analyze these events in real-time or near-real-time.
Anomalies refer to deviations from normal patterns or behaviors within IT systems or networks. Anomaly detection techniques can identify unusual or unexpected activities, such as a spike in network traffic, unusual user behavior, or changes in system configuration. When an anomaly is detected and meets certain criteria indicating a potential security risk or operational issue, it may trigger an alert for further investigation.
In Microsoft insider risk management, incidents, events, and anomalies collectively generate alerts, which can be analyzed using an insider risk management investigation case. Therefore, according to the design of Microsoft insider risk management, the starting point for creating a case is an alert.

---

### References

[Take action on insider risk management cases](https://learn.microsoft.com/en-us/purview/insider-risk-management-cases?tabs=purview-portal)  

[Investigate insider risk management activities](https://learn.microsoft.com/en-us/purview/insider-risk-management-activities?tabs=purview-portal)  

[Learn about insider risk management](https://learn.microsoft.com/en-us/purview/insider-risk-management)  

---

## Q0100:

You are using Microsoft Defender for Endpoint APIs to assist in vulnerability management.
You need to use an API call to get a list of devices connected to a particular vulnerability ID.
Which HTTP GET request will be sent for the method associated with this API call?

Choose the correct answer

- GET /api/vulnerabilities/{cveld)
- GET /api/vulnerabilities
- GET /api/vulnerabilities/{cveId}/machineReferences
- GET vulnerabilities/machinesVulnerabilities

---

### Answer:
- GET /api/vulnerabilities/{cveId}/machineReferences

The GET /api/vulnerabilities/(cveld)/machineReferences will be sent for the method associated with the API call. The specific method referenced in the scenario would be the List devices by vulnerability method. This is used in order to get a list of devices associated with a specific vulnerability ID. This ID would be the string in the (cvelD) portion of the request. Knowing the correct HTTP request for the method helps to ensure during testing that the correct vulnerability list will be delivered.
The GET /api/vulnerabilities will not be sent for the method associated with the API call. This request gets a full list of the vulnerabilities across the organization. You are looking for both a list of devices and a specific vulnerability ID. As such, this request is too broad.
The GET /api/vulnerabilities/{cveld) will not be sent for the method associated with the API call. This request
gets vulnerability information by CVE/vulnerability ID, but it is not scoped to devices or a single CVE/
vulnerability ID, as requested in the scenario.
The GET /api/vulnerabilities/machines Vulnerabilities will not be sent for the method associated with the API call. This request gets a list of all vulnerabilities across the whole organization by machine and software, therefore, it is not scoped to a specific CVE/vulnerability ID.

---

### References

[Access the Microsoft Defender for Endpoint APIs](https://learn.microsoft.com/en-us/defender-endpoint/api/apis-intro?view=o365-worldwide)  

[Vulnerability resource type](https://learn.microsoft.com/en-us/defender-endpoint/api/vulnerability?view=o365-worldwide)  

[List vulnerabilities by machine and software](https://pts.measureup.com/web/PBS/LMS/index.php?l=1&k=8674395&tam=2426582&role=1&course=at_test202212230605081671775508)   

[List vulnerabilities](https://learn.microsoft.com/en-us/defender-endpoint/api/get-all-vulnerabilities)    

[Get vulnerability by ID](https://learn.microsoft.com/en-us/defender-endpoint/api/get-vulnerability-by-id)   

[List devices by vulnerability](https://learn.microsoft.com/en-us/defender-endpoint/api/get-machines-by-vulnerability)  


---

## Q099:

You have Microsoft Defender for Cloud assigned to an Azure subscription.
You are triaging and investigating security alerts.
You need to focus on details of a specific Malware attack operation.
Which Defender for Cloud threat intelligence report should you look at?

Choose the correct answer

- Automated Investigation and Response (AIR) report
- Activity Group report
- Threat Summary report
- Campaign report

---

### Answer:
- Campaign report

You should look at the Campaign report. The Campaign report focuses on details of specific attack operations.
You should not use the Activity Group report. The Activity Group report focuses on details of the attackers, their objectives, and tactics.
You should not use the Threat Summary report. The Threat Summary report provides a holistic overview of the items in the activity group report and campaign report. Although the information related to a specific campaign can be retrieved from the summary report, you should use the Campaign report if you want to focus on specific details of attack campaigns.
You should not use the Automated Investigation and Response (AIR) report. The AIR report provides automated investigation using specific underlying algorithms. It is only available in Microsoft Defender XDR, Microsoft Defender for Endpoint Plan 2 and Microsoft Defender for Business. It is not available in the Defender for Cloud threat intelligence report.

---

### References

[Microsoft Defender for Cloud threat intelligence report](https://learn.microsoft.com/en-us/azure/defender-for-cloud/threat-intelligence-reports)  

[Alert validation in Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alert-validation)  

[Overview of automated investigations](https://learn.microsoft.com/en-us/defender-endpoint/automated-investigations?view=o365-worldwide)  

---

## Q098:

Your company starts buying products online from a vendor outside your country. False-positive alerts are showing up constantly due to the accounting team accessing the vendor's website. Microsoft Defender for Cloud considers the IP address of the vendor as suspicious.
You want to hide the false-positive alerts produced due to accessing the vendor's website.

Which two actions should you perform after selecting the false-positive alert on the Security Alerts page? 

Each correct answer presents part of the solution.

Choose the correct answers

- Enter the details of the new suppression rule.
- Select the Create suppression rule option.
- Access the Trigger automated response section.
- Access the Prevent Future Attacks section.
- Access the Mitigate the threat section.

---

### Answer:

- Enter the details of the new suppression rule.
- Select the Create suppression rule option.

You should select the Create suppression rule option. Suppression rules are used to automatically dismiss alerts by predefined conditions. After selecting the false-positive alert (incorrect alert logic), you can create an auto-dismiss rule on the Take action window that will hide the alert showing for the accounting team. In order to do that, you have to first select the Create suppression rule option.
You should then enter the details of the new suppression rule. After executing the previous action, which creates the suppression rule, you should enter the details of the rule such as the name, description, state (enabled or disabled), and the reason for creating the suppression rule. This action is required because if you create the suppression rule but do not add the details, the rule will not work.
You should not access the Trigger automated response section. This action, which is done on the Take action window, allows you to set a trigger for an automated response to the alert. For example, automatic remediation actions after a user uploads sensitive data to an unauthorized cloud service. This action does not allow you to hide false-positive alerts.
You should not access the Mitigate the threat section. Mitigation offers instructions for manually addressing the security alert, such as taking immediate action to block or neutralize the threat to prevent further damage.
You should not access the Prevent Future Attacks section. This action, which is done on the Take action window, allows you to view the recommendations from Azure to protect your company against future attacks like the ones that caused the alert. This action does not allow you to hide false-positive alerts.

---

### References

[Suppress alerts from Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules)  

[Automate threat response in Microsoft Sentinel with automation rules](https://learn.microsoft.com/en-us/azure/sentinel/automate-incident-handling-with-automation-rules?tabs=onboarded)  

[Security alerts and incidents](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-overview) 

---

## Q097:

Your manager deploys a Linux-based Azure virtual machine (VM) in an Azure subscription. They want to verify the functionality of alerts in Microsoft Defender for Cloud.
You need to simulate alerts on the manager's device.
Which three actions should you perform? Each correct answer presents part of the solution.

Choose the correct answers

- Rename executable to ASC_AlertTest_662jfi039n.exe
- Copy an executable to the computer's desktop.
- Execute the file in the Command Prompt.
- Create a data loss prevention (DLP) policy.
- Create an Event Connector.
- Use Data Retention.

---

### Answer:

- Rename executable to ASC_AlertTest_662jfi039n.exe
- Copy an executable to the computer's desktop.
- Execute the file in the Command Prompt.

You should copy an executable to the computer's desktop.
Then, you should rename it to ASC_AlertTest_662jfi039n.exe. This name is a Microsoft reserved name for attack simulations on Virtual Machines (VMs) protected using Microsoft Defender for Cloud.
You should then execute the file in the Command Prompt with a fake argument name (example -foo). Executing the renamed file using the Command Prompt will trigger Microsoft Defender for Cloud, and an alert about a suspicious activity will be sent to the manager. Since the manager knows that the executed file is for test only, they will know that Microsoft Defender for Cloud is working correctly.
You should not create a data loss prevention (DLP) policy. You would use a DLP policy if you wanted to ban the accidental sharing of sensitive information with people outside the organization. DLP can display a pop- up tip to employees to warn them about possible attempts to share sensitive data with people outside the organization, but it cannot be used to simulate alerts.
You should not use Data Retention. Data Retention is a tool that is found in the Azure portal which allows you to adjust the log retention days. This solution is applied by accessing the Data Retention window on the Usage and estimated costs page. There, an adjustable blade for retention days will be displayed. This action does not allow you to simulate alerts.
You should not create an Event Connector. Event connectors are a part of Windows Security and they are used to stream security events from any Windows server linked with your Microsoft Sentinel workspace. Microsoft Sentinel is a Security Information Event Management (SIEM) system that provides security analytics for companies.

---

### References

[Alert validation in Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alert-validation)  

[Get started with the data loss prevention alerts](https://learn.microsoft.com/en-us/purview/dlp-alerts-get-started)    

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference?tabs=LAA)  

[Data retention, deletion, and destruction in Microsoft 365](https://learn.microsoft.com/en-us/compliance/assurance/assurance-data-retention-deletion-and-destruction-overview)  


---

## Q096:

You are using threat reports in Microsoft Defender for Cloud to review important information about the risks your company is facing in the current threat landscape.
You want to view a report that looks at tactics, techniques, and procedures of attackers, since you suspect you are being targeted by an Advanced Persistent Threat (APT).
You need to pull a report that only focuses on the behaviors of this APT.
What report type should you pull to gather this information?

Choose the correct answer

- Activity Group Report
- Campaign Report
- Threat Summary Report
- Threat Intelligence Report

---

### Answer:

You should pull an Activity Group Report. This is a report that focuses on a group's Tactics, Techniques, and Procedures (TTPs), which are the objectives and tactics an attack, or attack group, uses. In a way, you can think of TTPs as a signature. Often, attacks are identified as being perpetrated by a specific group when the TTPs match that group's past behavior. The key here is that you want a narrow report that is specific to this attack group.
You should not pull a Campaign Report. Again this is a report focusing on individual attack campaigns. This might be a great report to pull if you suspect you had been hit by a specific attack, but if you think a group is targeting you, the Activity Group Report is a better choice.
You should not pull a Threat Summary Report. While this contains info from both the Activity Group Report and the Campaign Report, you specifically need to pull the report focusing on the group level and TTPs. This report is broader than what is required.
You should not pull a Threat Intelligence Report. This is a report accessed by investigating individual alerts and clicking the link to the report in the Alert details pane. This is the only report on the list that focuses on individual threats and not campaigns or attack groups.

---

### References

[Microsoft Defender for Cloud threat intelligence report](https://learn.microsoft.com/en-us/azure/defender-for-cloud/threat-intelligence-reports)  

---

## Q095:

You work for a company that assesses its cloud security posture by monitoring data and reports in Microsoft Defender for Cloud.
You need to access a specific threat intelligence report in Microsoft Defender for Cloud.
Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions
From the Microsoft Defender for Cloud sidebar, open the Overview page.
From the Alert details page, select the Next: Take Action button.

Actions in order

1. From the Microsoft Defender for Cloud sidebar, open the Security alerts page.
2. Select an alert.
3. From the Alert details page, select the link to the report.

---

### Answer:

1. From the Microsoft Defender for Cloud sidebar, open the Security alerts page.
2. Select an alert.
3. From the Alert details page, select the link to the report.

First, you should open the Security alerts page from the Microsoft Defender for Cloud sidebar. It is important to understand that this report is a threat summary of an individual threat. Once you know that, it makes sense that the process begins by going to an alert.
Next, you should select the alert that you would like a threat report on. After doing this, you will see a link under Alert details that has a heading of Enrichment_tas_threat_reports.
Finally, from the Alert details page, you should select the link to the alert's report. This link takes you to a PDF of the report, and you will also be able to download the PDF.
You should not open the Overview page from the Microsoft Defender for Cloud sidebar. While the overview page has a number of interesting and helpful graphs and charts, including your Secure Score, it is not the path to your threat intelligence reports. These reports focus on individual threats, and as such, you can find them by starting in the Security alerts page.
You should not select the Next: Take Action button from the Alert details page. This option on the Alert details page will allow you to take steps towards remediating the alert. If you simply want to view the report, no action is needed. You should just click on the link and view the PDF.

---

### References

[Microsoft Defender for Cloud threat intelligence report](https://learn.microsoft.com/en-us/azure/defender-for-cloud/threat-intelligence-reports)  

---

## Q094:

You are using Microsoft Defender for Cloud to protect and monitor your cloud environment. You are investigating alerts.
You need to filter out the lowest severity alerts so that you can focus on alerts that are more likely to be malicious.
Which severity alert should you filter out to generate this view?

Choose the correct answer

- Informational
- Low
- High
- Medium

---

### Answer:
- Informational

You should filter out the Informational severity alerts. There are four levels of alerts: High, Medium, Low, and Informational. While the trio of High, Medium, and Low identify the majority of potentially malicious activity, the Informational level provides the context of activity when correlated with other events. This will filter out the alerts with the lowest identified severity.
You should not select High. This is the top severity alert, and as such it should remain in your search. If an alert of this severity has been generated, it is very likely that a resource is currently being attacked, or that it has been compromised.
You should not select Medium. This is the second highest of the severity alerts. It represents the presence of probable malicious or unwanted behavior.

You should not select Low. Despite the name, Low alerts are only the second-lowest severity level. They are one level of severity above Informational alerts. Low alerts are typically not malicious, but they are actions that are important enough that they should be worrisome if they are unexpected. For example, a Low alert might be a regular, everyday admin task. However, if the task was not initiated by the specified admin, a low alert could be a cause of concern.

---

### References

[Security alerts and incidents](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-overview)  

[Security alerts - a reference guide](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-reference)  


---

## Q093:

You are using Microsoft Defender for Cloud.
Several alerts have been triggering too often for them to be useful. You are an Owner at the subscription level.
You need to assign roles to your teammates so that they can create and read suppression rules that will address this issue.
Which two roles could you assign to your teammates to meet these requirements? Each correct answer presents a complete solution.

Choose the correct answers

- Security Reader
- Reader
- Owner
- Security Admin
- Microsoft Sentinel Contributor

---

### Answer:

- Owner
- Security Admin

You should assign your teammates the Security Admin or Owner roles. The Security Admin role is primarily used to view and update permissions for Microsoft Defender for Cloud. This role ultimately has the same permissions as the Security Reader role, but on top of that they can also update security policy and manage alerts. This includes the creation of suppression rules. The Owner role is essentially all-powerful as it grants access to manage all resources in the subscription. This, of course, includes the creation of suppression rules. Another way to look at it is that the Owner role has all of the permissions of the Security Reader and Security Admin built-in.
You should not assign your teammates the Microsoft Sentinel Contributor role. This role is scoped to the Microsoft Sentinel solution within the subscription, and while you may set up alerts in Sentinel, the scenario is referencing suppression rules for Microsoft Defender for Cloud alerts specifically.
You should not assign your teammates the Reader role. While this role grants the ability to read/view the suppression rules, it does not grant permission to create the rules. It would be redundant to grant a user both Security Admin and Reader rights. The Security Admin role has all required reading of suppression rules built-in.
You should not assign your teammates the Security Reader role. As above, this role grants the ability to read/view the suppression rules, but not to create the rules.

---

### References

[Suppress alerts from Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules)  

Azure built-in roles

---

## Q092:

You are currently using Microsoft Defender for Cloud to protect and monitor your critical cloud workloads. You configure Microsoft Defender for Cloud alert notifications.
Upon initial implementation, you left the recipients portion of the notification settings at the default configuration, but under Notification types you set up notifications for all alerts regardless of severity. The recipients of these alerts have stated that they no longer feel the need to receive low-severity alerts. Also, in addition to the users that are currently receiving the alerts, you have been asked to add two other recipients. Both of these new recipients have been assigned the Contributor role. All existing recipients should continue receiving alerts.
You need to make the required changes to the Email notifications page.
What two actions should you take? Each correct answer presents part of the solution.

Choose the correct answers.

- Type the new recipients' email addresses into the Additional email addresses (separated by commas) field.

- Set the Notify about alerts with the following severity (or higher) drop-down to Medium.

- Set the Notify about alerts with the following severity (or higher) drop-down to High.

- Select the Contributor role from the All users with the following roles drop-down.


---

### Answer:

- Type the new recipients' email addresses into the Additional email addresses (separated by commas) field.

- Set the Notify about alerts with the following severity (or higher) drop-down to Medium.

You should set the Notify about alerts with the following severity (or higher) drop-down to Medium and type the new recipients' email addresses into the Additional email addresses (separated by commas) field. As the recipients only mentioned a desire to stop receiving low-severity alerts, you would need to allow medium and high alert notifications through. By setting this drop-down to Medium, you allow recipients to continue receiving only high and medium level alerts.
The second portion of the answer requires some knowledge of the default settings for email notifications. The All users with the following roles option for notifications defaults to Owner. As such, all Owners in the related subscription would currently be receiving alerts, and should continue to. Since you do not want to change this, and you only want to add some new non-Owner recipients, you simply need to type the new recipients' email addresses into the Additional email addresses (separated by commas) field in order to fulfill the requirement.
You should not set the Notify about alerts with the following severity (or higher) drop-down to High. Since the users only mentioned not receiving low severity alerts, selecting Medium from the drop-down is the right choice. Recipients will receive high alerts as often as once every six hours, and medium alerts as often as once every 12 hours. Low alerts are only emailed once every 24 hours.
You should not select the Contributor role from the All users with the following roles drop-down. Although both new recipients are assigned the Contributor role, selecting this would have two undesired consequences. First, it would no longer be sending alert emails to the Owner role. Second, it would be sending alert emails to all users in the Contributor role in the subscription, not just the two that you are supposed to be adding.

---

### References

[Quickstart: Configure email notifications for security alerts](https://learn.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications)  

---

## Q091:

You work for a company that uses Microsoft Defender XDR and automated investigations. In response to a recent automated investigation, you quarantined a file that you believed to be malicious. This file was found and quarantined on 12 devices. You have since completed further research on the file, and you now know that it is not malicious.
You need to remove this file from quarantine and return it to the devices where it had previously been discovered.

Which three actions should you perform in sequence? 
To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions

Select the Pending tab, then select the file.
Select Apply to 12 more instances of this file, then click Undo.
Go to the Microsoft Endpoint Manager admin center.

Actions in order

1. Navigate to the Action Center.
2. Select the History tab, then select the file.
3. Select Apply to 11 more instances of this file, then click Undo.

---

### Answer:

You should carry out the following actions in order to meet the requirements:
1. Navigate to the Action Center.
2. Select the History tab, then select the file.
3. Select Apply to 11 more instances of this file, then click Undo.

First, you should navigate to the Action Center to complete this task. The Action Center allows you to track down incident and alert tasks in one place. As such, Action Center will often be your first stop when dealing with Microsoft Defender XDR findings.
Next, you should select the History tab. You can use the History tab to select a file that you have previously taken action on. In this scenario, you should make sure that the file you select has the Quarantine file Action type, which it will if it is a file that you quarantined in the past.

Finally, you should select Apply to 11 more instances of this file, then click Undo. Since you are applying this action to more than one file, you should select the Apply to X more instances of this file, where X is the number of additional instances to which you want to apply the action. In this case, in addition to the file selected, you need to apply it to 11 more for a total of 12.
You should not go to the Microsoft Endpoint Manager admin center. This is the location where InTune, Microsoft's Mobile Device Management (MDM) solution, can be configured. So while Microsoft Defender XDR is ultimately an endpoint detection and response (EDR) solution, the Endpoint Manager admin center is focused on MDM configuration, not EDR configuration.
You should not select the Pending tab, then select the file. If this was a pending action, then you would not be in the process of trying to undo the operation. The pending tab, as the name implies, is where you would go to view and make decisions on pending actions.
You should not select Apply to 12 more instances of this file, then click Undo. Remember that you will be selecting an instance of the file and then applying to all other instances. If the file was found on 12 systems, this option would read Apply to 11 more instances of this file. It is very important to make sure that you understand all of the systems impacted any time you are taking action, or in this case, undoing action, on a file.

---

### References

[View and manage actions in the Action center](https://learn.microsoft.com/en-us/defender-xdr/m365d-autoir-actions?view=o365-worldwide)  

---

## Q090:


You are using the Microsoft Defender portal to conduct an investigation into a multi-stage incident. This incident involved a risky user sign-in that was blocked because Multi Factor Authentication (MFA) was not completed, although the credentials provided were correct. You contacted the affected user by telephone and discovered that this sign-in attempt was not made by the user in question. The user is tech savvy and so they managed to complete the self-service password reset (SSPR) process while on the phone with you. You confirm the user's password has been updated.
You need to take appropriate action to close the initial malicious risk detection as a result of this incident.
Which manual risk detection resolution should you select in order to categorize the risk detection correctly?

Choose the correct answer

- Select Confirm compromised (on a sign-in).
- Select Confirm compromised.
- Select Dismiss user risk.
- Select Confirm safe (on a sign-in).

---

### Answer:
- Select Dismiss user risk.


You should select Dismiss user risk. While the sign-in risk detection was accurate, the completion of the self-service password reset (SSPR) has remediated both the user and sign-in risks. Selecting Dismiss user risk will close all events and confirm that the user is not at risk at this time. It is very important to only select this option once you have confirmed that the user has completed the SSPR process. If the user has not changed their password, the risk has not truly been remediated.
You should not select Confirm compromised. While the credentials of the user were compromised at one point, the remediation of that issue by changing the password with SSPR resolved that situation. To mark the user as compromised now would only serve to unnecessarily increase their user risk level.
You should not select Confirm safe (on a sign-in). This option does not close out the user risk and any other related risk detections. It is only scoped to that specific sign-in. And more importantly, it is not an accurate
record of what happened. While the user is no longer at risk, the sign-in in question was not in fact safe.

You should not select Confirm compromised (on a sign-in). This may seem counterintuitive as this sign-in was in fact compromised. The key lies once again in the existing remediation. There is no sense at this time in selecting an option that will increase the user or sign-in risk level. The risk, at least for now, has passed due to the SSPR remediation.

---

### References

[Investigate incidents in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/investigate-incidents)  

[Investigate alerts in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/investigate-alerts?tabs=settings)  

[Investigate users in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/investigate-users)  

[Frequently asked questions Microsoft Entra ID Protection](https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection)  

---

## Q089:

You are using the Microsoft Defender portal to conduct an investigation into a multi-stage incident that is related to a suspected malicious document. After reviewing all of the details, you have determined that the alert that is tied to this potentially malicious document is also related to another incident in your environment. However, the alert is not currently listed as a part of that second incident. Your investigation into the alert is ongoing, as is your investigation into the two related incidents.
You need to appropriately categorize the alert and ensure that it is associated with the second incident.
Which two actions should you take in the Manage alert pane to fulfill this part of the investigation? Each correct answer presents part of the solution.

Choose the correct answers

- Enter the Incident ID of the related incident in the Comment section.
- Set the classification to True positive alert.
- Set status to In progress.
- Select the Link alert to another incident option.
- Set status to New.

---

### Answer:

- Set status to In progress.
- Select the Link alert to another incident option.

You should set the status to In progress to classify the alert. While the alert may seem legitimate as it is linked to another incident, until a final determination has been reached, you should set the status to In progress to ensure that others know that it is being worked on. Once a determination has been reached, you can then change it to Resolved and select the appropriate classification (True positive alert or False positive alert).
You should select the Link alert to another incident option to correlate the alert to the other incident. While ideally the alert would automatically be included in both incidents, that is not always the case. If you notice an alert that is not linked to an incident that it is clearly connected to, using the Link alert to another incident option would ensure that they are tied together.
You should not set the classification to True positive alert. While it may seem that this malicious file involved in multiple incidents is likely to be a True positive alert, you are not yet able to make that determination, likewise, it is not the time to classify it as a False positive alert. The best practice while continuing an investigation would be to not change the classification at all, which would mean leaving it as the default Not set classification.
You should not enter the Incident ID of the related incident in the Comment section. While this might be helpful from an administrative perspective, it would not create a link to the other incident.
You should not set the status to New. This is the default status of any alert. The question scenario specifically seeks to ensure that your peers know that the alert is being investigated, so setting (or leaving) the status as New would make it impossible for them to differentiate from other uninvestigated alerts.
All of the actions mentioned in the options can be found in the Manage alert pane, which can be reached via the Alerts tab in the Incidents section of the Microsoft Defender portal. This is an excellent central location from which you can manage incidents, and the components that make them up, including alerts.

---

### References

[Investigate incidents in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/investigate-incidents)  

[Investigate alerts in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/investigate-alerts?tabs=settings)  



---

## Q088:

You work for a company that wants to implement Microsoft Defender for Identity.
You need to work with the rest of the implementation team on the placement of the Microsoft Defender for Identity sensors.
What two types of servers could these sensors be directly installed on? Each correct answer presents a complete solution.

Choose the correct answers

- Domain controllers
- An Active Directory Federation Services (AD FS) server
- Any non-domain controller with an instance of Windows Server 2016 or newer
- A RADIUS server

---

### Answer:

- Domain controllers
- An Active Directory Federation Services (AD FS) server

The Microsoft Defender for Identity sensors could be placed on domain controllers or on an Active Directory Federation Services (AD FS) server. These sensors are used to collect critical data related to Active Directory (AD) activity within your domain. Ultimately, these sensors monitor your domain controllers. by capturing and parsing your network traffic to and from those servers. Then, Defender for Identity leverages the Windows events it is capturing and analyzes that data for threats or attacks.
You should not place the sensors on a Remote Authentication Dial-In User Service (RADIUS) server. A RADIUS server is used for network access control (NAC). While this can be a critical component of security for an organization, it does not act as a hub for the critical data that Microsoft Defender for Identity sensors are designed to acquire for Microsoft Defender for Identity.
You should not place the sensors on a non-DC Windows server (regardless of the version of Windows Server). There is no guarantee that the critical data that Microsoft Defender for Identity sensors are designed to capture would ever need to traverse the path of a regular, non-domain controllers server. Domain controllers and AD FS servers are the only servers that would act as sources for the Active Directory information the Microsoft Defender for Identity sensors collect, which is the critical data that feeds Defender for Identity.

---

### References

[Microsoft Defender for Identity architecture](https://learn.microsoft.com/en-us/defender-for-identity/architecture)  

[Microsoft Defender for Identity prerequisites](https://learn.microsoft.com/en-us/defender-for-identity/deploy/prerequisites)  

---

## Q087:

You work for a company that wants to improve its security posture by implementing Microsoft Entra ID Protection.
You need to determine the minimum license level you need to activate user risk and sign-in risk policies. Your solution should minimize costs.

Which licensing option should you use?

Choose the correct answer

- EMS ES
- Office 365 E3
- Microsoft Entra ID Free
- Microsoft Entra ID P2
- Microsoft Entra ID P1

---

### Answer:
- Microsoft Entra ID P2

You should use Microsoft Entra ID P2. This licensing option enables you to activate Microsoft Entra ID Protection user risk and sign-in risk policies. While the scenario does not state your company's current license, the key is focusing on what you know: you do not currently have Microsoft Entra ID Protection, you need to activate user risk and sign-in risk policies, so you need to add them as affordably as possible. Microsoft Entra ID P2 is the most affordable path to meet this requirement.
You should not use Microsoft Entra ID Free. Microsoft Entra ID Free has some security reporting, but no available Microsoft Entra ID Protection risk policies. Specifically, this licensing option provides reports on risky users (medium/high risk only) and some risky sign-in reporting (risk detail and level are not shown).
You should not use Microsoft Entra ID P1. Like Microsoft Entra ID Free, Microsoft Entra ID P1 has some security reporting, but it does not have Microsoft Entra ID Protection risk policies. Again, this licensing option provides reports on risky users (medium/high risk only) and some risky sign-in reporting (risk detail and level are not shown). At the P1 level, you also gain limited information on risk detections.
You should not use Office 365 E3. Office 365 E3 contains Microsoft Entra ID Free, so all of the information above that applies to Microsoft Entra ID Free would also apply here. Notably, you could add Microsoft Entra ID P2 to existing Office 365 E3 licensing, but mixing and matching licenses to achieve various business requirements is beyond the scope of the question scenario.
You should not use EMS E5. Although Enterprise Mobility & Security (EMS) E5 includes Microsoft Entra ID P2, it would come at a higher cost than simply adding Microsoft Entra ID P2 to your existing licensing.

---

### References

[What is Identity Protection?](https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection)   

[Enterprise Mobility + Security pricing options](https://www.microsoft.com/en-us/microsoft-365/enterprise-mobility-security/compare-plans-and-pricing)

---

## Q086:

The coordinator of the accounting team reports an incident in which a user sends an email containing sensitive information to people outside the organization. Your manager wants Microsoft Defender XDR to identify the incident as Red Incident, and they also want any similar incidents to be identified in a group.
You need to manage incidents in the Microsoft Defender portal to fulfill the manager's request.
Which two actions should you perform to meet the requirement? Each correct answer presents part of the solution.

Choose the correct answers

Add a tag to the incident.
Edit the name of the incident.
Classify the incident as a true alert.
Add a comment to the incident.
Classify the incident as a false alert.

---

### Answer:

You should edit the name of the incident. This action will allow you to change the name of the incident from the default name which is given to it by Microsoft Defender XDR to the name that the manager requests, in this case, Red Incident. This action can be carried out in the Microsoft Defender portal after accessing the Incidents tab and selecting the required incident. Microsoft Defender XDR is a solution that is used by companies to detect, prevent, investigate and respond across emails, applications, and endpoints within a company to protect it from threats.
You should also add a tag to the incident. This action, which can be carried out in the Microsoft Defender portal, will allow you to group all similar incidents under the same tag. This action is done on the Incidents page after selecting the required incident then modifying the Incident tags field, which is found on the right- hand side of the portal.
You should not classify the incident as a true alert. This action, which is done via the Classification field in the Microsoft Defender portal, would allow you to classify the incident as a suspicious activity that occurred in the company as a breach.
You should not classify the incident as a false alert. This action, which is done via the Classification field in the Microsoft Defender portal, would allow you to classify the incident as a suspicious but expected activity that occurred in the company, like using macros that might contain viruses in Microsoft Documents, for example.

You should not add a comment to the incident. Adding a comment to the incident would not change its name or help to group it with other similar incidents. You can view the comment added to an incident simply by selecting the incident, at which point a window on the right-hand side of the screen will display information about the incident, including the added comment.

---

### References

[Manage incidents in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/manage-incidents)  

---

## Q085:

The coordinator of the human resources team reports that their Microsoft Office 365 account has been compromised,
You are tasked with implementing a solution that notifies them by email when an employee's account is at risk.

You need to recommend a solution to meet the requirement.

What solution should you recommend?

Choose the correct answer

- Microsoft Entra ID Protection
- Sensitivity labels
- Microsoft Defender for Cloud
- Azure Lighthouse

---

### Answer:
- Microsoft Entra ID Protection

You should recommend Microsoft Entra ID Protection. This solution is used by companies in automating remediation and detection of risks related to users' identities. This solution can detect when a user's account gets attacked through malicious malware or when the account is at a certain risk that can compromise their identity. After detecting such a risk, the notification functionality of Microsoft Entra ID Protection would allow it to send an email to specified recipients, including the owner of the account, notifying them that the account is at risk.
You should not recommend Microsoft Defender for Cloud. Microsoft Defender for Cloud is a cloud workload protection feature that provides cloud security posture management and cloud workload protection. It is used to protect SQL databases, virtual machines, and web applications from malicious attacks. This solution does not send you an email when an account is at risk.
You should not recommend Azure Lighthouse. Azure Lighthouse is a solution that provides centralized control plane for service providers and large enterprises to manage the environments of multiple customers or individual subsidiaries efficiently and effectively, all at once.
You should not recommend sensitivity labels. Sensitivity labels allow you to protect and classify the company's data while making sure employees can effectively collaborate. When a sensitivity label is applied to content, it can restrict access to content by adding a mark to a specific document (like watermarks applied on documents) or by using encryption.

---

### References

[Microsoft Entra ID Protection notifications](https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-notifications)  

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[Build a scalable security practice with Azure Lighthouse and Azure Sentinel](https://azure.microsoft.com/en-us/blog/build-a-scalable-security-practice-with-azure-lighthouse-and-azure-sentinel/)  

[Learn about sensitivity labels](https://learn.microsoft.com/en-us/purview/sensitivity-labels?view=o365-worldwide)  


---

## Q084:

After a hacker attacks your company, the identities of your company's accounting department employees, which are stored in an on-premises Active Directory domain, have been compromised. Your manager wants to prevent this from happening again.
You need to recommend a solution that fulfills the manager's request.

What solution should you recommend?

Choose the correct answer

- Microsoft Defender for Identity
- Microsoft Defender for Cloud
- Active Directory backup
- Azure Firewall

---

### Answer:
- Microsoft Defender for Identity

You should recommend Microsoft Defender for Identity. Microsoft Defender for Identity is a cloud-based solution that elevates the Active Directory of the company to a state where it can identify and act on threats like compromised identities. This solution will protect the identities of the employees in the company, providing security insights on identity configuration and preventing their identities from being compromised again.
You should not recommend Azure Firewall. Azure Firewall is a network security service used through the cloud to protect the resources of Azure Virtual Network. This solution cannot be used to provide protection for identities in Active Directory.
You should not recommend Active Directory backup. Active Directory backup is used to back up Active Directory running on Windows Server, which helps companies restore Active Directory databases in case of disaster recovery needs. However, in this scenario, the objective is to protect the accounts stored in on- premises Active Directory from being compromised. Active Directory backup cannot be used to provide protection for identities in Active Directory.
You should not recommend Microsoft Defender for Cloud. Microsoft Defender for Cloud is a cloud workload protection solution that provides cloud security posture management and cloud workload protection. This is used to protect SQL databases, virtual machines, and web applications from malicious attacks, but it does not provide identity protection for identities stored in Active Directory.

---

### References

[What is Microsoft Defender for Identity?](https://learn.microsoft.com/en-us/defender-for-identity/what-is)  

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[Attack surface reduction rules overview](https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction?view=o365-worldwide)  

[What is Azure Firewall?](https://learn.microsoft.com/en-us/azure/firewall/overview)  

---

## Q083:

You are investigating a potential insider threat at your company.
An alert has been triggered in response to a policy that is designed to identify possible data theft carried out by an employee leaving the company. Upon examining the alert, you determine that additional escalation is needed.
You need to escalate this alert to an eDiscovery (Premium) case.

What action should you take before initiating the eDiscovery investigation?

Choose the correct answer

- Add a custodian to an eDiscovery case.
- Click the Resolve case button on the Cases tab.
- Send the user a notice.
- Create an insider risk management case.

---

### Answer:

- Create an insider risk management case.

You should create an insider risk management case. The correct workflow to escalate this alert to an eDiscovery (Premium) case is as follows:

1. Receive the alert.
2. Create an insider risk management case.
3. Escalate to eDiscovery.

Alerts do not automatically create insider risk management cases. That is a manual process. This action is accomplished in the Microsoft Purview compliance portal via the Insider Risk Management dashboard. The alert would initially be found in the Alerts tab of that dashboard, and creating an insider risk management case from the alert would make that case accessible on the Cases tab. From there, you would select the Escalate for investigation option, enter any notes (optional) and then click Escalate. This final step automatically creates an Advanced eDiscovery case as part of the investigation.

You should not send the user a notice to initiate the process. This is an optional step for insider risk case management, but it not a part of the process to escalate an alert to an eDiscovery investigation. This is an action you might take before resolving an insider risk management case if, for example, you wanted to simply remind a user of your corporate policies as you believe the user unintentionally violated them. You could then note that this action was taken in the Action taken field upon resolving the insider riskmanagement.case.

You should not resolve the case to initiate the process. There are two types of cases: insider risk management cases and eDiscovery (Premium) cases. The Resolve case option is a step used to classify an insider risk management case as either benign or as a confirmed violation. This is not a part of the process of elevating an insider risk management case to eDiscovery, as it would simply end the case from the inside risk management dashboard and never get to the Advanced eDiscovery step. This process of resolving an insider risk management case is simply a way to track the results of the case and to add any notes in the Action taken field.
You should not add a custodian to an eDiscovery case to initiate the process. At this point, no eDiscovery case would exist. An eDiscovery case would be created only once the insider risk management case is escalated via the process mentioned in the paragraphs above. Again, it is vital to understand the differences between insider risk management cases and Advanced eDiscovery cases. You cannot add custodians to an insider risk management case. Custodians can, however, be added to an Advanced eDiscovery case, as they are the individuals that will have administrative control of any documents/electronic files that may end up being important to the eDiscovery case. As such, although it may end up being part of your duties in the eDiscovery investigation, adding a custodian is not a part of the alert > insider risk management case creation > eDiscovery escalation process.

---

### References

[Learn about insider risk management](https://learn.microsoft.com/en-us/purview/insider-risk-management?view=o365-worldwide)  

[Take action on insider risk management cases](https://learn.microsoft.com/en-us/purview/insider-risk-management-cases?view=o365-worldwide&tabs=purview-portal)  

[Create and manage an eDiscovery (Premium) case](https://learn.microsoft.com/en-us/purview/ediscovery-create-and-manage-cases)  

[Microsoft Purview eDiscovery solutions](https://learn.microsoft.com/en-us/purview/ediscovery) 

---

## Q082:

You are configuring insider risk management for your company.
The accounting team's coordinator wants their team to be able to view the insider risk management's analytics and alerts but does not want the team to access the insider risk management Content Explorer.
You need to identify the correct role group to fulfill the coordinator's request.

What role group should you use?

Choose the correct answer

- Insider Risk Management Auditors
- Insider Risk Management Analysts
- Insider Risk Management Admins
- Insider Risk Management Investigators

---

### Answer:
- Insider Risk Management Analysts

You should use the Insider Risk Management Analysts role group. The users of this role group have the permission to access the insider risk management's analytics and alerts but do not have access to the insider risk management Content Explorer. You can use this group to give permissions to users who will act as insider risk analysts. The insider risk management Content Explorer is a feature that enables the members of the accounting team to view the content related to activities in alerts. The members require an Insider Risk Management Investigators role to use this feature.
You should not use the Insider Risk Management Investigators role group. This role group will give users access to the insider risk management's analytics and alerts but will also give them access to the insider risk management Content Explorer.
You should not use the Insider Risk Management Auditors role group. Users in this role group cannot access the insider risk management's analytics and alerts. They do, however, have access to the insider risk auditor
log.

You should not use the Insider Risk Management Admins role group. This role group is used to configure the insider risk management tool for the company. Users in this group have access to create, edit, and update the policies of insider risk management. In addition to that, users in this role group will have access to the insider risk management Content Explorer.

---

### References

[Get started with insider risk management](https://learn.microsoft.com/en-us/purview/insider-risk-management-configure?view=o365-worldwide&tabs=purview-portal) 

[Plan for insider risk management](https://learn.microsoft.com/en-us/purview/insider-risk-management-plan?view=o365-worldwide)  

[Create and manage insider risk management policies](https://learn.microsoft.com/en-us/purview/insider-risk-management-policies?view=o365-worldwide&tabs=purview-portal)  

---

## Q081:

You work for a company that uses Microsoft Defender for Cloud.
You are trying to address an issue with certain alerts that are overwhelming your security team and are not providing valuable information. A suppression rule was previously created to try and resolve this issue and it proved effective; however, it is no longer catching the alerts. No changes have been made to the rule since it was created.
You need to investigate why this rule is no longer suppressing the alerts as intended.

What are two possible reasons why this rule is not functioning as intended? Each correct answer presents a complete solution.

Choose the correct answers

The rule was based on specific criteria that have changed.
The rule was not tested with the Simulate button.
The State field for the rule was set to Disabled.
The wrong subscription was selected in the Subscription field.
The expiration date of the rule has been reached.

---

### Answer:

The only options listed that could explain why this rule is not functioning as intended are that the rule has expired or that the rule was based on specific criteria that have changed. Rules can only be set for a maximum of six months, so if a suppression rule that previously worked stops functioning, this is a likely scenario. It is also possible that the rule was set for very specific criteria such as an IP address or Azure resource, and changes in your environment have lead to additional alerts being generated by items outside of the scope of the initial rule.
The State field for the rule was set to Disabled cannot be a reason for the issue given that according to this scenario, no changes have been made.

The fact that a wrong subscription was selected in the Subscription field cannot be the reason for the issue. If the wrong subscription had been selected initially, the rule would have never worked as intended. Additionally, since we know no changes were made, you can rule out an alteration of the Subscription field.
The fact that the rule was not tested with the Simulate button cannot be the reason for the issue. While testing the rule with the Simulate button is best practice, it would not have any impact on the behavior mentioned in the question scenario. However, it is a great way to make sure a rule is catching what it should
when first created.

---

### References

[Suppress alerts from Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules) 



---

## Q080:

You administer Microsoft Sentinel at your company. You are requested to respond to security threats as soon as possible.
You need to implement near-real-time (NRT) analytics rules.

For each of the following statements, select Yes if the statement is true. Otherwise, select No.

NRT analytics rules run on a five-minute delay.
No

NRT analytics rules use the ingestion time rather than the event generation time.
Yes

NRT analytics rules have cross-workspace capability.
No

---

### Answer:

NRT analytics rules do not run on a five-minute delay. Near-real-time (NRT) analytics rules are designed to run with minimal delay, often within seconds or minutes, rather than waiting for longer intervals. They are meant to detect and respond to events as quickly as possible.
NRT analytics rules use the ingestion time rather than the event generation time. NRT rules typically use the ingestion time (when the data arrives in the system) rather than the event generation time (when the event occurred) for processing. This ensures that events are processed promptly upon ingestion.
NRT analytics rules do not have cross-workspace capability. NRT analytics rules operate within a single workspace in Microsoft Sentinel and cannot correlate data across different workspaces.

---

### References

[Quick threat detection with near-real-time (NRT) analytics rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/near-real-time-rules)  

---

## Q079:

![image info](./Q79.PNG)

In your Microsoft Sentinel instance, you are requested to create a custom threat detection analytics rule running on a schedule. You create the rule with the settings shown in the exhibit. You notice that there is a three-minute delay between the event generation time from the source and the event ingestion time by Microsoft Sentinel. As a result, an alert is not triggered by the rule.

You need to solve this issue.

What should you do?

Choose the correct answer

- Increase the Lookup data from the last setting to 13 minutes.
- Increase the Run query every setting to 13 minutes.
- Decrease the Lookup data from the last setting to seven minutes.
- Implement Microsoft Sentinel's near-real-time detection (NRT) rules.

---

### Answer:
- Increase the Lookup data from the last setting to 13 minutes.

You should increase the Lookup data from the last setting to 13 minutes. To address the delay, you should increase the lookup period to 13 minutes. The query should be run more frequently, covering a longer time period than the query interval. As a result, queries will overlap, ensuring that alerts are not missed and that the rule will be triggered.
You should not decrease the Lookup data from the last setting to seven minutes. Decreasing the lookup data setting will increase the existing delay. You should run the query more frequently, covering a longer time period than the query interval.
You should not increase the Run query every setting to 13 minutes. On the contrary, you should run the query more frequently, covering a longer time period than the query interval.


You should not implement Microsoft Sentinel's near-real-time detection (NRT) rules. When there is a three- minute delay between the event generation time from the source and the event ingestion time by Microsoft Sentinel, the NRT rules may not be sufficient to handle this three minute delay. Because this rule type is in near real time, the ingestion delay should be two minutes or less. Otherwise there is no advantage in using NRT rules.

---

### References

[Handle ingestion delay in scheduled analytics rules](https://learn.microsoft.com/en-us/azure/sentinel/ingestion-delay)  

[Handling ingestion delay in Azure Sentinel scheduled alert rules](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/handling-ingestion-delay-in-azure-sentinel-scheduled-alert-rules/ba-p/2052851)    

[Detect threats quickly with near-real-time (NRT) analytics rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/near-real-time-rules)  

---

## Q078:

You use Microsoft Sentinel to collect security-related data from various sources and analyze anomalies in your environment.

You notice that your anomaly rules generate an excessive number of anomaly alerts.

What is the reason for this?

Choose the correct answer

- The amount of anomaly signals is too high.
- The threshold is set too low.
- The anomaly signals are too strong.
- Unusual behavior identified by anomalies is set as a condition for alerts to be fired.


---

### Answer:
- The threshold is set too low.

A common reason for an anomaly rule to generate an excessive number of anomalies is when the threshold is set too low. The threshold defines the threshold value at which an anomaly is triggered. If the threshold for triggering alerts is set too low, it means that even minor or insignificant anomalies will meet the criteria for generating alerts. This can result in an excessive number of anomalies being generated, including those that may not pose any actual security risk. Setting the threshold too low increases the likelihood of false positives and can overwhelm security analysts with a large volume of noise or irrelevant alerts.
Having an excessively high amount of anomaly signals is not the common reason for excessive number of anomalies. Although a single anomaly may not strongly indicate malicious behavior, the collective impact of multiple anomalies occurring at various stages of the kill chain amplifies their significance.
Strong anomaly signals is not the common reason for excessive number of anomalies. It is rather the other way around. Effective detection of anomalies requires strong signals. Security analysts leverage anomalies. to identify emerging threats and enhance the efficacy of current detection methods. The collective impact of multiple anomalies occurring at various stages of the kill chain amplifies their significance and improves the accuracy of anomaly detection, which leads to greater accuracy and fewer false positive alerts.
The fact that unusual behavior identified by anomalies is set as a condition for alerts to be fired is not the common reason for excessive number of anomalies. By incorporating the unusual behavior identified through anomalies as a criterion for triggering alerts, security analysts can improve their existing detection mechanism.
As such, this action will lead to greater accuracy and fewer false positives alerts.

---

### References

[Work with anomaly detection analytics rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/work-with-anomaly-rules)  

[Use customizable anomalies to detect threats in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/soc-ml-anomalies)  

---

## Q077:

You use Microsoft Sentinel to collect and analyze security-related data from various sources.
You realized that some of the out-of-the-box (OOTB) anomaly detection rules do not provide the information you require.
You need to tune OOTB anomaly detection rules.

What should you do first with the affected rules?

Choose the correct answer

- Edit
- Create
- Disable
- Duplicate

---

### Answer:

You should first duplicate the affected rules. To tune the out-of-the-box (OOTB) anomaly detection rules in Microsoft Sentinel, the first step would be to duplicate an active anomaly rule, as you cannot directly edit the original active rule. This duplication process allows you to create a separate copy of the rule, which can then be customized and modified according to your needs while leaving the original rule unaffected. While the duplicated anomaly rule is being customized, the original rule will remain active and continue to operate. This deliberate design allows for a comparison between the results generated by the original configuration and the modifications made in the duplicated rule. This way, you can assess the impact and effectiveness of the changes.
You should not create rules first. Creating new anomaly detection rules is not the recommended first step when tuning OOTB anomaly detection rules. The focus here is on modifying and customizing the existing rules rather than starting from scratch.

You should not edit the affected rules first. Editing the original active rule is not possible. Instead, you must first duplicate an active anomaly rule and then customize the copied version. This allows you to make the necessary modifications while preserving the original rule for comparison purposes.
You should not disable the affected rules first. Disabling the original anomaly rule is an option after you have duplicated and customized a copy of the rule. However, disabling the original rule is not the first step in tuning the OOTB anomaly detection rules. The original rule should be kept active initially to compare the results generated by the original configuration and the customized copy.

---

### References

[Work with anomaly detection analytics rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/work-with-anomaly-rules)    

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)    

[Detect threats out-of-the-box](https://learn.microsoft.com/en-us/azure/sentinel/threat-detection)    

---

## Q076:

You are using Microsoft Defender for Endpoint to create indicators.
You have been tasked with allowing a specific file to run, so you want to add a file hash indicator of compromise (loC) to identify that exact file.

You create an loC policy with an Allow action and use an MD5 hash for the file indicator. One of your peers had previously added an loc policy with a Block and remediate action and also used an MD5 hash for the file indicator. Both hashes refer to the same identical file.
What should you do to ensure that the file is allowed to run?

Choose the correct answer

- Keep both existing policies, and add an loc policy using an SHA-256 hash file indicator for the same file with an Allow action.

- Delete the loc policy that is using the Block and remediate action.

- Delete the loC policy that is using the Allow action.

- Keep both existing policies active as the Allow action will take precedence.

---

### Answer:
- Delete the loc policy that is using the Block and remediate action.

You should delete the indicator of compromise (loC) policy that is using the Block and remediate action. This will allow the loc policy using the Allow action to take precedence. Prior to deleting this policy, it would have taken precedence and the file would have been blocked/remediated.

There are two factors to be taken into account in the loC policy conflict handling process for this scenario:

1. You need to consider which action the loC policies are using. For the Files loC type, this would be Allow, Audit, or Block and remediate. This is a fairly simple conflict to resolve, as a policy that is blocking based on a file loC will take precedence over a policy that is allowing based on a file loC.

2. For file hashes referencing the same exact file, you need to consider which hashing algorithm is used. The stronger, longer hash will be chosen if both policies are using the same action. Remember that hashing is a one-way process that puts a file (or other digital content) through an algorithm and produces a string. That string can be used as an loC for a file, but different hashing algorithms will produce alternate strings with different lengths. For example, the SHA-256 hashing algorithm produces a 256-bit hash, while the MD5 algorithm produces a 128-bit hash.

With both of these factors considered, the issue with the current policy conflict is simple: you want to allow the file to run, but the policy using the Block and remediate action will win out as-is. The best path to making sure your allow loc policy wins out is to simply delete the loc policy using the Block and remediate action. The hash algorithm used does not matter in this situation, as the loc policy's action was the issue.
You should not keep both existing policies active as the Allow action will take precedence. This is incorrect, because as-is, the Block and remediate loc policy would win out and block the file. When file indicator loCs are used for loc policies, Block and remediate takes precedence over Allow.
You should not delete the loC policy that is using the Allow action. This should be a relatively obvious incorrect solution, as this would only leave the loc policy using the Block and remediate action remaining.
You should not keep both existing policies and add an loC policy using an SHA-256 hash file indicator for the same file with an Allow action. While using a SHA-256 hash for your file indicators is a good best practice, the loc policy using the MD5 hash and the Block and remediate action would still win out here. While the SHA-256 hash is the longer, stronger hash, that factor does not come into play as the Block and remediate action takes precedence over the Allow action.

---

### References

[Create indicators](https://learn.microsoft.com/en-us/defender-endpoint/manage-indicators?view=o365-worldwide)  

[Create indicators for files](https://learn.microsoft.com/en-us/defender-endpoint/indicator-file?view=o365-worldwide)  

[Manage exclusions for Microsoft Defender for Endpoint and Microsoft Defender Antivirus](https://learn.microsoft.com/en-us/defender-endpoint/defender-endpoint-antivirus-exclusions)  

---

## Q075:

You are a Security Operator for an organization that uses Microsoft 365 services, including SharePoint Online, Exchange Online and Microsoft Teams. You have recently started to use Microsoft Defender for Cloud to add additional layers of protection to the environment to help protect against malicious threats and attacks.

Your manager has asked you to implement Microsoft Defender for Cloud Apps in order to:

- Detect unusual activity within the tenant.
- Scan your cloud apps for specified data or data types and apply governance actions to that data.
- Log and search for unusual occurrences within your cloud apps.

You need to configure the correct policy type to meet the requirements.
Which three policy types should you implement? Each correct answer presents part of the solution.

Choose the correct answers

- File policy
- Anomaly detection policy
- Cloud Discovery anomaly detection policy
- Malware detection policy
- OAuth app policy
- Activity policy

---

### Answer:

- File policy
- Anomaly detection policy
- Cloud Discovery anomaly detection policy

You should implement an anomaly detection policy to be able to detect unusual activity within the tenant. This type of policy allows you to look at unusual activities with your cloud tenant and detect activity based on risk factors you have an alert on. Anomaly detection policies include activity from infrequent country, malware detection and activity from anonymous IP addresses.
You should also implement a file policy to be able to scan your cloud apps for specified data or data types and apply governance actions to that data. This type of policy allows you to scan your tenant apps for specified files or file types as well as data. You can then apply governance actions to the files and data. An example of a file policy could be detecting the sharing of a file with external domains.
Finally, you should implement a Cloud Discovery anomaly detection policy to log and search for unusual occurrences within your cloud apps. This policy type allows you to look at logs that are used to discover apps and search for unusual occurrences, which could refer to increases in uploaded data by a user or to an IP address.
You should not use an activity policy since this enables you to enforce many different automated processes by using the app provider's APIs. This does not fulfill any of the requirements.
You should not use an OAuth app policy since this allows you to investigate the permissions each OAuth app has asked for and automates the approval and revocation process. This does not meet any of the requirements.
You should not use a malware detection policy since this allows you to identify malicious files that are stored within your cloud. This does not meet any of the requirements.

---

### References

Control cloud apps with policies
Cloud Discovery anomaly detection policy
Anomaly detection policies in Defender for Cloud Apps
Work with anomaly detection analytics rules in Microsoft Sentinel

---

## Q074:

Your organization has an Azure subscription that uses Microsoft Sentinel.
You are manually creating a Microsoft Sentinel hunting query.
You have chosen to use an Advanced Security Information Model (ASIM) normalization schema for using filtering parsers in your queries, in order to improve their performance.
You need to use schemas that support filtering parameters.

Which four ASIM normalization schemas could you select? Each correct answer presents part of the solution.

Choose the correct answers

- DHCP
- Web Session
- Authentication
- Network Session
- DNS
- File
- User Management

---

### Answer:

- Web Session
- Authentication
- Network Session
- DNS

Choosing to use an Advanced Security Information Model (ASIM) parser instead of table names in your Microsoft Sentinel queries allows you to view data in a normalized format and to include all data relevant to the schema in your query. In this scenario, you have chosen to use the ASIM normalization schema, which enables you to use filtering parsers in your queries. ASIM normalization schemas are in the public preview phase at the time of writing. It is important to note that an analyst is currently considering building a solution to utilize the ASIM schema for a filtering parser. In this scenario, all four schemas must be taken into account. Using the wrong schema will disrupt the parser's functionality. 

The following ASIM normalization schemas support filtering the following parameters:

1. The Authentication normalization schema should be used when your aim is to describe events related to user authentication, such as sign-ins and sign-outs. Authentication events are sent by many reporting devices, usually as part of the event stream alongside other events. For example, the below allows you to filter only authentication events from the last two days for a specific user called "sugh":

`imAuthentication (targetusername has = 'sugh', starttime endtime=now()) ago (2d), endtime=now())`

2. The DNS normalization schema is used to describe events reported by a DNS server or a DNS security system and is used by Microsoft Sentinel to enable source-agnostic analytics. For example, the below allows you to filter only DNS queries from the past three days that failed to resolve the domain name:

`Im Dns (responsecodename = 'NXDOMAIN', starttime ago (3d), endtime=now())`

3. The Network Session normalization schema represents an IP network activity, such as network connections and network sessions. Operating systems, routers, firewalls, and intrusion prevention systems report incidents related to this normalization schema. For example, the below allows you to filter only network sessions for a specified list of domain names:

`let torProxies=dynamic(("myTor1.com", "myTor2.com"]); (hostname_has_any torProxies) Im NetworkSession (hostname_has_any = torProxies)`

4. The Web Session normalization schema is used to describe an IP network activity. For example, IP network activities are reported by web servers, web proxies, and web security gateways.

You should not use the DHCP normalization schema. The DHCP normalization schema is used to describe
events reported by a DHCP server and is used by Microsoft Sentinel to enable source-agnostic analytics.
The DHCP schema does not support an ASIM filtering parser, which is what is required in this scenario.

You should not use the File Event normalization schema because it does not support an ASIM filtering parser. The File Event normalization schema is used to describe file activity such as creating, modifying, or deleting files or documents. Such events are reported by operating systems and file storage systems, such as Azure Files, and document management systems such as Microsoft SharePoint.

You should not use the User Management normalization schema. The user Management normalization schema is used to describe user management activities, such as creating a user or a group, changing a user attribute, or adding a user to a group. Operating systems, directory services, identity management systems, and any other system reporting on its local user management activity usually report these incidents. The User Management schema does not support an ASIM filtering parser.

---

### References


[Using the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers)  
0
[List of Microsoft Sentinel Advanced Security Information Model (ASIM) parsers (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-parsers-list)

[The Advanced Security Information Model (ASIM) Authentication normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-authentication)  

[The Advanced Security Information Model (ASIM) DNS normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-dns)  

[The Advanced Security Information Model (ASIM) Network Session normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-network)  

[The Advanced Security Information Model (ASIM) Web Session normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-web) 

[The Advanced Security Information Model (ASIM) DHCP normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-dhcp)  

[Microsoft Sentinel user management normalization schema reference (preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-user-management)  

[Modify content to use the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-modify-content)  

---

## Q073:

You have an Azure subscription that uses Microsoft Sentinel.
You are developing an Advanced Security Information Model (ASIM) parser which will view data in a normalized format and retrieve all of the data relevant to the schema in a single query.
You need to map an original field to its normalized name.

Which operator should you use?

Choose the correct answer

- project-rename
- project-reorder
- project-keep
- project-away

---

### Answer:

- project-rename

You should use the project-rename operator to map an original field to its normalized name. This operator ensures that the field is still managed as a physical field and that handling the field is more performant. A usage example would be: T❘ project-rename new_column_name = column_name, wherein T is the name of the input table.
You should not use the project-reorder operator. This operator reorders columns in the result output. It cannot be used to map an original field and rename it to its normalized field. For example, you could use T project-reorder col1, col2, col3 asc, wherein T is the name of the input table, to reorder columns col1, col2 and col3 in ascending order.
You should not use the project-away operator. This operator selects which input columns should be excluded from the output. It cannot be used to map an original field and rename it to its normalized field. An usage example would be T❘ project-away ColumnName OrPattern [....], wherein T is the name of the input table and ColumnName OrPattern denotes the column name or pattern which will be excluded from the output.

You should not use the project-keep operator. This operator uses a columnname pattern matcher to select which columns from the input will be kept in the output. It cannot be used to map an original field and rename it to its normalized field.

---

### References

[Using the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers)  

[Modify content to use the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-modify-content)  

[project-rename](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/project-rename-operator)  

project-reorder
project-keep
project-away

---

## Q072:


You have an Azure subscription that uses Microsoft Sentinel.
You are trying to view data in a normalized format and get all of the data that is relevant to the schema in a single query.
You have written the following query:

```
Im_Dns (responsecodename='NXDOMAIN') summarize count() by SrcIpAddr, bin (TimeGenerated, 5m) I where count > threshold | join kind=inner (imDns (responsecodename='NXDOMAIN')) on SrcIpAddr extend timestamp TimeGenerated, IPCustomEntity = SrcIpAddr
```

For each of the following statements, select Yes if the statement is true. Otherwise, select No.

The query uses a built-in Advanced Security Information Model (ASIM) parser.
Yes

The query uses a filtering parser.
Yes

SrclpAddr can be replaced with Client_IP in the query.
No

---

### Answer:

The query uses a built-in Advanced Security Information Model (ASIM) parser. Advanced Security Information Model (ASIM) parsers allow you to use built-in parsers instead of table names in your Microsoft Sentinel queries. They enable you to view data in a normalized format and to include all data relevant to the schema in a query. At the time of writing, Advanced Security Information Model (ASIM) is in public preview.
The query uses a filtering parser. A non-filtering parser would have used the same query with a WHERE clause for checking conditions. Using normalized filtering parsers produces shorter ASIM schema queries, therefore making the writing process more efficient. Microsoft recommends always leveraging ASIM filtering parsers, since they perform better than workspace non-filtering parsers.
The SrclpAddr field cannot be replaced with Client_IP. Since the query is leveraging a built-in ASIM parser, it uses the SrclpAddr field. You could only use a Client IP field if you were using a workspace-deployed ASIM parser.

---

### References

[Using the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers)  

[Modify content to use the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-modify-content)  

---

## Q071:

You have an Azure subscription that uses Microsoft Sentinel.
You are optimizing the way Microsoft Sentinel identifies entities in alerts from different types of data sources.
You need to implement strong identifiers for the host entity type.

Which three identifier options should you select? 
Each correct answer presents part of the solution.

Choose the correct answers

- HostName and DnsDomain
- OMSAgentID
- OSFamily
- AzurelD
- HostName
- DnsDomain
- FullName

---

### Answer:

- HostName and DnsDomain
- OMSAgentID
- AzurelD

Microsoft Sentinel supports a wide range of entity types, each with their own unique attributes. Some of these attributes can be leveraged to identify a specific entity. These attributes are represented as fields in the entity and are called identifiers. There are three kinds of identifiers: identifiers, required identifiers, and strongest identifiers. The core difference between a weak identifier and a strong identifier is the fact that a strong identifier can uniquely identify an entity without any ambiguity, whilst a weak identifier can only identify an entity under certain circumstances and cannot be guaranteed to uniquely identify an entity in all cases. For best results in terms of guaranteed unique identification, it is Microsoft's recommendation that you should always use identifiers from the strongest identifiers column, whenever possible. In this scenario, you need to select the recommended strongest identifier for the host entity type. You should therefore select the following:
1. HostName and DnsDomain: HostName represents the host name without the domain suffix. DnsDomain represents the DNS domain that this host belongs to. Hostname and DnsDomain in themselves are simple identifiers, with HostName being a required identifier as well. However, combining HostName and DnsDomain for a host gives a unique value that can identify an entity without any ambiguity. Therefore, in the given list of identifiers, this is an example of a strongest identifier.
2. AzureID: This value represents the Azure resource ID of the virtual machine (VM), if known. AzurelD gives a unique value that can identify an entity without any ambiguity, thereby making it an example of a strongest identifier.
3. OMSAgentID: This value represents the Operations Management Suite (OMS) agent ID, if the host has the OMS agent installed. OMSAgentID gives a unique value that can identify an entity without any ambiguity and it is therefore an example of a strongest identifier.
You should not select DnsDomain. Dns Domain represents the DNS domain that this host belongs to. By itself, as a standalone identifier, it is not a strongest identifier.
You should not select HostName. HostName represents the hostname without the domain suffix. As with DnsDomain, it is not a strongest identifier by itself.
You should not select OSFamily. OSFamily represents any of the following four values: Linux, Windows, Android, or IOS, which represent the host operating system. By itself, it is not a strongest identifier.
You should not select FullName. FullName is in fact, not part of schema, and is only included for backward compatibility with old versions of entity mapping in Microsoft Sentinel. By itself, it is not a strongest identifier.

---

### References

[Classify and analyze data using entities in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/entities)  
[Microsoft Sentinel entity types reference](https://learn.microsoft.com/en-us/azure/sentinel/entities-reference)  

---

## Q070:

You are currently using Microsoft Sentinel for the collection of Windows security events. You want to use Microsoft Sentinel to identify Remote Desktop Protocol (RDP) activity that is unusual for your environment.
You need to enable the Anomalous RDP Login Detection rule.
What two prerequisites do you need to ensure are in place before you can enable this rule? Each correct answer presents part of the solution.

Choose the correct answers

- Let the machine learning algorithm collect 30 days' worth of Windows Security events data.
- Select an event set other than None.
- Collect Security events or Windows Security Events with Event ID 4720.
- Collect Security events or Windows Security Events with Event ID 4624.


---

### Answer:

One of the best features of a Security information and event management (SIEM) tool like Microsoft Sentinel is correlating important data and finding events that deserve your attention. The Anomalous Remote Desktop Protocol (RDP) Login Detection rule does just that. Enabling this rule requires two prerequisites:
You should collect Security events or Windows Security Events with Event ID 4624. This is the event ID for an account successfully logging on to a machine/system. This covers many login types, including RDP. Without this data, Microsoft Sentinel would be blind to RDP logins entirely. This process would be completed in the Security Events Data Connector or Windows Security Events Data Connector pages within Microsoft Sentinel.
You should also select an event set other than None. This configuration step is completed during the data connector implementation described above. This step ensures that the aforementioned connector is actually passing data. Options other than None include All events, Common, and Minimal. Although the None event set may seem counterintuitive, it can be used to disable a connector without deleting/removing it. This can be helpful in certain troubleshooting scenarios.

You should not collect Security events or Windows Security Events with Event ID 4720. This is the Event ID for the creation of a user account, not for logging on to a machine or system. While it may seem picky to expect a security professional to memorize exact event IDs, it is incredibly helpful to recognize some of the most common ones. Logins (4624) and user creation (4720) are two that are very useful to know in the event of conducting time sensitive research of a potential compromise and privilege escalation/account creation incident response (IR) scenario.
You should not let the machine learning algorithm collect 30 days' worth of Windows Security events data. This is, however, a very important time frame as regards the time after you enable the rule. This rule relies on a machine learning algorithm that ultimately requires 30 days' worth of data before it can build a baseline. This baseline is a profile of your company's normal user behavior, so you need to allow 30 days of Windows Security events data to be ingested before the rule will result in the discovery of any incidents. Remember, however, that the scenario only refers to the process required to enable the rule and not the generation of incidents thereafter.
Finally, the actual process to enable the rule after these prerequisites are set is fairly simple. Starting in the Microsoft Sentinel portal, you should click Analytics, and then click the Rule templates tab. Next, you must choose the (Preview) Anomalous RDP Login Detection rule and simply move the Status slider from Disabled (the default) to Enabled.

---

### References

[Configure the Security Events or Windows Security Events connector for anomalous RDP login detection](https://learn.microsoft.com/en-us/azure/sentinel/configure-connector-login-detection)  

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference)  

[What's New: Azure Sentinel Machine Learning Behavior Analytics: Anomalous RDP Login Detection](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/what-s-new-azure-sentinel-machine-learning-behavior-analytics/ba-p/1521988)  

---

## Q069:

An employee reports that their data was compromised through a cyber-attack.
You need to implement a solution that detects the origin of the attack and identifies the potential data loss.

Which solution should you recommend?

Choose the correct answer

- Cloud Connectors in Microsoft Defender for Cloud
- Data Loss Prevention (DLP) policies
- Sensitivity labels
- Analytics rules in Microsoft Sentinel

---

### Answer:
- Analytics rules in Microsoft Sentinel

You should recommend analytics rules in Microsoft Sentinel. This solution can detect and identify threats by matching the presence of signs and signals that impact the existence of a cyber-attack. Using this solution, you can identify the origin of a cyber-attack and the potential loss of data that occurred due to the attack. In addition, analytics rules in Microsoft Sentinel allow you to view the timeline of the incident, in which you can review the severity of the incident and a brief description of it.
You should not recommend Cloud Connectors in Microsoft Defender for Cloud. Microsoft Defender for Cloud Connectors help organizations improve their security posture by enabling them to leverage the power of Microsoft Defender for Endpoint and other security solutions in a more integrated and seamless manner by helping to ingest log data into Microsoft Defender for Cloud workspace. The connectors themselves cannot detect and identify threats.
You should not recommend Data Loss Prevention (DLP) policies. DLP policies are a solution that bans the accidental sharing of sensitive information with people outside the organization. They cannot detect the origin of a cyber-attack nor the potential data loss resulting from it.

You should not recommend sensitivity labels. Sensitivity labels allow you to protect and classify the company's data while making sure employees can collaborate effectively. When a sensitivity label is applied to content, it can restrict access to content by adding a mark to a specific document, like watermarks applied on documents, or by using encryption.

---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  

[Using Azure Lighthouse and Microsoft Sentinel to Investigate Attacks Across Multiple Tenants](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/using-azure-lighthouse-and-azure-sentinel-to-investigate-attacks/ba-p/1043899)  

[Learn about sensitivity labels](https://learn.microsoft.com/en-us/purview/sensitivity-labels)  

[Get started with the data loss prevention alerts](https://learn.microsoft.com/en-us/purview/dlp-alerts-get-started)  

[Microsoft Defender for Cloud Recommendation.](https://learn.microsoft.com/en-us/connectors/ascassessment/)  


---

## Q068:

You administer Microsoft Defender XDR for your organization. You configure the Microsoft Defender XDR deception capability to increase the confidence of detections of human-operated lateral movement.
You need to correctly identify the components of the deception feature to manually create a deception rule.
Which components should you identify? To answer, drag the appropriate component to its description. A component may be used once, more than once, or not at all.

Drag and drop the answers

Lure
Decoy

Fake devices : Decoy
Fake accounts: Decoy
Fake documents: Lure
Fake cached credentials : Lure

---

### Answer:

Deception technology offers a security approach that notifies security teams upon the detection of a potential attack, empowering them to take immediate action. This technology fabricates counterfeit assets, such as devices, users, and hosts, that appear to be part of your network. The Microsoft Defender XDR deception capability uses rules to create decoys and lures that match your environment.
Decoys are fake devices and accounts that appear to belong to your network.
Lures are fake content planted on specific devices or accounts. The content can be a document, a configuration file, or cached credentials. It can also be any other content that an attacker can likely read or steal. Lures can be planted on decoys as well as on the valid devices or accounts.

---

### References

[Manage the deception capability in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/deception-overview)  

[Configure the deception capability in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/configure-deception)  

---

## Q067:

You have an Azure subscription that uses Microsoft Sentinel.
You are classifying and analyzing data by using entities. After connecting your data sources to Microsoft Sentinel, you have created custom analytics rules to help discover threats and anomalous behaviors in your environment.
The alerts are growing larger than 64 KB, and thus are getting truncated.
You need to customize the rule query logic to reduce the size of your alert.

Which operator should you use?

Choose the correct answer

- reduce
- parse
- partition
- project-away

---

### Answer:
- project-away

You should use the project-away operator. This operator allows you to select which specific columns from the input should be excluded from the output. This operator returns a table with columns that were not named as arguments.
You should not use the partition operator. This operator partitions the records of its input table into multiple sub-tables. The required input is composed of values in a key column, and it is then run as a subquery on each sub-table. This then produces a single output table. This resultant table is the union of the results of all subqueries. This operator is useful when you need to perform a subquery only on a subset of rows that belongs to the same partition key, instead of querying the whole dataset. This operator cannot be used to reduce the size of the output by excluding specific columns from the input, which is the desired outcome in this scenario.
You should not use the reduce operator. The reduce operator allows you to group a set of strings together based on the similarity of the values. This operator cannot be used to exclude specific input columns from the output, thereby reducing its size, which is the desired outcome in the scenario.
You should not use the parse operator. The parse operator allows you to evaluate a string expression and parse its value into one or more calculated columns. The calculated columns will have nulls, for unsuccessfully parsed strings.

---

### References

[Classify and analyze data using entities in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/entities)  

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  

[project-away operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/project-away-operator)  

Partition operator
reduce operator
parse operator

---

## Q066:

Microsoft Sentinel offers a significant amount of built-in rules, but your company has some specific use cases that require more granular control of both rule sets and alerting. You are working on creating custom rules in Microsoft Sentinel to meet these use cases.

You need to create a rule that runs every hour and stops running if there is a single alert.
Which two options should you select in the Analytics rule wizard to meet these requirements? Each correct answer presents part of the solution.

Choose the correct answers

- Under Run query every, select 1 hour.
- Under Event grouping, select Group all events into a single alert.
- Under Stop running query after alert is generated, select On.
- Under Lookup data from the last, select 1 hour.

---

### Answer:

- Under Run query every, select 1 hour.
- Under Stop running query after alert is generated, select On.

You should select 1 hour under Run query every. As the name implies, this simply runs the Kusto Query Language (KQL) query every hour. The key here is understanding the difference between Run query every and Lookup data from the last. Often, if you run a query every hour, you will also run it on data for the last hour. This latter portion represents the Lookup data from the last option. However, the scenario only mentions the frequency of the query being run, not how far back the query must look through data.

You should also select the On option under Stop running query after alert is generated. This is the way to identify a query that should stop as soon as an alert is present. Although there are other ways of limiting the number of alerts generated, this option is the way to actually cease a query once any alert occurs. This is the configuration you would choose if you know that a single alert is all you are looking for, and that running the query after that alert is generated would serve no purpose.

You should not select 1 hour under Lookup data from the last. Again, although it may be a common practice that the query frequency matches the lookup time frame, this does not have to be the case. The requirements for the rule do not state any specific lookup time. For example, it is possible to run a query hourly but have the query look back at the past six hours each time it runs. In a real-world scenario, you would need to get further information on any lookup time requirements before altering this setting.

You should not select Group all events into a single alert under Event grouping. Although the scenario mentions a single alert, it is referring to the fact that you can set a query to stop running as soon as any alert is generated. These are two different use cases. if you stop running a query upon the first alert, you are essentially saying you found what you are looking for and allowing the query to continue to run would be pointless. With grouping all events into a single alert, you are trying to reduce overall alert numbers. However, the query would continue to run if you made this selection instead of selecting the On option under Stop running query after alert is generated.

---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)    

---

## Q065:

You are an administrator of Microsoft Defender for Office 365. Your users and preset security policies in Microsoft Defender for Office 365 are configured as shown in the tables below:

> Table 1 :

| User | Groups |
|------|--------|
| User1@company.com | Group1 and Group2 |
| User2@company.com | Group3 |
| User3@company.com | Group2 and Group3 |

> Table 2 :

| Policy Name | Policy Filter |
|---|---|
| Policy1 | Users: User1, User2<br>Groups: None |
| Policy2 | Users: User1<br>Groups: Group1, Group3 |
| Policy3 | Users: User2, User3<br>Groups: Group2, Group3 |


You need to review the policies and identify the ones that are correctly applied to all users within them.

Which policy should you identify as correctly applied?

- Policy 1 only
- Policy1 and Policy2 only
- Policy2 only
- Policy1, Policy2, and Policy3

---

### Answer:
- Policy 1 only

You should identify Policy1 only as correctly applied to all of its users. Preset security policies permit you implement protective measures for users following Microsoft's suggested configurations. Unlike custom policies, preset security policies are unmodifiable and are formulated based on Microsoft's observations in data centers.
If you set up policy filters using multiple policy conditions, the policy conditions are inclusive, and not additive. It means that Policy2 applies only if User1 is a member of Group1 and Group3. All of the specified recipient filters must match. Policy 1 is the only one that meets this criteria, because it has no groups defined, and therefore it does not matter which groups User1 and User2 belong to.

---

### References

[Preset security policies in EOP and Microsoft](https://learn.microsoft.com/en-us/defender-office-365/preset-security-policies)

[Trial user guide: Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/trial-user-guide-defender-for-office-365)  

[Set up steps for the Standard or Strict preset security policies in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/step-by-step-guides/ensuring-you-always-have-the-optimal-security-controls-with-preset-security-policies)  

---

## Q064:

You manage a Microsoft 365 environment in your organization. You are requested to make sure sensitive files are not uploaded to your OneDrive storage.
You need to configure a policy in Microsoft Defender for Cloud Apps.

Which policy should you configure?

Choose the correct answer

- File policy
- Access policy
- Session policy
- Malware detection policy

---

### Answer:
- Session policy

You should configure a session policy. Session policies in Microsoft Defender for Cloud Apps allow you to define rules for controlling user access to cloud applications and services based on conditions such as user groups, device types, and IP addresses. You can use session control policies to grant access while monitoring the session. It is also possible to restrict certain session activities. When the Control file upload (with inspection) option is selected as the Session Control type in the Defender for Cloud Apps session policy, Conditional Access App Control is triggered. This mechanism prevents users from uploading a file based on the policy's file filters.
You should not configure an access policy. Access policies in Microsoft Defender for Cloud Apps allow you to define rules for controlling user access to cloud applications and services based on conditions of block or allow access completely. In this scenario, you need to restrict specific session activities.

You should not configure a file policy. File policies allow you to scan your cloud applications for specific files or file types, data, and then enforce governance actions on these files. Upon activation, the policy maintains a continuous scan of your cloud environment, pinpointing files that align with the content and context filters, and executing the prescribed automated actions. These policies identify and rectify any breaches concerning stored information.
You should not configure a malware detection policy. This type of policy identifies malicious content in your cloud storage.

---

### References

[Session policies](https://learn.microsoft.com/en-us/defender-cloud-apps/session-policy-aad)  

[Access policies in Microsoft Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/access-policy-aad)  

[File policies in Microsoft Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/data-protection-policies)  

[Anomaly detection policies in Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy)  

---

## Q063:

You have an Azure subscription with all available plans activated for all workloads in Microsoft Defender for Cloud.
You need to analyze detailed security alerts and recommendations generated by Microsoft Defender for Cloud for Key Vault. You should minimize costs.

What should you configure to meet the requirement?

Choose the correct answer

- Continuous export
- Azure Monitor Agent
- Storage account
- Log Analytics workspace

---

### Answer:
- Continuous export

You should configure continuous export. With continuous export you have the option to export the detailed security alerts and recommendations generated by Microsoft Defender for Cloud to Azure Log Analytics or Event Hubs for further analysis and examination. By default, only virtual machine (VM) based alerts are stored in a Log Analytics workspace assigned to Microsoft Defender for Cloud; specifically, alerts generated by Microsoft Defender for Servers. This implies that alerts generated by other Defender for Cloud plans, such as Microsoft Defender for Key Vault, are not stored in the workspace by default. To store these alerts in the workspace, the continuous export feature must be utilized.
You should not use a storage account. An Azure storage account is a type of Azure resource that provides a secure and scalable cloud storage solution. It serves as a central location for storing various types of data, including files, blobs (binary large objects), tables, queues, and VM disks. To further analyze and examine the Azure Key Vault alerts, they have to be continuously exported to a Log Analytics workspace.
You should not use a Log Analytics workspace. A Log Analytics workspace is a central repository in Azure that collects, stores, and analyzes data and logs from various sources, including Microsoft Defender for Cloud. It provides powerful query and analysis capabilities to gain insights into the collected data. 

In this scenario, all available plans are activated for all workloads in Microsoft Defender for Cloud, which means that at least one Log Analytics workspace must already be created. As such, to minimize the costs there is no requirement to create another one. Because, by default, alerts generated by Defender for Cloud for Key Vault plan are not stored in the Log Analytics workspace used by Defender for Cloud, the continuous export feature must be utilized.
You should not use the Azure Monitor Agent. The Azure Monitor Agent is a component that facilitates the collection and forwarding of data from various sources to an Azure Log Analytics workspace. It is designed to gather data from on-premises servers or VMs, and send that data to the Log Analytics service for analysis and monitoring. The Azure Monitor Agent is not designed to be used with Azure Key Vault.

---

### References

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[Continuously export Microsoft Defender for Cloud data](https://learn.microsoft.com/en-us/azure/defender-for-cloud/continuous-export)    

[Log Analytics workspace overview](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview)  

[Azure Monitor Agent overview](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-overview)  

[About Azure Key Vault](https://learn.microsoft.com/en-us/azure/key-vault/general/overview)  

[Introduction to Azure Storage](https://learn.microsoft.com/en-us/azure/storage/common/storage-introduction)  

---

## Q062:

You have an Azure subscription that is protected by Microsoft Defender for Cloud. To improve your Software Development Life Cycle (SDLC) you implement Azure DevOps.
You need to configure the prerequisites to activate Microsoft Defender for Cloud for your new implemented DevOps environment.
Which three actions should you perform? Each correct answer presents part of the solution.
Choose the correct answers

- Configure the Security Admin role.
- Configure the Azure DevOps service connection.
- Configure third-party applications to gain access via OAuth.
- Configure enterprise application authentication via OpenID Connect and OAuth.
- Configure the Microsoft Security DevOps extension.

---

### Answer:

- Configure the Security Admin role.
- Configure third-party applications to gain access via OAuth.
- Configure the Microsoft Security DevOps extension.

You should configure the Microsoft Security DevOps extension in Azure DevOps, configure third-party applications to gain access via OAuth, and configure the Security Admin role in Microsoft Defender for Cloud.
Configuring the Microsoft Security DevOps extension is necessary because it provides integration between your DevOps environment and Microsoft Defender for Cloud. This extension enables you to automate security-related tasks, such as scanning code repositories, analyzing security vulnerabilities, and incorporating security checks into your CI/CD pipelines. It helps to ensure that security practices are embedded within your DevOps workflows and to detect and mitigate potential security risks.
Configuring third-party applications to gain access via OAuth is essential for allowing seamless and secure integration between your DevOps environment and other Azure or external services. OAuth is an authorization protocol that enables secure and controlled access to external applications without exposing user credentials. By configuring OAuth, you can establish trusted connections between your DevOps environment and other Azure (Microsoft Defender for Cloud) or third-party services, such as vulnerability scanners, code analysis tools, or security information and event management (SIEM) systems. This integration enables the exchange of relevant security data and helps to streamline security operations within your DevOps processes.
Configuring the Security Admin role is important to ensure that the appropriate permissions and access controls are in place for managing and administering Microsoft Defender for Cloud. The Security Admin role provides granular control over security-related configurations, policies, and settings within the Defender for Cloud environment. By assigning this role to specific individuals or groups, you designate them as responsible for managing security-related aspects, such as activating required plans, defining security policies, monitoring alerts, investigating incidents, and performing administrative tasks within the Microsoft Defender for Cloud platform.
You should not configure enterprise application authentication via OpenID Connect and OAuth. Microsoft Entra enterprise application is a service provided by Microsoft Azure that allows you to integrate and manage external applications within your Microsoft Entra tenant. It enables you to control user access, apply security policies, and manage single sign-on (SSO) for a wide range of applications. By configuring Microsoft Entra enterprise application authentication via OpenID Connect and OAuth, you establish a secure and standardized method for users to authenticate with applications integrated with Microsoft Entra ID. However, configuring Microsoft Entra enterprise application authentication and authorization mechanisms is not a prerequisite for setting up Microsoft Defender for Cloud for Azure DevOps.

You should not configure the Azure DevOps service connection. By creating an Azure DevOps service connection, you can establish a secure and authenticated link between Azure DevOps and external services, such as GitHub or Bitbucket, to securely communicate and integrate with external services or platforms. It acts as a bridge between Azure DevOps and the external service, enabling various interactions and operations, such as accessing source code repositories, integrating with build and release pipelines, managing and publishing packages or artifacts. Azure DevOps service connections enable integration with external services, but they are not a requirement for activating or utilizing Microsoft Defender for Cloud within Azure DevOps.

---

### References

[Quickstart: Connect your Azure DevOps Environment to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-devops)  

[What is application management in Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/what-is-application-management)  

[Manage service connections](https://learn.microsoft.com/en-us/azure/devops/pipelines/library/service-endpoints?view=azure-devops&tabs=yaml)  

---

## Q061:

You have an Azure subscription that uses Microsoft Defender for Cloud.
You have two on-premises virtual machines as follows:

VM1 : Windows Server 2019
VM2 : Linux

You need Microsoft Defender for Cloud to monitor the security posture for VM1 and VM2.

What should you do?

Choose the correct answer

- Install Azure Connected Machine agent on VM1 and Azure Monitor Agent on VM2.
- Install Azure Monitor Agent on VM1 and VM2.
- Install Azure Connected Machine agent on VM1 and VM2.
- Install Azure Monitor Agent on VM1 and Azure Connected Machine agent on VM2.

---

### Answer:

You should install Azure Connected Machine agent on VM1 and VM2. It is recommended that you use Azure Arc enabled servers to add your non-Azure machines to Defender for Cloud. Installing the Azure Connected Machine agent on VM1 and VM2 will enable you to manage your Windows and Linux machines hosted outside of Azure on your corporate network or other cloud providers, to deploy and manage extensions on those machines, and you can also use Azure Policy to enforce policies on them.

You should not install Azure Connected Machine agent on VM1 and Azure Monitor Agent on VM2. In such a case, you will be able to add VM1 to Defender for Cloud via the Azure portal with all advantages described above, but you will not be able to do so for VM2. Azure Arc enabled servers is the preferred way of adding your non-Azure machines to Defender for Cloud. You can install Azure Monitor Agent on a Windows or a Linux VM to collect data and send them to Azure Monitor. The Azure Monitor Agent can collect data such as system performance metrics, event logs, and custom logs. It also allows you to run queries and create custom alerts based on the data collected, but you will not be able to enforce protection using Microsoft Defender for Cloud as requested in this scenario.

You should not install Azure Monitor Agent on VM1 and VM2. You can install Azure Monitor Agent on a Windows or a Linux VM and it is used to pro-actively monitor the OS and workloads running on those VMs. However, it will not enable you to monitor VM1 and VM2 via Defender for Cloud.
You should not install Azure Monitor Agent on VM1 and Azure Connected Machine agent on VM2. In such a case, you will be able to add VM2 to Defender for Cloud via the Azure portal, but you will not be able to do so for VM1. Azure Arc enabled servers is the preferred way of adding your non-Azure machines to Defender
for Cloud.

---

### References

[Connect non-Azure resources to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/training/modules/connect-non-azure-machines-to-azure-defender/)  

[Connect non-Azure machines](https://learn.microsoft.com/en-us/training/modules/connect-non-azure-machines-to-azure-defender/3-connect-non-azure-machines)  

[Overview of Azure Connected Machine agent](https://learn.microsoft.com/en-us/azure/azure-arc/servers/agent-overview)    

[Azure Monitor Agent overview](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-overview) 

---

## Q060:

One of the employees at your company runs an executable that is attached to an email and which steals the employee's credentials. Your manager requests a solution that responds to such threats.
You need to recommend a solution that fulfills the manager's request.

What solution should you recommend?

Choose the correct answer

- Azure Lighthouse
- Data Retention
- Microsoft Graph
- Microsoft Defender for Office 365

---

### Answer:
- Microsoft Defender for Office 365


You should recommend Microsoft Defender for Office 365. One of the features available within the Microsoft Defender for Office 365 suite is Safe Attachments, which adds an extra layer of protection for email attachments that have been scanned already by the anti-malware feature of Exchange Online Protection (EOP), Safe Attachments utilizes a virtual environment to check email attachments before the email is delivered to the final recipient. This process is better known as 'detonation'. Safe Attachment protection is configured and controlled via policies.

You should not recommend Azure Lighthouse. Azure Lighthouse is a solution that provides centralized control plane for service providers and large enterprises to manage the environments of multiple customers or individual subsidiaries efficiently and effectively, all at once.

You should not recommend Data Retention. Data retention refers to the process of storing and maintaining data for a specified period of time, often for legal or regulatory compliance purposes. This can include data such as emails, documents, customer information, financial records, and other types of information that an organization needs to keep for a certain amount of time. It cannot be used in constraining suspicious software behavior or to block executable content included in emails received by users.

You should not recommend Microsoft Graph. Microsoft Graph is a RESTful web API developed by Microsoft that provides a unified programmability model for accessing data and intelligence across the Microsoft 365 suite of services, including Office 365, SharePoint, OneDrive, Microsoft Entra ID, and more. It enables developers to build intelligent and contextual applications that integrate with Microsoft 365 data and services.

---

### References

[Safe Attachments in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about?view=o365-worldwide)  

[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  

[What is Microsoft Sentinel?](https://learn.microsoft.com/en-us/azure/sentinel/overview?tabs=azure-portal)  


[Application Insights overview](https://learn.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview)  

[What is Azure Lighthouse?](https://learn.microsoft.com/en-us/azure/lighthouse/overview)  

---

## Q059:

You are using Microsoft Defender for Cloud to secure a multi-cloud environment.
You are preparing your Google cloud environment in order to allow Google Cloud Platform (GCP) security data to flow to Microsoft Defender for Cloud.
You need to enable the GCP Security Command Center API to facilitate this transfer of data to Microsoft Defender for Cloud.
Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions:

From the Microsoft Defender for Cloud menu, select Cloud connectors.
Select Add GCP account.

Actions in order:

1. From Google's Cloud Console API Library, select each project in the organization you want to connect.
2. In the API Library, find and select Security Command Center API.
3. On the API's page, select ENABLE.

---

### Answer:

You should perform the following steps in order:

1. From the Google's Cloud Console API Library, select each project in the organization you want to connect
2. In the API Library, find and select Security Command Center API
3. On the API's page, select ENABLE

First, you should select each project in the organization you want to connect from the Google's Cloud Console API Library. This will allow you to scope the communication to only the projects you desire. Then, you will select the exact API needed.
Next, you should select Security Command Center API in the API library. 

This is important as you are selecting the specific API you need to facilitate communication between the Security Command Center and Microsoft Defender for Cloud.
Finally, you should select ENABLE on the API's page. This step is important because it saves and enacts the settings you configured in the previous steps.

You should not select Cloud connectors from the Microsoft Defender for Cloud menu. You are only required to enable the GCP Security Command Center API. Cloud connectors is where you would go to actually connect GCP to Microsoft Defender for Cloud.

You should not select Add GCP account. You would take this action in the Microsoft Defender for Cloud environment when selecting accounts to see in Microsoft Defender for Cloud. Although enabling the API facilitates this flow of data, it is a separate process from the workflow relevant to this scenario.

---

### References

[Connect your GCP project to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-gcp)  

[Security Command Center API](https://cloud.google.com/security-command-center/docs/reference/rest/)  


---

## Q058:

You are using Microsoft Defender for Cloud in a multi-cloud environment.
You are in the initial stages of connecting your Amazon Web Services (AWS) account to Microsoft Defender for Cloud.
You need to set up the connection to AWS Security Hub and view security recommendations across multiple regions in Microsoft Defender for Cloud as a single pane of glass.
Which three actions should you perform for each relevant region in sequence? 

To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions:

Complete Azure Arc prerequisites.
Configure the AWS Systems Manager (SSM) Agent.

Actions in order:

1. Enable AWS Config.
2. Enable AWS Security Hub.
3. Verify that there is data flowing to the Security Hub.

---

### Answer:

You should perform the following steps in order:

1. Enable AWS Config.
2. Enable AWS Security Hub.
3. Verify that there is data flowing to the Security Hub.

There are two ways to connect Amazon Web Services (AWS) to Microsoft Defender for Cloud: Classic or Native. The Native integration provides a more streamlined and comprehensive solution for connecting AWS to Microsoft Defender for Cloud without the need for additional licensing. In this scenario, you are required to set up the connection to AWS Security Hub, therefore, you have to use the classic integration option, which requires to enable AWS Config in the first step. AWS Config is a tool used to provide an inventory of AWS resources.

Next, you should enable AWS Security Hub. As that name implies, AWS Security Hub is the AWS equivalent. to Microsoft Defender for Cloud. It is used to ensure security alerting and event data is being produced on the AWS side.

Finally, after setting these components up, the next step is to verify 
the flow of data to the Security Hub. This last step can take as long as several hours. This step is necessary as you will need to go back to the previous AWS steps and ensure proper configuration if data is not flowing.

You should not complete Azure Arc prerequisites. Azure Arc is used to get AWS resources into Azure, so this is a related process, but it is not part of the workflow to set up AWS Security Hub.

You should not configure the AWS Systems Manager (SSM) Agent. This agent is used for the automation of tasks across AWS resources. The setup of this agent may be part of the full configuration of a multi-cloud environment, but it is not a part of setting up AWS Security Hub.

---

### References

[Connect your AWS account to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-aws)  

[Setting Up AWS Config with the Console](https://docs.aws.amazon.com/config/latest/developerguide/gs-console.html)   

[Enabling Security Hub](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-settingup.html)  

---

## Q057:

You are using Microsoft Defender for Cloud to protect your cloud environment and Azure Monitor to collect data from your virtual machines (VMs).
You are not receiving data from the Azure Monitor agent on one of your VMs. You determine that this is related to the local firewall on the VM.
You need to allow communication with the required HTTPS endpoints for the Azure Monitor agent, while keeping the rules as specific as possible.
Which three HTTPS endpoints should you allow via the local firewall? Each correct answer presents part of the solution.

Choose the correct answers

- *.monitor.azure.com
- management.azure.com
- *.handler.control.monitor.azure.com
- *.ods.opinsights.azure.com
- *.opinsights.azure.com
- *.azure.com

---

### Answer:
- management.azure.com
- *.handler.control.monitor.azure.com
- *.ods.opinsights.azure.com

Note that the asterisk is a wildcard and thus you are allowing HTTPS (port 443) communication with any endpoint that ends in those domain/subdomain strings. The agent needs to communicate to these endpoints to function properly, and while this usually is not an issue on a common outgoing port like 443, a heavily locked down VM could cause issues by blocking communication to these endpoints. Although Microsoft requires these specific endpoints to be allowed for proper communication, it does not offer an explanation to the purpose of each individual endpoint. Instead, it simply states that communication with these endpoints is a prerequisite to the installation of an Azure Monitor agent.

You should not allow * opinsights.azure.com. Although this would technically include the *.ods.opinsights.azure.com range of endpoints, remember that the scenario asks for the most narrow/specific firewall entries possible. This is important because otherwise you would be allowing communication with endpoints that you do not need to communicate with. For example, the *.opinsights.azure.com exclusion would include subdomains beyond the ods subdomain that is required. Although this is unlikely to cause issues, it does open up a path to endpoints that you do not absolutely need to be communicating with. Following the principle of minimizing unnecessary communication is one way to ensure maximized system hardening, a term that refers to the most secure configuration of a system possible.

You should not allow monitor.azure.com. Although this would technically include *.control.monitor.azure.com range of endpoints, the scenario asks for the most narrow/specific firewall entries possible. The monitor.azure.com exclusion would include subdomains beyond the control subdomain that are required. Again, you would be allowing communication with endpoints that you do not need to communicate with.
You should not allow *.azure.com. This is far too broad of an exclusion as it would include all possible subdomains under the azure.com domain. Although this allow rule would include all of the options needed, it is the broadest allow exclusion that you could use while still allowing the agent to communicate as needed. Again, with this option, you would be allowing communication with endpoints that you do not need
to communicate with.

---

### References

[Manage Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal)  

[Azure Monitor agent on Windows client devices](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-windows-client)  

[Define Azure Monitor Agent network settings](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-network-configuration?tabs=PowerShellWindows)  

---

## Q056:

You are defending your hybrid cloud environment with Microsoft Defender for Cloud.
After initially enabling the solution, you have decided to manually roll out the Azure Monitor Agent to several virtual machines for testing. You used PowerShell for this process.
You need to use PowerShell to check the status of the Azure Monitor agent deployment on a specific virtual machine.

What command should you run to gather this information?

Choose the correct answer

`Get-AzVMExtension -ResourceGroupName myResourceGroup -VMName myVM -Name myExtensionName`

`Set-AzVMExtension -ResourceGroupName myResource Group -VMName myVM -Name myExtensionName`

`Get-AzVMExtension -ResourceGroupName myResourceGroup -Name myExtensionName`

`Set-AzVMExtension -ResourceGroupName myResourceGroup -Name myExtensionName`

---

### Answer:

You should run the command:

`Get-AzVMExtension -ResourceGroupName my Resource Group -VMName myVM -Name my ExtensionName` 

 This command will allow you to retrieve the Azure Monitor agent deployment status (Get-AzVMExtension), specify the resource group and name of the virtual machine you are looking for (-ResourceGroupName my Resource Group -VMName myVM), and indicate the individual extension that you want to check (-Name myExtensionName). This command should be run using the Azure PowerShell Module. It is important to note that this information could also be retrieved from the Azure portal. However, in this scenario, it is specifically requested to use PowerShell. Also, it is key to notice that while the question scenario states that the Azure Monitor agent has been manually deployed to several virtual machines, you only want to check the status of the deployment on one specific virtual machine. This is the reason for using the -VMName myVM portion of the command.

You should not run the Set-AzVMExtension -ResourceGroupName myResource Group -VMName myVM - Name myExtensionName command. By using Set instead of Get, this command is actually the PowerShell command used to deploy the agent. The question scenario states that this has been done already. Note that manual deployment of the Azure Monitor agent is the default option for deployment, but auto provisioning can be used as well.
You should not run the Get-AzVMExtension -ResourceGroupName my ResourceGroup -Name myExtensionName command. While this command correctly uses Get, it does not specify the individual virtual machine you are looking for. This might be an option you would consider if you wanted to check the deployment status of the agent to that resource group, but not for an individual virtual system.
You should not run the Set-AzVMExtension -ResourceGroupName myResource Group -Name myExtensionName command. It uses the incorrect Set option, and it is not scoped to an individual virtual machine, but rather to a resource group.

---

### References

[Azure Monitor Agent overview](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-overview)  

[Manage Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal)  


---

## Q055:

You are working in a hybrid cloud environment and you use Microsoft Defender for Cloud protection.
You have several other servers in both Amazon Web Services (AWS) and 

Google Cloud Platform (GCP,) and you would like to extend Microsoft Defender for Cloud security to those virtual machines, several of which are SQL (Structured Query Language) servers.

You need to determine how you can turn these servers into Azure resources and cause them to be displayed in the Microsoft Defender for Cloud portal.
Which two steps should you take to meet the requirement? Each correct answer presents part of the solution.

Choose the correct answers

- Use Azure Arc on the servers..
- Install the Azure Monitor Agent on the servers.
- Use Azure Migrate on the servers.
- Deploy Azure SQL Edge.

---

### Answer:
- Use Azure Arc on the servers..
- Install the Azure Monitor Agent on the servers.

You should use Azure Arc on the servers and install the Azure Monitor Agent on the servers. Using Azure Arc on the servers will turn them into Azure assets, and installing the Azure Monitor Agent will cause them to be displayed in the Microsoft Defender for Cloud portal. Azure Arc allows you to manage resources hosted outside of Azure. It provides this service by acting as a medium for communication with agents on non-Azure resources. The Azure Monitor Agent is one of these agents that can provide the data. It collects data from machines, including both Windows and Linux boxes. These machines can be in any cloud or they can be on premises. It is important to note that there are other ways of connecting non-Azure resources, SO this process of using Azure Arc and the Azure Monitor Agent is just the recommended best practice, it is not the only option.

You should not use Azure Migrate on the servers. Although Azure Migrate might sound like a good solution in a multi-cloud environment, it is actually related to moving resources from on-premises environments to the Azure cloud. This option would not turn the servers into Azure assets or make them be displayed in the Microsoft Defender for Cloud portal.
You should not deploy Azure SQL Edge. Azure SQL Edge is an Azure solution for loT/edge deployments of SQL databases. Deploying it would not turn the servers into Azure asset or cause them to appear in the Microsoft Defender for Cloud portal.

---

### References

[Azure Arc overview](https://learn.microsoft.com/en-us/azure/azure-arc/overview)  

[Connect your non-Azure machines to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines?pivots=azure-arc)  

[What is Azure SQL Edge?](https://learn.microsoft.com/en-us/azure/azure-sql-edge/overview)  

---

## Q054:

You are using Microsoft Defender for Office 365 to protect SharePoint, OneDrive, and Microsoft Teams.
Your company has seen an increase in attempts to deliver malicious content through these applications.
You need to turn on Safe Attachments for SharePoint, OneDrive, and Microsoft Teams and ensure that users are not able to download any malicious content to their systems.

Which two PowerShell commands should you run to accomplish these requirements? 
Each correct answer presents part of the solution.

Choose the correct answers

- Using the SharePoint Online PowerShell module, run Set-AtpPolicyForO365 EnableATPForSPOTeamsODB $true.

- Using the Exchange Online PowerShell module, run Set-SPOTenant - DisallowinfectedFile Download $true.

- Using the SharePoint Online PowerShell module, run Get-SPOTenant - DisallowInfectedFile Download $true.

- Using the Exchange Online PowerShell module, run Get-AtpPolicyForO365 - EnableATPForSPOTeamsODB $true.

- Using the Exchange Online PowerShell module, run Set-AtpPolicyForO365 - EnableATPForSPOTeamsODB $true.

- Using the SharePoint Online PowerShell module, run Set-SPOTenant - DisallowInfectedFile Download $true.

---

### Answer:

- Using the Exchange Online PowerShell module, run Set-AtpPolicyForO365 - EnableATPForSPOTeamsODB $true.

- Using the SharePoint Online PowerShell module, run Set-SPOTenant - DisallowInfectedFile Download $true.

You should run Set-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true using the Exchange Online PowerShell module and run Set-SPOTenant-DisallowInfectedFileDownload $true using the SharePoint Online PowerShell module. The first key to solving this problem is understanding which PowerShell module to use/connect to for each command. To turn on Safe Attachments for these applications (SharePoint, OneDrive, and Teams) you must first connect to the Exchange Online PowerShell module. This is where you are able to run the Set-AtpPolicyForO365 command and you will use -EnableATPForSPOTeams ODB $true to activate it for the selected applications.
To disallow the downloading of malicious content/attachments, you must first connect to the SharePoint Online PowerShell module. Here, you run the Set-SPOTenant command and use DisallowInfectedFileDownload Strue to activate this feature. Note that your users can still delete any malicious files, this only removes their ability to download them (for both regular users and administrators).
You should not run Set-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true using the SharePoint Online PowerShell module. To enable Safe Attachments, you need to use the Exchange Online PowerShell module.
You should not run Set-SPOTenant -DisallowinfectedFile Download $true using the Exchange Online PowerShell module. To block the downloading of malicious content/attachments, you need to use the SharePoint Online PowerShell module.
You should not run Get-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true or Get-SPOTenant - DisallowInfectedFile Download $true. Note that these two options are using Get instead of Set in the command. Get will retrieve the current settings for the command, while Set will set/alter the settings, as required in this scenario.

---

### References

[Turn on Safe Attachments for SharePoint, OneDrive, and Microsoft Teams](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-for-spo-odfb-teams-configure)  

[Safe Attachments in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about)  

[Microsoft Defender for Office 365 overview](https://learn.microsoft.com/en-us/defender-office-365/mdo-about)  

---

## Q053:

You are using Microsoft Defender for Office 365. In order to protect against malware, you decide to implement Safe Attachments. Initially, you want to simply track the results of this policy and not interfere with the delivery of attachments.
You need to create a Safe Attachments policy that fulfills the tracking requirement and sends potentially malicious attachments to an admin's email address for review.
Which three configurations should you implement to create the policy? Each correct answer presents part of the solution.

Choose the correct answers

- Select the Block option.
- Select the Dynamic Delivery option.
- Click the Add condition button.
- Enter the admin's email address.
- Click the Enable redirect checkbox.
- Select the Monitor option.

---

### Answer:

- Enter the admin's email address.
- Click the Enable redirect checkbox.
- Select the Monitor option.

To create the policy, you should select the Monitor option, click the Enable redirect checkbox, and add the admin's email address. This Safe Attachments policy ultimately needs to fulfill two requirements: monitoring without blocking attachments and delivering the suspected malicious attachment to a user of your choice (typically an admin). To track the results of the policy, you need to select the Monitor option. When enabled, the Monitor option will passively document its findings, without taking any action that could interfere with email attachments. In order to send potentially malicious attachments to an admin for review, you need to both enable the redirect feature and add the admin's email address. This is a logical fit with the monitor mode, as it will allow the indicated security professional to review the attachment in question and intervene if it is in fact malicious.
You should not select the Block option. This option has the potential to interfere with the delivery of attachments. While that can be a desired outcome, especially when the attachments are malicious, it does not meet the requirements of the scenario. Specifically, this option would block both emails and attachments with detected malware involved. This may be an option your company considers after spending some time in the monitor mode if you decide you want a Safe Attachments policy to be more proactive and secure at the cost of interfering with attachment delivery.
You should not select the Dynamic Delivery option. The requirement to not interfere with the delivery of attachments once again rules out this choice. Dynamic Delivery allows for a message to be delivered while the attachment is assessed by Microsoft Defender for Office 365. If the attachment is found to be clean, it will be reattached afterwards. If the attachment is not found to be clean, both the message and the attachment will be quarantined. In other words, in addition to never receiving the malicious attachment, the user will also have the message removed from their inbox. The only other options are Replace and Off, which will replace the attachment and turn off scanning respectively.
You should not click the Add condition button. The Add condition button is only used if you are targeting the policy. Targeting the policy allows you to narrow the focus of the individuals or groups that your policy will impact. For example, you could make the policy only apply to users in your IT department group while testing a policy, before going company-wide with the change. Even though this option is part of policy creation, the given scenario does not deal with targeting the policy.

---

### References

[Configure, protect, and detect](https://learn.microsoft.com/en-us/training/modules/m365-threat-remediate/configure-protect-detect)  

[Safe Attachments in Microsoft Defender for Office 365.](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about)    

[Microsoft Defender for Office 365 overview](https://learn.microsoft.com/en-us/defender-office-365/mdo-about)    

---

## Q052:

Your manager has resources in Google Cloud and Azure.
They ask you to connect them with each other. You are connecting the data in Google Cloud Platform (GCP) to Microsoft Defender for Cloud using classic cloud connector. You have already configured the GCP Security Command Center, enabled Security Health Analytics, and enabled the GCP Security Command Center API.
You need to perform the two remaining steps that will allow you to connect the data.
What two actions should you perform to meet the requirement? Each correct answer presents part of the solution.

Choose the correct answers

- Add Cloud Connectors from Microsoft Defender for Cloud.
- Create a dedicated service account and a private key.
- Generate an installation script.
- Register Azure resource providers.

---

### Answer:
- Add Cloud Connectors from Microsoft Defender for Cloud.
- Create a dedicated service account and a private key.

You should create a dedicated service account and a private key. There are two ways to connect Google Cloud Platform (GCP) to Microsoft Defender for Cloud: Classic or Native. Although the Native integration provides a more streamlined and comprehensive solution for connecting GCP to Microsoft Defender for Cloud without the need for additional licensing or setup, if you have already invested in Security Command Center premium service tier, the classic integration may still be a viable option. As in this scenario classic integration is used, the next step is performed on the Google Cloud Platform (GCP) console. It will allow you to select the project you want to connect to Microsoft Defender for Cloud, where you create a service account and then add a private key for the dedicated service account. This step is one of the last two steps to execute in order to complete the process of connecting the resources of GCP to Azure using classic integration. A service account needs a private key to provide encryption between GCP and Microsoft Defender for Cloud when it is downloaded as a JSON file.
You should also add Cloud Connectors from Microsoft Defender for Cloud. This step, completed on the Microsoft Defender for Cloud page, allows you to add the GCP account you want to connect Azure to. 

You should do this after creating a dedicated service account and a private key. This step is one of the final steps when connecting the resources. After performing these two steps, you will be able to connect the data in Google Cloud Platform (GCP) to Microsoft Defender for Cloud.

You should not register Azure resource providers. This action is included in the process of connecting hybrid machines with Azure Arc-enabled servers. Azure Arc-enabled servers require specific Azure resource providers, like Microsoft. HybridCompute and Microsoft. GuestConfiguration, to be enabled before users can use them.

You should not generate an installation script. This action is also part of the process of connecting hybrid machines with Azure Arc-enabled servers or GCP native integration into Microsoft Defender for Cloud. This does not meet the scenario's requirement.

---

### References

[Connect your GCP project to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-gcp)  

[Security Command Center overview](https://cloud.google.com/security-command-center/docs/concepts-security-command-center-overview)  

[Quickstart: Connect hybrid machines with Azure Arc-enabled servers](https://learn.microsoft.com/en-us/azure/azure-arc/servers/learn/quick-enable-hybrid-vm)  

[Azure resource providers and types](https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/resource-providers-and-types)  

---

## Q051:

Programmers at your company create a web application based on buying and selling products. Your manager wants the web application to be protected against malicious attacks.

You need to recommend a solution that protects the web application.

Which solution should you recommend?

Choose the correct answer

- Sensitivity labels
- Detection rules
- Microsoft Defender for Cloud
- Data Loss Prevention policies

---

### Answer:
- Microsoft Defender for Cloud

You should recommend Microsoft Defender for Cloud. Microsoft Defender for Cloud is a Microsoft's cloud workload protection feature, and it provides cloud security posture management and cloud workload protection. It is used to protect SQL databases, virtual machines, and web applications from malicious attacks.

You should not recommend Data Loss Prevention (DLP) policies. DLP policies are a solution that can prevent the accidental sharing of sensitive information with people outside an organization, but they cannot protect web applications from malicious attacks.
You should not recommend detection rules. Detection rules are used in companies to monitor misconfigured endpoints and suspected breaches, but they do not protect web applications as required. To create a detection rule, you need to be a Security Operator or a Security Administrator.
You should not recommend sensitivity labels. Sensitivity labels allow you to protect and classify the company's data while making sure that employees can effectively collaborate. When a sensitivity label is applied to content, it can restrict access to content by adding a mark to a specific document, such as watermarks applied on documents, or by using encryption. This solution cannot protect web applications from malicious attacks.

---

### References

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[Attack surface reduction rules overview](https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction?view=o365-worldwide)    

[Get started with the data loss prevention alerts](https://learn.microsoft.com/en-us/purview/dlp-alerts-get-started?view=o365-worldwide)  

[Create and manage custom detections rules](https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules?view=o365-worldwide)  

---

## Q050:

You implement an additional layer of security for your company's emails using Safe Attachments policies.
Employees in the accounting team report that they are having a problem with emails from customers, including attachments being delayed.
You need to configure the settings in Safe Attachments in order for the emails to be received directly, without compromising the security of your company.

Which option should you configure in the Safe Attachments settings?

Choose the correct answer

- Monitor
- Dynamic Delivery
- Off
- Block

---

### Answer:
- Dynamic Delivery

You should configure the Dynamic Delivery option. This option will allow you to cancel the delay of messages while protecting the employees in the accounting team from malicious files. Safe Attachments is a Microsoft Defender for Office 365 feature that is used to check the attachments found in emails before receiving them. This feature will cause a delay in receiving the email since it takes time to scan the attachments. Configuring Dynamic Delivery allows the immediate delivery of messages containing attachments by replacing the attachments in emails with placeholders until the scanning of all files included in an email is completed.
You should not configure the Off option. Configuring this option will allow you to avoid the scanning of files included in emails through Safe Attachments. This will avoid delays, but it may lead to compromising the security of the company. This option should be used only when receiving emails from trusted senders.
You should not configure the Block option. This option prevents the delivery of emails containing malware, with messages being quarantined for administrators only to manage them. This option will not prevent messages from being delayed.
You should not configure the Monitor option. This option allows you to track the path of detected malware
in your company and causes a delay when receiving messages until the scanning of Safe Attachments is complete.

---

### References

[Safe Attachments in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about)  

[Microsoft Defender for Office 365 overview](https://learn.microsoft.com/en-us/defender-office-365/mdo-about)  

---

## Q049:

Your custom application, App1, generates custom log data to text files. You are requested to ingest these data into the Microsoft Sentinel Log Analytics workspace for further analysis.
To prepare your Microsoft Sentinel Log Analytics workspace to store the log data, you need to create a custom table in the Log Analytics workspace first.
What file format, along with at least one sample record, should you use to create your custom table?

Choose the correct answer

- TXT
- XML
- CSV
- JSON

---

### Answer:
- JSON

You should use the JSON file format. JSON (JavaScript Object Notation) is a lightweight data-interchange format that is easy for humans to read and write and easy for machines to parse and generate. It is commonly used for structuring data in log files due to its simplicity and flexibility. To create a custom table in the Microsoft Sentinel Log Analytics workspace, you need to provide a JSON file with at least one sample record.
You should not use the CSV file format. CSV (Comma-Separated Values) is a simple file format used to store tabular data, such as a spreadsheet or database. Each line in a CSV file represents a record, and each field in the record is separated by a comma. This file format is not suitable for custom table creation in the Microsoft Sentinel Log Analytics workspace according to Microsoft's design.
You should not use the XML file format. XML (eXtensible Markup Language) is a markup language that defines a set of rules for encoding documents in a format that is both human-readable and machine- readable. While XML can be used to structure log data, it is less common in log files compared to JSON or CSV. This file format is not suitable for custom table creation in the Microsoft Sentinel Log Analytics workspace according to Microsoft's design.
You should not use the TXT file format. TXT (plain text) files contain unformatted text and do not have a specific structure like JSON, CSV, or XML. While it is possible to store log data in TXT files, it is not suitable for custom table creation in the Microsoft Sentinel Log Analytics workspace according to Microsoft's design.

---

### References

[Add or delete tables and columns in Azure Monitor Logs](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/create-custom-table?tabs=azure-portal-1%2Cazure-portal-2%2Cazure-portal-3)  
[Collect data in custom log formats to Microsoft Sentinel with the Log Analytics agent](https://learn.microsoft.com/en-us/azure/sentinel/connect-custom-logs?tabs=DCG)  

---

## Q048:

You are managing Linux servers both on-premises and in Microsoft Azure cloud. To prepare for incident response, you plan to collect Common Event Format (CEF) logs in Microsoft Sentinel Log Analytics.
You first need to identify components of the data ingestion process using the Azure Monitor Agent.
Which component should you identify in each scenario? To answer, select the appropriate options from the drop-down menus.

Choose the correct options

CEF logs generation : Log source
CEF logs transformation : Log forwarder
CEF logs storage : Log analytics

---

### Answer:

Systems with installed Linux operating system (OS) transmit their system logs using the Syslog protocol, which employs a specialized format called the Common Event Format (CEF). This format provides a more comprehensive set of data than the conventional Syslog format and organizes the information in a parsed key-value format. The Azure Monitor Agent (a sub-component of CEF Log forwarder) is designed to receive CEF logs, reformat them specifically for integration with Microsoft Sentinel, and then transmit them to your Microsoft Sentinel workspace.
In this scenario, the CEF log source is Linux VMs that generate CEF logs in response to specific operating system or application activities or conditions.
The CEF Log forwarder receives logs from the CEF log source, transforms, and forwards them to a central location. In this scenario, the central location is the Microsoft Sentinel (Log Analytics) workspace.
The Microsoft Sentinel (Log Analytics) workspace serves as a central location where logs are collected and analyzed for security-related events and incident response.


---

### References

[Ingest Syslog and CEF messages to Microsoft Sentinel with the Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/sentinel/connect-cef-syslog-ama?tabs=portal)  

[Best Practices for Common Event Format (CEF) collection in Azure Sentinel](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/best-practices-for-common-event-format-cef-collection-in-azure/ba-p/969990)

[Get CEF-formatted logs from your device or appliance into Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-common-event-format)  

---

## Q047:

Your organization uses Microsoft Sentinel.
To enhance cyber attack prevention, you are tasked with gathering indicators of compromise (IOC) from different threat intelligence platform (TIP) solutions and add them to your Microsoft Sentinel instance. You decided to implement Threat Intelligence Upload Indicators API data connector.
You need to identify the configuration values required by the Threat Intelligence Upload Indicators API of your integrated TIP or custom solution.

Which three configuration values should you identify? 
Each correct answer presents part of the solution.

Choose the correct answers

- Object ID
- Client secret
- Microsoft Sentinel workspace ID
- Directory (tenant) ID
- Application (client) ID

---

### Answer:
- Microsoft Sentinel workspace ID
- Client secret
- Application (client) ID

The configuration values required by the Threat Intelligence Upload Indicators API of your integrated TIP or custom solution are:

- Application (client) ID: This is a unique identifier for your application or client within Microsoft Entra ID. It is used to authenticate your application when accessing Microsoft Sentinel.

- Client secret: This is a string (sometimes called application password) that is used to authenticate your application when accessing Microsoft Sentinel. It should be kept confidential and not shared with anyone. 

- Microsoft Sentinel workspace ID: This is the unique identifier for your Microsoft Sentinel workspace. It is used to specify the target workspace where the indicators of compromise (IOCs) will be uploaded.

The two other configuration values are also important for authentication and access control purposes, but they are not directly related to the integration of the Threat Intelligence Upload Indicators API with Microsoft Sentinel:

- Directory (tenant) ID: This is the unique identifier for your Microsoft Entra tenant. It is used to specify the Microsoft Entra tenant associated with your Microsoft Sentinel workspace.

- Object ID: This is the unique identifier for the object (such as a user, group, or service principal) within your Microsoft Entra tenant. It is used to specify the object that has permissions to access and upload indicators of compromise (IOCs) to Microsoft Sentinel.

---

### References

[Connect your threat intelligence platform to Microsoft Sentinel with the upload indicators API](https://learn.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence-upload-api)   

[Understand threat intelligence in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/understand-threat-intelligence)  

[Reference the upload indicators API (Preview) to import threat intelligence to Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/upload-indicators-api)    

---

## Q046:

Your organization has configured bidirectional synchronization between Microsoft Sentinel and Microsoft Defender XDR. Your Security Operation Center (SOC) team complains about duplicate incidents for the same alerts.
You need to ensure that the alerts are not duplicated.
Which four actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.

Create a list in the correct order

Possible actions
Install the Microsoft Defender XDR solution for Microsoft Sentinel
Uninstall the Microsoft Defender XDR solution for Microsoft Sentinel

Actions in order

1. Navigate to the Microsoft Defender XDR connector page.
2. In the configuration section, select the Disconnect button.
3. Mark the Turn off all Microsoft incident creation rules for these products. Recommended check box.
4. In the configuration section, select the Connect incidents & alerts button.

---

### Answer:

You should perform the following tasks in order:

1. Navigate to the Microsoft Defender XDR connector page.
2. In the configuration section, select the Disconnect button.
3. Mark the Turn off all Microsoft incident creation rules for these products. Recommended check box.
4. In the configuration section, select the Connect incidents & alerts button.

First, you need to navigate to the Microsoft Defender XDR connector page. You can do it in Microsoft Sentinel by selecting Data connectors, Microsoft Defender XDR, and Open connector page.
Next, in the configuration section, select the Disconnect button. By doing this, you can fade in the check box again, which disappears once the Microsoft Defender XDR connector is connected.  

After that, you have to Turn off all Microsoft incident creation rules for these products. Recommended. option by marking the corresponding check box.
Finally, in the configuration section, select the Connect incidents & alerts button.
Incidents triggered by Microsoft Defender XDR are generated using unique Microsoft Defender XDR logic. In parallel, Microsoft Sentinel incident-creation rules also generate incidents from these alerts, utilizing a distinct Microsoft Sentinel logic. Although utilizing both mechanisms simultaneously is fully supported, this approach will result in duplicate incidents for the same alerts. To avoid this, Microsoft recommends turning off all Microsoft incident creation rules for Microsoft Defender XDR-integrated products.
You should not install the Microsoft Defender XDR solution for Microsoft Sentinel. In this scenario, bidirectional synchronization between Microsoft Sentinel and Microsoft Defender XDR has already been configured. Therefore, it is assumed that the Microsoft Defender XDR solution has already been installed.
You should not uninstall the Microsoft Defender XDR solution for Microsoft Sentinel. There is no need to uninstall the solution to disable all Microsoft incident creation rules. According to Microsoft's design, the check box disappears once the Microsoft Defender XDR connector is connected.

---

### References

[Connect data from Microsoft Defender XDR to Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)  

[Microsoft Defender XDR Integration with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration?tabs=azure-portal)  

---

## Q045:

You are administering Microsoft Azure cloud in your organization.
Your assigned custom role provides you with read and write permissions on your Microsoft Sentinel workspace. You are requested to configure bi-directional alert synchronization between Microsoft Sentinel and Microsoft Defender for Cloud.
In Microsoft Sentinel, you navigate to the connector page of Subscription-based Microsoft Defender for Cloud (Legacy), select the requested subscription, and try to connect Subscription-based Microsoft Defender for Cloud (Legacy) to Microsoft Sentinel, You receive the following error message: Failed to connect, access denied.

What two roles could you request to perform the task? Each correct answer presents a complete solution.

Choose the correct answers

- Contributor role on the subscription
- Security Admin role on the subscription
- Microsoft Sentinel Contributor
- Contributor on the resource group
- Log Analytics Contributor

---

### Answer:
- Contributor role on the subscription
- Security Admin role on the subscription

You should request either the Contributor role or the Security Admin role on the subscription. The Subscription-based Microsoft Defender for Cloud (Legacy) connector facilitates the ingestion of security alerts from Microsoft Defender for Cloud into Microsoft Sentinel. As Microsoft Defender for Cloud Defender plans are enabled per subscription, you need to request roles on the respective subscription you want to connect to Microsoft Sentinel.
You should not request the Log Analytics Contributor role. This role is typically required when you need to grant users permissions to manage Log Analytics workspaces and related resources. This role is used to perform tasks specifically related to managing and analyzing log data within Azure Log Analytics only.
You should not request the Contributor on the Resource Group role. This role is a broader role that grants full access to all resources within that resource group only. This role is typically used when you need individuals or groups to have control over all resources within a specific resource group, regardless of their specific functionalities.

You should not request the Microsoft Sentinel Contributor role, as you have already assigned the custom role with the related permissions.

---

### References

[Ingest Microsoft Defender for Cloud alerts to Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-defender-for-cloud)  

[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)    

[Assign Azure roles using the Azure portal](https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-portal)  

---

## Q044:

You have an Azure subscription with Microsoft Sentinel activated and the UEBA feature enabled.
You need to select data sources for User and Entity Behavior Analytics.

What should you do first?

Choose the correct answer

- Connect data sources to Microsoft Defender for Identity.
- Connect data sources to Microsoft Defender for Endpoint.
- Connect data sources to Microsoft Sentinel.
- Connect data sources to Microsoft Defender for Cloud.

---

### Answer:
- Connect data sources to Microsoft Sentinel.

You should first connect the relevant data sources to Microsoft Sentinel. Microsoft Sentinel is the central platform for collecting, analyzing, and detecting security events and incidents. By connecting the necessary data sources, you allow Microsoft Sentinel to ingest the data and apply UEBA analytics to identify behavioral patterns and potential threats.
You should not connect data sources to Microsoft Defender for Cloud. Microsoft Defender for Cloud
primarily focuses on securing cloud resources, such as Azure, Microsoft 365, and other cloud services. Although it can provide valuable security insights, it is not directly related to enabling data sources for entity behavior analytics in Microsoft Sentinel.
You should not connect data sources to Microsoft Defender for Identity. Microsoft Defender for Identity is a solution specifically designed to detect and investigate advanced attacks and insider threats in on-premises Active Directory environments. Although it can provide insights into user behavior, it is not directly related to enabling data sources for UEBA in Microsoft Sentinel.
You should not connect data sources to Microsoft Defender for Endpoint. Microsoft Defender for Endpoint is focused on endpoint security and threat detection on individual devices. Although it provides valuable telemetry and security data from endpoints, it is not directly related to enabling UEBA data sources in Microsoft Sentinel.

---

### References

[Enable User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics?tabs=azure)  

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[What is Microsoft Defender for Identity?](https://learn.microsoft.com/en-us/defender-for-identity/what-is)   

[Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/microsoft-defender-endpoint)    

[Advanced threat detection with User and Entity Behavior Analytics (UEBA) in Microsoft Sentine](https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior-analytics)  

---

## Q043:

You have an Azure subscription with Microsoft Sentinel activated. You are requested to protect your on- premises Active Directory users. As part of your solution you need to collect Event Tracing for Windows (ETW) logs entries that provide the data for multiple detections. While enabling UEBA for your on-premises Active Directory, you encounter the error shown in the exhibit.
You need to troubleshoot the issue.

Which two actions should you perform? 
Each correct answer presents part of the solution.

Choose the correct answers

- Upgrade Active Directory domain controllers to the latest version.
- Install the sensor on Active Directory Domain member server.
- Onboard your Azure tenant to MDI.
- Activate a special license to add the UEBA functionality.
- Install the sensor on your Active Directory domain controller.

![image info](./Q43.PNG)

---

### Answer:
- Install the sensor on Active Directory Domain member server.
- Onboard your Azure tenant to MDI.

You should onboard your Azure tenant to Microsoft Defender for Identity (MDI) and install the MDI sensor.

User and Entity Behavior Analytics (UEBA) is a security capability that focuses on detecting and analyzing
patterns of behavior exhibited by users and entities within an organization's environment. It leverages
advanced analytics and machine learning algorithms to identify anomalies, deviations from normal behavior, and potential security threats.

The error message indicates that enabling UEBA for your on-premises Active Directory requires MDI. Onboarding your Azure tenant to MDI involves setting up and configuring MDI for your Azure tenant. This onboarding process establishes the connection between your Azure subscription and MDI, allowing you to utilize its security capabilities. Once your Azure tenant is onboarded to MDI, you need to install the MDI sensor in your on-premises Active Directory environment. The MDI sensor is responsible for collecting the necessary security-related data from your Active Directory environment and forwarding it to the MDI service for analysis.

To collect Event Tracing for Windows (ETW) logs for UEBA and other detections, you need to install the sensor on your Active Directory Domain Controllers. The sensor is a component provided by MDI that captures the required log data and forwards it to Microsoft Sentinel for analysis. Installing the sensor on the Domain Controllers ensures that the necessary logs are collected and made available for UEBA functionality.
You should not upgrade Active Directory domain controllers to the latest version. Although upgrading domain controllers may be beneficial for general security improvements, it is not a specific requirement to enable UEВА.
You should not activate a special license to add the UEBA functionality. Adding UEBA functionality to Microsoft Sentinel does not require a special license, and there is no extra cost associated with using it. However, it is important to note that UEBA generates new data and stores it in dedicated tables within your Log Analytics workspace. As a result, there may be additional data storage charges applied.
You should not install the sensor on Active Directory Domain member server. To achieve comprehensive coverage of your environment and collect Event Tracing for Windows (ETW) log entries that are crucial for multiple detections, it is important to note that Defender for Identity standalone sensors do not support this capability. To address this, Microsoft highly recommends deploying the Defender for Identity sensor on all your domain controllers. By doing so, you ensure that the necessary data is captured from all domain controllers, enabling a more comprehensive and effective detection capability.

---

### References

[Enable User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics?tabs=azure)  
[Identify advanced threats with User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior-analytics)  
[Microsoft Defender for Identity prerequisites](https://learn.microsoft.com/en-us/defender-for-identity/deploy/prerequisites)  

---

## Q042:

You have an Azure subscription that uses Microsoft Sentinel.
You are using the custom logs data source for the Azure Monitor agent in Azure Monitor to collect events from text files on a Windows virtual machine (VM).


The custom log entries are exhibited below:

```
Time=2022-07-10 01:34:36 Event Code=207 Status=Success Message=Client 06b33b79- 272a-4bc9-8f34-269d154b0e39 connected
Time=2022-07-10 01:33:33 Event Code=208 Status=Warning Message=Client ec53d95d-
1c88-41ae-8174-92104212de6d disconnected
Time=2022-07-10 01:35:44 Event Code=209 Status=Success Message=Transaction
11d43671-c0043-761c-3cab-9v56b51189c8 succeeded
Time=2022-07-10 01:38:22 Event Code=302 Status=Error Message Application could not connect to database
Time=2022-07-10 01:31:34 Event Code=303 Status=Error Message=Application lost connection to database
```

You need to identify simple text patterns in the log entries.
How should you complete the query? 
To answer, select the appropriate options from the drop-down menus.

Choose the correct options

OPT1: parse | order | scan | search 
OPT2: RawData | ManagementGroupName | SourceSystem | TimeGenerated

```
MyCustomLog_CL
| [OPT1] [OPT2] with * "Time=" EventTime Event Code=" Code " Status="status" Message=" Message 
| project EventTime, Code, Status, Message
```

```
MyCustomLog_CL
| parse RawData with * "Time=" EventTime Event Code=" Code " Status="status" Message=" Message 
| project EventTime, Code, Status, Message
```

---

### Answer:

You should complete the query as follows:

```
MyCustomLog_CL
parse RawData with Message=" Message "Time" EventTime Event Code=" Code Status" Status
| project EventTime, Code, Status, Message
```

In this scenario, you need to identify simple text patterns in the log entries. This requires you to parse the custom log entries using the parse operator. A parse operator allows you to evaluate a string expression and parse its value into one or more calculated columns. When a column has no parsed strings, you will see a null in the calculated column.

You should also use the RawData custom log record property. You have four custom log record properties that you could assign: TimeGenerated, SourceSystem, RawData and ManagementGroupName. A RawData property provides the full text of the collected entry.
You should not use the order operator. The order operator allows you to sort the rows of the input table into order by one or more columns; however, you need to parse the RawData log entries.
You should not use the scan operator. The scan operator allows you to scan data, formulate matches, and build sequences based on the predicates. A predicate can depend on the state that is generated by previous steps.

You should not use the search operator. The search operator allows you to search for a text pattern in multiple tables and columns, but you need to parse the RawData log entries.
You should not use the SourceSystem custom log record property. This property shows the type of agent that the record was collected from. There are two possible values for this property: OpsManager for Windows agent (either direct connect or System Center Operations Manager), and Linux for all Linux agents. In this scenario, since you are required to parse the entire log entry, you should use the RawData property.

You should not use the TimeGenerated custom log record property. This property provides the date and time at which Azure Monitor collected the record. If the log uses a time-based delimiter, this is the time collected from the entry.
You should not use the ManagementGroupName custom log record property. This property provides the name of the management group for System Center Operations Manager agents.

---

### References

[Collect logs from a text or JSON file with Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/data-collection-log-text?tabs=portal)  
[Parse text data in Azure Monitor logs](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/parse-text)  
[parse operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/parse-operator)  
order operator
scan operator
search operator


---

## Q041:

Your managers travel to another country. They are connected to the company's Windows cloud server. which is linked to its Microsoft Sentinel workspace. While they are abroad, they hire a new employee to work online for the company. Your manager wants to be able to be notified if you create the user account for the new employee locally in the Windows cloud server.
You need to implement a solution that can enable the manager to be notified if the creation of user accounts is done from any Windows cloud server linked with the company's Microsoft Sentinel workspace.

What should you do?

Choose the correct answer

- Create a Microsoft Defender for Office 365 (Preview) connector.
- Use a Windows Security Events via AMA connector.
- Create a Cloud Connector.
- Use Microsoft Defender for Cloud.

---

### Answer:
- Use a Windows Security Events via AMA connector.

You should use a Windows Security Events via AMA connector. A Windows Security Events via AMA connector is used to stream security events from any Windows server (virtual, physical, in a cloud) linked with your Microsoft Sentinel workspace. This means that the manager can use these event in the single location to view or be notified when the new user account is created, as this activity is considered to be al security event. To set a Windows Security Events via AMA connector, you should access the Microsoft Sentinel portal then navigate to the Open connector page button, where you will verify that you have permission to create the connector before downloading the Azure Monitor Agent, which will finish the process. Microsoft Sentinel is a Security Information Event Management (SIEM) system used to provide security analytics for companies.
You should not create a Cloud Connector. Cloud connector is a bridge between an organization's on- premises infrastructure and the cloud-based services provided by Office 365 or Microsoft 365. You cannot use a Cloud Connector to view how the creation of user accounts is done from any Windows cloud server.
You should not create a Microsoft Defender for Office 365 (Preview) connector. Microsoft Defender for Office 365 (Preview) connectors are used to connect Microsoft Defender for Office 365 security solutions to a Microsoft Sentinel workspace. This does not meet the scenario requirement.
You should not use Microsoft Defender for Cloud. Microsoft Defender for Cloud is a cloud workload protection feature that provides cloud security posture management and cloud workload protection. It is used to protect SQL databases, virtual machines, and web applications from malicious attacks. This solution does not allow you to view if the creation of user accounts is done in any Windows cloud server linked with the company's Microsoft Sentinel workspace.

---

### References

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference)  
[Configure Cloud Connector integration with your Microsoft 365 or Office 365 organization](https://learn.microsoft.com/en-us/microsoftteams/cloud-voice-landing-page)  
[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  
[Microsoft Defender XDR integration with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration?tabs=azure-portal)   

---

## Q040:

You are in the process of connecting data sources to Microsoft Sentinel.
You want to ingest Microsoft Entra ID Protection data into Microsoft Sentinel.
You need to identify the prerequisites for making this connection.

Where can you find this list of prerequisites?

Choose the correct answer

- On the Data Connectors page for Microsoft Entra ID. under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID, under the Configuration heading.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Next Steps tab.

---

### Answer:

You can find the list of prerequisites on the Data Connectors page for Microsoft Entra ID Protection, under Instructions. The first key is knowing that Microsoft Entra ID Protection has its own data connector. You can choose to connect Microsoft Entra ID on its own, as well. However, the Microsoft Entra ID Protection connector is what you need to use to retrieve risky sign-in and risky user data. The prerequisites, once you are on the Data Connectors page, are under the Instructions tab.
You should not navigate to the Data Connectors page for Microsoft Entra ID Protection and then to the Next Steps tab. This tab offers information/suggestions on activities after making the connection, not the prerequisites required before making the connection.
You should not navigate to the Data Connectors page for Microsoft Entra ID and then to the Instructions tab. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. This is, however, where you could find the prerequisites for the Microsoft Entra ID data connector.
You should not navigate to the Data Connectors page for Microsoft Entra ID and look under the Configuration heading. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. The Configuration heading is on the Instructions tab, and it simply has the ability to connect or disconnect based on log type. This is an important area for setting up data connectors, but the prerequisites are actually displayed on the same tab in the section labeled Prerequisites, which is above Configuration.

---

### References

[Microsoft Entra ID Protection connector for Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-azure-windows-microsoft-services)  
[Connect data sources](https://learn.microsoft.com/en-us/azure/sentinel/create-incidents-from-alerts)  
[What is Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/fundamentals/whatis)  

---

## Q039:

You are in the process of connecting data sources to Microsoft Sentinel.
You want to ingest Microsoft Entra ID Protection data into Microsoft Sentinel.
You need to identify the prerequisites for making this connection.

Where can you find this list of prerequisites?

Choose the correct answer

- On the Data Connectors page for Microsoft Entra ID. under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID, under the Configuration heading.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Next Steps tab.

---

### Answer:
- On the Data Connectors page for Microsoft Entra ID Protection, under the Instructions tab.

You can find the list of prerequisites on the Data Connectors page for Microsoft Entra ID Protection, under Instructions. The first key is knowing that Microsoft Entra ID Protection has its own data connector. You can choose to connect Microsoft Entra ID on its own, as well. However, the Microsoft Entra ID Protection connector is what you need to use to retrieve risky sign-in and risky user data. The prerequisites, once you are on the Data Connectors page, are under the Instructions tab.
You should not navigate to the Data Connectors page for Microsoft Entra ID Protection and then to the Next Steps tab. This tab offers information/suggestions on activities after making the connection, not the prerequisites required before making the connection.
You should not navigate to the Data Connectors page for Microsoft Entra ID and then to the Instructions tab. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. This is, however, where you could find the prerequisites for the Microsoft Entra ID data connector.
You should not navigate to the Data Connectors page for Microsoft Entra ID and look under the Configuration heading. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. The Configuration heading is on the Instructions tab, and it simply has the ability to connect or disconnect based on log type. This is an important area for setting up data connectors, but the prerequisites are actually displayed on the same tab in the section labeled Prerequisites, which is above Configuration.

---

### References

[Microsoft Entra ID Protection connector for Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors/microsoft-entra-id-protection)  
[Connect data sources](https://learn.microsoft.com/en-us/training/modules/create-manage-azure-sentinel-workspaces/)  
[What is Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/fundamentals/whatis)  

---

## Q038:

You have deployed Microsoft Sentinel and are currently connecting data sources.
You need to connect Microsoft Entra ID, as you would like to ingest Microsoft Entra sign-in logs and audit logs into Microsoft Sentinel.
Which five actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

> Possible actions

On the Data Connectors page, select the Microsoft Entra ID Protection tile.

In Microsoft Defender for Cloud, go to the Getting Started page.

In the Azure portal, under the All services option, select Microsoft Sentinel.

From the navigation menu, select Data Connectors.

On the Data Connectors page, select the Microsoft Entra ID tile.

Click the Open connector page button and then follow the instructions to connect the data source.

Select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs.

> Actions in order

In the Azure portal, under the All services option, select Microsoft Sentinel.

From the navigation menu, select Data Connectors.

On the Data Connectors page, select the Microsoft Entra ID tile.

Click the Open connector page button and then follow the instructions to connect the data source.

Select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs.

---

### Answer:

You need to complete the following steps in order:

1. In the Azure portal, under the All services option, select Microsoft Sentinel.
2. From the navigation menu, select Data Connectors.
3. On the Data Connectors page, select the Microsoft Entra ID tile.
4. Click the Open connector page button and then follow the instructions to connect the data source.
5. Select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs.

First, you should select Microsoft Sentinel from the All services option in the Azure portal. This is the way you navigate to Microsoft Sentinel, where you can set up data connectors.
Next, you should select Data Connectors from the side navigation menu. Microsoft Sentinel needs to ingest data to be an effective Security Information and Event Management (SIEM) tool, and data connectors are the way that information reaches Sentinel.
Then, you should select the Microsoft Entra ID tile on the Data Connectors page. This will narrow down the list to the specific data connector needed to send the data you want to Microsoft Sentinel. As the scenario mentions Microsoft Entra sign-in and audit logs, this is the tile you should select.
Next, you should click the Open connector page button and then follow the instructions to connect the data source. Each data source may have different directions, so you should follow the instructions specific to your chosen data connector.
Finally, you should select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs. These are the logs/data specifically mentioned in the scenario. Selecting them allows for this specific data to flow to Microsoft Sentinel.
You should not select the Microsoft Entra ID Protection tile on the Data Connectors page. This tile is for the connector for Microsoft Entra ID Protection, which monitors risky users and risky sign-ins. While this is valuable data to ingest, it is not the process you are required to complete in this scenario.
You should not go to the Getting Started page in Microsoft Defender for Cloud. You can deploy Microsoft Defender for Cloud from this page, along with other important security tasks, but it is not the location which will enable you to connect Microsoft Entra to Microsoft Sentinel.

---

### References

[Connect data sources](https://learn.microsoft.com/en-us/training/modules/create-manage-azure-sentinel-workspaces/)  
[What is Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/fundamentals/whatis)  

---

## Q037:

You enable Microsoft Sentinel in your company.
Your manager wants to integrate log data from Microsoft 365 and non-Azure virtual machines.
You need to recommend a solution to fulfill the manager's request.

What solution should you recommend?

Choose the correct answer

- Using Data Loss Prevention policies
- Using Microsoft Graph
- Adding a playbook in Microsoft Sentinel
- Creating data connectors in Microsoft Sentinel

---

### Answer:
- Creating data connectors in Microsoft Sentinel

You should recommend creating data connectors in Microsoft Sentinel. Microsoft Sentinel data connectors are used by companies to integrate the log data from several sources like Microsoft 365, Azure resources, Microsoft Defender for Office 365, and non-Azure virtual machines. To use data connectors, you have to choose the Data Connectors tab on the left-hand side of the Microsoft Sentinel portal, then select the connector you want from a list. There are several types of connectors for different purposes, such as connecting Vectra Al Detect to Microsoft Sentinel or connecting Amazon Web Services to Microsoft Sentinel. Upon selecting the appropriate connector, you will be able to collect log data from the source that you choose.
You should not recommend adding a playbook in Microsoft Sentinel. Playbooks are sets of processes that may be executed in response to an alert or event from Microsoft Sentinel. A playbook uses automation in response to alerts, attaching an analysis rule or an automation rule when certain alerts or occurrences are produced. They cannot integrate log data from Microsoft 365 and non-Azure virtual machines.
You should not recommend using Microsoft Graph. Microsoft Graph uses a single API call to act on security insights from security solutions. It is a tool that enables users to create solutions that are authenticated once. This solution does not allow you to integrate log data. Microsoft Graph includes features like the calendar feature for Outlook, which allows users to set up appointments, and the files feature for SharePoint and OneDrive, which enables users to manage files on SharePoint and OneDrive.

You should not recommend using Data Loss Prevention (DLP) policies. Using a DLP policy will allow you to ban the accidental sharing of sensitive information with people outside the organization. Data loss prevention can display a pop-up tip to employees to warn them about possible attempts to share sensitive data with people outside the organization, but it cannot integrate log data as required in the scenario.

---

### References

[Microsoft Sentinel data connectors](https://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources?tabs=azure-portal)  
[Get started with the data loss prevention alerts](https://learn.microsoft.com/en-us/purview/dlp-alerts-get-started)  
[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  
[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)  

---

## Q036:

The coordinator of the finance team reports that the Microsoft 365 data of a team member is compromised.
Your manager wants you to implement a solution that enables the company to collect log data.
You need to recommend a solution that fulfills the manager's request.

What solution should you recommend?

Choose the correct answer

- Microsoft Sentinel connectors
- Attack surface reduction rules
- Exemption rules
- Windows Security Events connector

---

### Answer:

You should recommend Microsoft Sentinel connectors. Through Microsoft Sentinel connectors, you can connect your data resources, such as Microsoft 365, to connectors found in Microsoft Sentinel. This will enable you to keep track of log data connected to the connectors, protecting this data from being compromised. Microsoft Sentinel is a Security Information Event Management (SIEM) system that provides security analytics for companies.
You should not recommend Exemption rules. Exemption rules are a part of Microsoft Defender for Cloud and they allow you to have precise control over the recommendations that influence the resources in your subscriptions and management groups. This solution does not enable you to collect Microsoft 365 data or log data.
You should not recommend the Windows Security Events connector. The Windows Security Events connector is used to stream security events from any Windows server linked with your Microsoft Sentinel workspace. This solution does not enable you to collect Microsoft 365 data or log data.
You should not recommend Attack Surface Reduction rules. These rules are used to protect an organization from being compromised through malicious scripts and executable files. This solution does not enable you to collect Microsoft 365 data or log data.

---

### References

[Microsoft Sentinel data connectors](https://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources?tabs=azure-portal)  

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference)  

[Enable attack surface reduction rules](https://learn.microsoft.com/en-us/defender-endpoint/enable-attack-surface-reduction)  

[Exempt resources from recommendations](https://learn.microsoft.com/en-us/azure/defender-for-cloud/exempt-resource)  

---

## Q035:

Your manager asks you to configure alerts in Microsoft Defender for Endpoint so that the members of the accounting team can receive alerts when a vulnerability is detected. You configure the alerts as requested. One of the employees reports that they are not receiving email notifications when a vulnerability is detected like their colleagues.
You need to make sure the employee receives the email notifications.

What should you do?

Choose the correct answer

- Delete the notification rule.
- Edit the created notification rule.
- Modify the Include tenant-specific portal link field of the notification rule.
- Check the employee's Junk Email folder and mark the security emails as Not Junk.

---

### Answer:
- Check the employee's Junk Email folder and mark the security emails as Not Junk.

You should check the employee's Junk Email folder for the security emails. Emails from Defender for Endpoints are occasionally sent to the Junk Email folder. Accessing this folder and marking the security emails as Not Junk will resolve the problem. Other potential causes of this problem include your email security product blocking email notifications from Defender for Endpoints, or your email application rules. catching and moving these notifications.
You should not edit the created rule for alert notifications. This action, done in the Microsoft Defender for Endpoint will allow you to edit a created rule for email notifications by accessing the email notifications page and then selecting the rule you want to edit. There are several fields that you can edit in the created rule, like the rule name and the alert severity that will be displayed for the user receiving an email about the alert.
You should not delete the notification rule. Deleting the rule will prevent the employee from receiving any email notification related to a detected vulnerability.
You should not modify the Include tenant-specific portal link field of the notification rule. This action will allow you to reset a new link with a specific tenant ID to allow the notification to pass to a user in a specific tenant.

---

### References

[Configure alert notifications in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/configure-email-notifications)  

[Configure vulnerability email notifications in Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/configure-vulnerability-email-notifications)  

---

## Q034:

Your organization uses Microsoft Azure cloud, with resources located in the United States and Europe. Every geography has regulatory requirements for data retention.
You need to implement Microsoft Sentinel for your Security Operations Center (SOC) team. The estimated log data ingestion will exceed 100 GB per day per geography.

How many workspaces should you plan for your Microsoft Sentinel solution?

Choose the correct answer

- One
- Two
- Three
- Four

---

### Answer:
- Four

You should plan four workspaces for your Microsoft Sentinel solution. When you plan the implementation of Microsoft, it is essential to outline the architecture for your Log Analytics workspace. The design of the workspace architecture is usually influenced by both business and technical needs.
Based on Microsoft's best practices for Microsoft Sentinel workspace architecture, you should consider the following, among other factors:
• cost implications for different scenarios
any compliance requirements for data collection and storage
Considering the factors mentioned above, Microsoft recommends using a separate workspace for every 100 GB of data for cost efficiency. Additionally, it is suggested to separate the workspaces by geography. In this scenario, there are two geographies: the United States and Europe. Furthermore, due to log data ingestion exceeding 100 GB per day per geography, it will be necessary to implement two separate workspaces for each geography, respectively.
Note that while a geography in Azure represents a larger area encompassing multiple regions and ensuring data residency and compliance, a region refers to a specific geographical location where Azure resources such as Microsoft Sentinel workspace can be deployed and hosted.

---

### References

[Design your Microsoft Sentinel workspace architecture](https://learn.microsoft.com/en-us/azure/sentinel/design-your-workspace-architecture)   

[Microsoft Sentinel workspace architecture best practices](https://learn.microsoft.com/en-us/azure/sentinel/best-practices-workspace-architecture)  

[Geographical availability and data residency in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/geographical-availability-data-residency)  

---

## Q033:

You have a Microsoft Sentinel security information and event management (SIEM) and security orchestration, automation, and response (SOAR) solution running in an Azure subscription.
You are assigning Azure role-based access control (Azure RBAC) permissions for the below users in Microsoft Sentinel:

- User1, a security analyst, needs to attach playbooks to analytics and automation rules, as well as run playbooks.
- User2, a security engineer, needs to manage incidents, such as assigning or dismissing them.

User3, a service principal, needs to manage automated configuration for management tasks (e.g., creating and updating support tickets), create and edit analytics rules.
You need to assign the appropriate roles for the users as per their user type and according to Microsoft's recommendations.

Which role should you assign to each user? 
To answer, drag the appropriate role to each user. A role may be used once, more than once, or not at all.

Drag and drop the answers

Sentinel Playbook Operator
Sentinel Contributor
Sentinel Responder
Logic App Contributor

User1: Sentinel Playbook Operator
User2: Sentinel Responder
User3: Sentinel Contributor

---

### Answer:

Microsoft Sentinel uses Azure role-based access control (Azure RBAC) to provide built-in roles that can be assigned to users, groups, and services in Azure. There are five Microsoft Sentinel-specific roles: Microsoft Sentinel Reader, Microsoft Sentinel Responder, Microsoft Sentinel Contributor, Microsoft Sentinel Playbook Operator and Microsoft Sentinel Automation Contributor. In addition to these roles, the Logic App Contributor role can also be assigned to allow the user to view, run, create or edit playbooks.
In this scenario, User1 is a security analyst and needs to attach playbooks to analytics and automation rules and, additionally, to run playbooks. According to Microsoft's recommendations, this user should be assigned the Microsoft Sentinel Playbook Operator role.
User2 is a security engineer and needs to manage incidents, which includes tasks such as assigning or dismissing incidents. According to Microsoft's recommendations, this user should be assigned the Microsoft Sentinel Responder role.
User3 is a service principal and can manage automated configuration for management tasks, create and edit analytics rules. According to Microsoft's recommendations, this user should be assigned the Microsoft Sentinel Contributor role.
You should not assign the Logic App Contributor role to any of these users. According to Microsoft's recommendations, this role is targeted towards the Security Engineer user type for Microsoft Sentinel's resource group, or the resource group where your playbooks are stored. This role also allows a user to attach playbooks to analytics and automation rules, in addition to running and modifying the playbooks.

---

### References

[What is Microsoft Sentinel?](https://learn.microsoft.com/en-us/azure/sentinel/overview?tabs=azure-portal)  
[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)  

---

## Q032:

Your company starts using Microsoft Sentinel.
The manager wants the administration of the implemented solution to be divided into two groups, Group A and Group B, where:
Group A is responsible for replacing tags in Threat Intelligence Indicator.
Group B is responsible for adding playbooks to automation rules.
You need to assign the appropriate roles for both groups to fulfill the manager's request.
How should you assign the roles? To answer, drag the appropriate role to each group. A role may be used once, more than once, or not at all.

Drag and drop the answers

Responder
Sentinel Automation Contributor
Reader
Security Assessment Contributor

Group A: Responder
Group B: Sentinel Automation Contributor

---

### Answer:

You should assign the Responder role to Group A. This role gives the user permission to manage incidents (assign users to incidents, dismiss alerts, etc.) in Microsoft Sentinel and to view several Microsoft Sentinel resources, including reports, incidents, and workbooks. This role also gives users permission to replace tags in Threat Intelligence Indicator. It does not give users permission to add playbooks to automation rules. Threat Intelligence Indicator is a cloud-based solution used within companies to analyze and act upon threat activities.
You should assign the Microsoft Sentinel Automation Contributor role to Group B. In addition to viewing Microsoft Sentinel resources, managing incidents, and working with workbooks, this role allows users to add playbooks to automation rules in Microsoft Sentinel.
You should not assign the Reader role to either group. This role gives a user permission to view incidents in Microsoft Sentinel, but not the permission to replace tags in Threat Intelligence Indicator or to add playbooks to automation rules as required in the scenario.
You should not assign the Security Assessment Contributor role to either group. This role gives users permission to create security assessments on the company's Microsoft Sentinel subscription, which is useful for finding out whether the company needs another Microsoft Sentinel subscription. This role does not give the permission to replace tags of Threat Intelligence Indicator or to add playbooks to automation rules as required in the scenario.

---

### References

[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)    
[Azure built-in roles](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles)

---

## Q031:

You are deploying Microsoft Sentinel and want to assign roles to users.
You need to ensure that all users are able to create and edit workbooks, analytics rules, and other Microsoft Sentinel resources.

Which two roles could you assign to these users to meet the requirements?
Each correct answer presents a complete solution.

Choose the correct answers

- Microsoft Sentinel Reader
- Microsoft Sentinel Contributor and Logic App Contributor
- Microsoft Sentinel Contributor
- Microsoft Sentinel Responder

---

### Answer:
- Microsoft Sentinel Contributor and Logic App Contributor
- Microsoft Sentinel Contributor

You should assign users either the Microsoft Sentinel Contributor role or the Microsoft Sentinel Contributor and Logic App Contributor role. Both of these options allow users to create and edit workbooks, analytics rules, and other Microsoft Sentinel resources. The Microsoft Sentinel Contributor and Logic App Contributor role also adds the ability to create and run playbooks.
You should not assign users the Microsoft Sentinel Responder role. Users with this role can manage incidents (dismissing and assigning incidents, for example) and also view data incidents, workbooks, and other Microsoft Sentinel resources.
You should not assign users the Microsoft Sentinel Reader role. Users with this role only have the permissions to view data incidents, workbooks, and other Microsoft Sentinel resources. It is the least privileged of all the Microsoft Sentinel roles.

---

### References

[Create and manage Microsoft Sentinel workspaces](https://learn.microsoft.com/en-us/training/modules/create-manage-azure-sentinel-workspaces/)  

---

## Q030:

You are in the process of implementing Microsoft Sentinel.
Your manager wants the log data to be kept in the company's workspace for 550 days.
You need to recommend a solution that fulfills the manager's request.

What should you recommend?

Choose the correct answer

- Create sensitivity labels in the Microsoft Purview compliance portal.
- Use security extensions in Microsoft Defender for Cloud.
- Use data retention in the Azure portal.
- Create a workbook in the Azure portal.

---

### Answer:
- Use data retention in the Azure portal.

You should recommend using data retention in the Azure portal. Data retention is an option in the Azure portal that allows you to adjust the log retention days. This solution is applied by accessing the Data Retention window on the Usage and estimated costs page, where a blade for retention days will be displayed for you to adjust. Using this blade, you can set the data retention period to 30, 31, 60, 90, 120, 180, 270, 365, 550, or 730 days. 31 days is the default setting and 730 is the maximum number of days allowed. Data will be retained in Microsoft Azure servers
You should not recommend creating a workbook in the Azure portal. Workbooks provide a broad canvas for data analysis and the production of sophisticated visual reports. They enable you to connect to numerous data sources throughout Azure and integrate them into cohesive interactive experiences. However, workbooks will not allow you to keep log data for a defined period of time.
You should not recommend creating sensitivity labels in the Microsoft Purview compliance portal. Sensitivity labels allow you to protect and classify the company's data while making sure that employees can effectively collaborate. When a sensitivity label is applied to content, it can restrict access to content by adding a mark to a specific document (like watermarks applied on documents) or by using encryption.
You should not recommend using security extensions in Microsoft Defender for Cloud. This solution is used to collect data and send information on specific resource kinds after being scanned by the Log Analytics Agent tool. It will not allow you to keep log data as the manager requests.

---

### References

[Azure Monitor Logs cost calculations and options](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/cost-logs)  

[Create and configure sensitivity labels and their policies](https://learn.microsoft.com/en-us/purview/create-sensitivity-labels?view=o365-worldwide)  

[Azure Workbooks](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-overview)  

[How does Defender for Cloud collect data?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/monitoring-components)  

---


## Q029:

Your manager wants an employee in the human resources department to be able to manage incidents and view resources in Microsoft Sentinel, but they should have no other permissions.
You need to grant the employee the appropriate permissions.

What role should you assign to the employee?

Choose the correct answer

- Microsoft Sentinel Reader
- Microsoft Sentinel Responder
- Microsoft Sentinel Contributor and Logic App Contributor
- Microsoft Sentinel Contributor

---

### Answer:
- Microsoft Sentinel Responder

You should assign the employee the Microsoft Sentinel Responder role. This role gives them permission to manage incidents (assign users to incidents, dismiss alerts, etc.) in Microsoft Sentinel and to view several Microsoft Sentinel resources, including reports, incidents, and workbooks. It does not give them any other permissions, so they could not create playbooks or analytics rules, for example.
You should not assign the employee the Microsoft Sentinel Contributor role. This role would give them permission to manage and view incidents in Microsoft Sentinel, but it also grants users permission to create and edit analytics rules.
You should not assign the employee the Microsoft Sentinel Reader role. This role would give them permission to view incidents in Microsoft Sentinel, but not permission to manage incidents.
You should not assign the employee the Microsoft Sentinel Contributor and Logic App Contributor roles. These roles would allow them to manage and view incidents in Microsoft Sentinel, and it would also give them the ability to create playbooks and analytics rules.

---

### References


[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)  

---

## Q028:

You have been tasked with enabling Microsoft Sentinel in an Azure tenant with multiple resource groups.
You need the correct role to be able to complete this task, while following the principle of least privilege and minimizing administrative effort.

What role should you be assigned?

Choose the correct answer

- Reader on the subscription that contains the Microsoft Sentinel workspace
- Reader on the resource group that contains the Microsoft Sentinel workspace
- Contributor on the subscription that contains the Microsoft Sentinel workspace
- Contributor on the resource group that contains the Microsoft Sentinel workspace

---

### Answer:
- Contributor on the subscription that contains the Microsoft Sentinel workspace

You should be assigned the Contributor role on the subscription that contains the Microsoft Sentinel workspace. In addition to all of the permissions provided with the Reader role, with the Contributor role, you can create and edit all Microsoft Sentinel resources. It is the only role that allows a user to deploy Microsoft Sentinel, and it must be applied at the subscription level as that is where Sentinel must be deployed. Assigning the permissions at the subscription level will propagate down to all resource groups, which means less administrative effort.
You should not be assigned the Reader role on the subscription that contains the Microsoft Sentinel workspace or on the resource group that contains the Microsoft Sentinel workspace. The Reader role is not enough to enable Microsoft Sentinel regardless of where those permissions are granted. This only allows for the review of Sentinel data after it has been deployed. Although it is often a great choice for least privilege, in this scenario, it would not be enough to get the task completed.
You should not be assigned the Contributor role on the resource group only, as this role will need to be assigned for the entire subscription. As Microsoft Sentinel will be aggregating data from across your entire subscription, having the Contributor role at that level is critical for the specific task of initially deploying the solution.

---

### References

[Roles and permissions in Microsoft Sentinel]()
Create a Microsoft Sentinel workspace

---

## Q027:

Your organization uses Microsoft Azure and Amazon Web Services (AWS) cloud platforms.
You implement Microsoft Defender for Cloud CSPM service to scan vulnerabilities and compliance issues in your environment.
You need to identify the process by which the AWS Identity provider validates the Microsoft Entra token against the Microsoft Entra ID before a vulnerabilities and compliance scan can take place.

Which three validation conditions are included in this process? 
Each correct answer presents part of the solution.

Choose the correct answers

- audience validation
- expiration check
- token digital signature validation
- certificate thumbprint
- Issuer validation

---

### Answer:
- audience validation
- token digital signature validation
- certificate thumbprint

Cloud security posture management (CSPM) is part of the broader Microsoft Defender for Cloud suite, which also includes services for threat protection, identity and access management, and data protection. It supports various cloud platforms, including Microsoft Azure, Amazon Web Services (AWS), and Google Cloud Platform (GCP).
Validation conditions for AWS identity provider include:

- audience validation
- token digital signature validation
- certificate thumbprint

Audience validation ensures that the token is intended for the specific application or service that is trying to
use it. This helps prevent token misuse or replay attacks.
Token digital signature validation ensures that the token was indeed issued by a trusted authority and has not been tampered with.

Certificate thumbprint validation checks whether the thumbprint of the certificate used to sign the token matches the expected thumbprint. This helps ensure that the certificate used to sign the token is the one expected by the system.

Issuer validation and expiration check are not directly related to the validation of the Microsoft Entra token against Microsoft Entra ID, as they pertain to different aspects of token validation or management.

---

### References

[Connect your AWS account to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-aws)  
[Cloud Security Posture Management (CSPM)](https://learn.microsoft.com/de-de/azure/defender-for-cloud/concept-cloud-security-posture-management)  
[New AWS connector in Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/episode-one)  

---

## Q026:

You manage a complex heterogeneous infrastructure across various clouds, data centers, edge locations, and on-premises servers in a centralized, unified way. The IT department faces challenges in implementing a centralized, unified way of protecting this diverse environment.
You need a solution to streamline management and reduce complexity.
What is the most efficient solution that you should implement to meet the requirements?

Choose the correct answer

- Windows Server Update Services
- Operations Manager
- Azure Arc
- Configuration manager

---

### Answer:
- Azure Arc

You should implement Azure Arc. Azure Arc is the most efficient solution for managing a complex infrastructure across various clouds, data centers, and edge locations, with on-premises servers. Azure Arc is a set of technologies that extends Azure management and services to any infrastructure. It enables you to manage servers, Kubernetes clusters, and Azure data services across multiple environments, including on- premises, multi-cloud, and edge locations. With Azure Arc, you can use Azure management tools, such as Azure Policy, Azure Monitor, and Azure Security Center to manage resources consistently and centrally. This helps to streamline management, reduce complexity, and improve security and compliance across your entire infrastructure.
You should not implement Configuration Manager and Operations Manager. These solutions are part of Microsoft System Center, which is a suite of management tools for on-premises data centers. While these tools can help manage on-premises infrastructure, they may not be as effective for managing resources across various clouds, data centers, and edge locations.
You should not implement Windows Server Update Services (WSUS), WSUS is a tool for deploying updates to Windows servers in an on-premises environment. While this is an important aspect of managing on- premises servers, it does not address the broader challenges of managing a diverse infrastructure across multiple environments.

---

### References

[Azure Arc overview](https://learn.microsoft.com/en-us/azure/azure-arc/overview)  
[What is Configuration Manager?](https://learn.microsoft.com/en-us/mem/configmgr/core/understand/introduction)  
[Operations Manager](https://learn.microsoft.com/en-us/system-center/scom/welcome?view=sc-om-2022)  
[Windows Server Update Services (WSUS)](https://learn.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus)  

---

## Q025:

To reduce the attack surface, a company's security department initiated a project to discover unmanaged network devices by leveraging the new network device discovery capabilities available in the Device inventory of Microsoft Defender for Endpoint.
After several days, you notice that no new discovered devices are visible in the scan results.

Which three actions should you perform to resolve the issue? Each correct answer presents part of the solution.

Choose the correct answers

- Verify special configuration for Web Proxy Auto-discovery Protocol (WPAD).
- Verify that SNMP write access is enabled.
- Verify SNMP credentials.
- Verify that SNMP read-only access is enabled.
- Verify that SNMP traffic is allowed.

---

### Answer:

- Verify SNMP credentials.
- Verify that SNMP read-only access is enabled.
- Verify that SNMP traffic is allowed.

You should verify that SNMP traffic is allowed. SNMP (Simple Network Management Protocol) is used by Microsoft Defender for Endpoint to discover unmanaged network devices. If SNMP traffic is blocked or not allowed in the network, the discovery process will not work properly. Verifying that SNMP traffic is allowed ensures that the necessary communication can take place for device discovery.

You should also verify that SNMP read-only access is enabled. SNMP read-only access is typically sufficient for device discovery. Enabling only read access ensures that no unauthorized changes can be made to the devices being discovered. This is important for security reasons.

You should verify SNMP credentials too. The correct SNMP credentials are crucial for successful device discovery. If the credentials provided are incorrect or outdated, the discovery process will fail. Verifying that the correct credentials are being used ensures that the discovery process can access the devices.
You should not verify that SNMP write access is enabled. SNMP write access allows for the modification of device settings. However, write access is not typically needed for device discovery and can pose security risks. Therefore, it is recommended to only enable read-only access for SNMP.
You should not verify special configuration for Web Proxy Auto-discovery Protocol (WPAD). WPAD is used to automatically configure proxy settings for devices on a network. If Transparent proxy or WPAD is part of your network topology, no additional configuration settings are required.

---

### References

[Network device discovery and vulnerability assessments](https://techcommunity.microsoft.com/t5/microsoft-defender-vulnerability/network-device-discovery-and-vulnerability-assessments/ba-p/2267548)  

[Endpoint Discovery - Navigating your way through unmanaged devices](https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/endpoint-discovery-navigating-your-way-through-unmanaged-devices/ba-p/2248909)  

[Network device discovery and vulnerability management](https://learn.microsoft.com/en-us/defender-endpoint/network-devices)  

[Configure device discovery](https://learn.microsoft.com/en-us/defender-endpoint/configure-device-discovery)    

[Device discovery overview](https://learn.microsoft.com/en-us/defender-endpoint/device-discovery)  

[STEP 2: Configure your devices to connect to the Defender for Endpoint service using a proxy](https://learn.microsoft.com/en-us/defender-endpoint/configure-proxy-internet)  


---

## Q024:

You work for an organization that uses multiple Azure subscriptions to host Azure Cloud resources and has activated Microsoft Defender for Cloud. Defender for Cloud has identified unprotected resources, which you have remediated.

You utilize the Microsoft Defender for Cloud REST API to list secure scores for all your Cloud initiatives, and it provides the following output:

```
{
    "value": [ 
    {
        "id": "/subscriptions/10ac6cf1-d234-23ac-fk82x- a12547asgd31/providers/Microsoft.Security/secureScores/ascScore",
        "name": "ascScore",
        "type": "Microsoft.Security/secureScores",
        "properties": {
            "displayName": "ASC score",
            "score": {
                "max": 43,
                "current": 29.12,
                "percentage": 0.6772
            },        
        "weight": 77}
        }
    ]
}
```

Based on the security principle "Trust but verify," you need to verify the security posture using the Microsoft Defender for Cloud Secure Score.

For each of the following statements, select Yes if the statement is true. Otherwise, select No.

The current score is calculated using [Score per resource] * [Number of healthy resources]/[Number of unhealthy resources].
No

The relative weight for the Azure subscription 10ac6cf1-d234-23ac-fk82x- a12547asgd31 is 77.
Yes

To improve the Secure Score, you need to calculate the potential score increase and then apply remediation steps.
Yes

---

### Answer:

In the output provided, the current score is not calculated using: 

`[Score per resource] [Number of healthy resources]/[Number of unhealthy resources) `

The properties.score.current property, which provides the subscription's current score is calculated using: 

`[Score per resource] * [Number of healthy resources)`

The relative weight for the Azure subscription `10ac6cf1-d234-23ac-fk82x-a12547asgd31` is 77. 

The weight property is the relative weight of a specific Azure subscription. This weight property is used when we want to calculate an aggregated Microsoft Defender for Cloud Secure Score for multiple subscriptions.

To improve the Secure Score, you need to calculate the potential score increase and then apply remediation steps. Potential Score is calculated using [Score per resource] [Number of unhealthy resources]. The remaining points that are available within the control are provided by the potential score increase.

---

### References

[Remediate security risks in Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/well-architected/security/monitor-threats)  

[Secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls)  

[Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/rest/api/defenderforcloud/)

[Secure Scores - List](https://learn.microsoft.com/en-us/rest/api/defenderforcloud/secure-scores/list?view=rest-defenderforcloud-2020-01-01&tabs=HTTP)  

---

## Q023:

You are using Microsoft Defender for Endpoint and configuring roles for users. You are configuring roles for a Microsoft Entra group.
You need to assign a permission for a user that will allow them to manage email notifications in the Microsoft Defender XDR portal.

Which permission should you assign to the user?

Choose the correct answer

- View data - Defender Vulnerability Management
- View data - Security operations
- Active remediation actions - Security operations
- Manage security settings in Security Center

---

### Answer:
- Manage security settings in Security Center

You should assign Manage security settings in Security Center. This permission will allow the user to
manage the security settings in the Security Center, including permission to manage email notifications for
users in the Microsoft Defender XDR portal. With this permission, the user could enable an option to send
an email to users when an attack occurs, for example. The security settings also include the option to
implement folder exclusion for automation, which is used when an automated investigation is carried out
regarding specific folders where you can mark the folders that you want the automated investigation to skip.
You should not assign the View Data - Security operations permission. This permission would allow the user to view the data of security operations performed in the Microsoft Defender XDR portal.
You should not assign the View Data - Defender Vulnerability Management permission. This permission would allow the user to view data related to threat and vulnerability management in the Microsoft Defender XDR portal.
You should not assign the Active remediation actions Security operations permission. This permission. would allow the user to approve remediation actions or decline them in the Microsoft Defender XDR portal.

---

### References

[Create and manage roles for role-based access control](https://learn.microsoft.com/en-us/defender-endpoint/user-roles?view=o365-worldwide)   

[What is Microsoft Defender XDR?](https://learn.microsoft.com/en-us/defender-xdr/microsoft-365-defender)  

---

## Q022:

You use Microsoft 365 for Business in your organization.

To enhance security incident visibility, you have integrated Microsoft Defender XDR by connecting it to Microsoft Sentinel. Following an identity compromise, you acquired Microsoft Entra ID Protection licenses.
You need to ensure that the alerts and incidents from the newly purchased product are directed to Microsoft Sentinel.

For each of the following statements, select Yes if the statement is true. Otherwise, select No.


The newly purchased product will be automatically connected to Microsoft Sentinel in the background.
Yes

Connecting the newly purchased product to Microsoft Sentinel incurs additional fees.
No

The alerts and incidents from the new product will flow into Microsoft Sentinel without the need for further configuration.
Yes

---

### Answer:

The newly purchased product will be automatically connected to Microsoft Sentinel in the background. All integrated components and services are connected in the background when Microsoft Defender XDR is connected to Microsoft Sentinel. Therefore, when Microsoft Entra ID Protection is acquired, it is seamlessly integrated with Microsoft Sentinel without the need for additional configuration.
Connecting the newly purchased product to Microsoft Sentinel does not incur additional fees. When Microsoft Entra ID Protection licenses are acquired after the integration of Microsoft Defender XDR, the alerts and incidents from this new product are directed to Microsoft Sentinel without incurring extra fees. No additional charges are applied for connecting the newly purchased product with Microsoft Sentinel.
The alerts and incidents from the new product will flow into Microsoft Sentinel without the need for further configuration. The integration process is straightforward and does not need manual intervention.

---

### References

[Microsoft Defender XDR integration with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration?tabs=azure-portal)  

[Explore security solutions in Microsoft Defender XDR](https://learn.microsoft.com/en-us/training/modules/explore-security-solutions-microsoft-365-defender/)  

[What is Microsoft Defender for Identity?](https://learn.microsoft.com/en-us/defender-for-identity/what-is)  

---

## Q019-Q021:

Your company uses Microsoft Sentinel for threat detection.
Your manager reports that a significant number of Azure Storage account keys were recently enumerated without anyone being notified about the incident.
You need to configure Microsoft Sentinel to immediately alert you when such an incident occurs.

---

## Q021:

Solution: Create a hunting bookmark.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Hunting bookmarks are a Microsoft Sentinel tool that allows you to preserve queries that have already run in the Microsoft Sentinel Logs service, in addition to the query results. This solution also allows you to add notes and tags in order to record your contextual observations for incidents, but it does not allow you to send alerts upon detecting the enumeration of Azure Storage keys.

---

### References

[Keep track of data during hunting with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/bookmarks)  


---

## Q020:

Solution: Create a hunting livestream.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. To receive immediate alerts when Azure Storage account keys are enumerated, you should create a hunting livestream. Hunting livestreams are a tool in Microsoft Sentinel that allows you to use hunting queries for events, then receive a notification when an event matches the specification in a query. This solution means that you can create a livestream for the event of Azure Storage keys being enumerated and receive notifications whenever this incident occurs. To create a hunting livestream, you should access the Hunting page in the Microsoft Sentinel portal, locate a hunting query to use on the Queries tab, and then add a livestream to it.

---

### References

[Use hunting livestream in Microsoft Sentinel to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/livestream)  

---

## Q019:

Solution: Create an analytics rule.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Microsoft Sentinel Analytics Rules are a feature of Microsoft Sentinel, a cloud-native security information and event management (SIEM) platform. These rules are used to detect security threats and unusual activity in your environment by analyzing the data that flows through Azure
Sentinel.
Microsoft Sentinel Analytics Rules are created using a query language called Kusto Query Language (KQL), which is used to define the logic for identifying specific security events or patterns of activity that may indicate a security breach. These rules can be configured to trigger alerts, create incidents, or take other automated actions in response to specific security events. Although Microsoft Sentinel Analytics Rules can trigger alerts for your security operation center (SOC) team to triage, investigate and respond to threats, the alert is not triggered immediately, as requested in this scenario.

---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  

---

## Q016-Q018:

Your manager wants Microsoft Teams to send a message to the Security channel whenever there is an intended sign-in from a suspicious IP address. They ask you to find a solution.
You need to fulfill the manager's request.

---

## Q018:

Solution: Create a Palybook and assign it to an incident.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. To complete the manager's request, you should create a playbook in Microsoft Sentinel and assign it to an incident. Playbooks are sets of processes that may be executed in response to an alert or event. A playbook uses automation in responding to alerts by attaching an analysis rule or an automation rule when certain alerts or occurrences are produced. Assigning a playbook to an incident will allow you to use the playbook to provide the desired response, such as having a message sent from Microsoft Teams when a suspicious login is detected. In order to associate or assign a playbook to an incident, an automation rule should be created on the Microsoft Sentinel portal.

---

### References

[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)  


---

## Q017:


Solution: Create a Workbook.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Workbooks in the Azure portal provide a broad canvas for data
analysis and the production of sophisticated visual reports. They enable you to connect to numerous data
sources throughout Azure and integrate them into cohesive interactive experiences. Workbooks do not
allow Microsoft Teams to send a message upon an incident occurring as required in the scenario.

---

### References

[Azure Workbooks](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-overview)  

---

## Q016:


Solution: Use the Microsoft Graph security API.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Microsoft Graph is a tool that enables users to create solutions that are authenticated once and use a single API call to act on security insights from security solutions. The Microsoft Graph security API connects Microsoft security products, services, and partners in order to improve threat protection, detection, and response capabilities. Microsoft Graph includes features like the calendar feature for Outlook, which allows users to set up appointments, and the files feature for SharePoint and OneDrive, which enables users to manage files on SharePoint and OneDrive.

---

### References

[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  
[Microsoft Graph security API overview](https://learn.microsoft.com/en-us/graph/security-concept-overview)  

---

## Q013-Q015:

You use Microsoft Defender for Office 365 in your organization. Your organization is overwhelmed with suspicious emails containing potentially harmful attachments. You configure an automated investigation in Microsoft Defender for Office 365 to deescalate the situation, but suspicious emails flood is not reduced.

You need to resolve the issue.

---

## Q015:

Solution: You configure a policy alert trigger based on unusual activity.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. By configuring a policy alert trigger based on unusual activity, you can effectively address the issue of an overwhelming flood of suspicious emails containing potentially harmful attachments. Microsoft sets a baseline value to determine the typical frequency of the chosen activity. This baseline is established over a period of up to seven days, during which no alerts will be generated. Once the baseline is set, an alert will be activated if the frequency of the activity monitored by the alert policy significantly surpasses the established baseline value.
This alert trigger will enable Microsoft Defender for Office 365 to detect and respond to unusual patterns or behaviors associated with suspicious emails, helping to reduce the flood of such emails and enhance overall security posture.

---

### References

[Alert policies in Microsoft 365](https://learn.microsoft.com/en-us/purview/alert-policies)  

[Automated investigation and response (AIR) in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/air-about)  

[Address compromised user accounts with automated investigation and response](https://learn.microsoft.com/en-us/defender-office-365/address-compromised-users-quickly)    

---

## Q014:


Solution: You customize and enable an alert policy.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. Customizing and enabling an alert policy can effectively address the challenge of managing the influx of suspicious emails with potentially harmful attachments. By tailoring alert policies to detect and respond to such threats, organizations can enhance their ability to identify and mitigate security risks more efficiently.
Microsoft Defender for Office 365 generates billions of signals daily to detect various types of malicious emails. If an email is automatically blocked, deleted, or otherwise neutralized, no alert is generated, as no further action is required from the security team.
In cases where suspicious emails are not identified and neutralized before delivery, no alert is generated. Several typical reasons for this include Zero-hour Auto Purge (ZAP), user-initiated security incidents resulting from inadvertent engagement with malicious content (such as clicking on phishing links or downloading malware), URLs weaponized at the time of click, and other factors.
To address this issue, specific alert policies need to be configured to trigger alerts when suspicious activities are detected. These alerts can then be investigated by the security team, or an automated investigation can be initiated.

---

### References

[Investigating Alerts in Defender for Office 365](https://techcommunity.microsoft.com/t5/microsoft-defender-for-office/investigating-alerts-in-defender-for-office-365/ba-p/1824188)  
[Threat investigation and response](https://learn.microsoft.com/en-us/defender-office-365/office-365-ti)  

---

## Q013:

Solution: You create a security playbook.
Does this solution meet the goal?

---

### Answer:
No

The solution does not meet the goal. A security playbook is a predefined set of procedures or actions that are triggered automatically or manually in response to specific security incidents or events. These playbooks outline the steps to be taken to investigate, mitigate, and remediate security threats or breaches effectively and efficiently. They typically include a sequence of actions, such as gathering additional information, analyzing logs or data, notifying relevant stakeholders, applying containment measures, and initiating remediation actions. While creating a security playbook is a useful measure in reducing suspicious emails flood, some additional steps must occur, before a security playbook can start running.


---

### References

[Email analysis in investigations for Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/email-analysis-investigations)  

[Automated investigation and response (AIR) in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/air-about)    

[Investigating Alerts in Defender for Office 365]()

---

## Q009-Q012:

> General Backgrounf

You work at a company that specializes in managing information systems. The company's main office is based in your region and has several branches outside your country. The company uses Microsoft Sentinel.

> Current Environment

- A user in the IT department has created a storage account in Azure for their own personal use without their coordinator noticing.

- A member of the accounting team reports that several workbooks related to customers' data have been deleted in the Microsoft Sentinel workspace of the company.

- A member of the IT department reports that five incidents of high severity occurred in the past week.

- A new employee starts working at your company. You create a new account for the employee in Microsoft Entra ID. A colleague of the new employee reports that the new employee created a role assignment the moment they started working on their company device.

> New Environment

- An analytics rule should be created where the rule query logic will alert the IT coordinator when any user creates a storage account.

- The manager wants to view all delete operations performed in the company's Microsoft Sentinel workspace.

- The manager wants to run an investigation about the incidents occurring within the past 10 days so better analysis can be achieved.

- The manager wants to know when any new user in Microsoft Entra ID creates a role assignment.

---

## Q012:

You need to create a query for the rule logic to alert the IT coordinator when a storage account is created, as requested.
How should you complete the query? To answer, complete the commands by selecting the correct parts from the drop-down menus.

OPT1:
OperationName
Update Case Comments
Update Cases

OPT2:
ActivityStatusValue
OperationName
Update Settings

```
AzureActivity
| where [OPT1] == "Create Storage Account"
| where [OPT2] == "Succeeded"
| make-series dcount (ResourceId) default=0 on EventSubmissionTimestamp
in range (ago (7d), now(), 1d) by Caller
```

```
AzureActivity
| where OperationName == "Create Storage Account"
| where ActivityStatusValue == "Succeeded"
| make-series dcount (ResourceId) default=0 on EventSubmissionTimestamp
in range (ago (7d), now(), 1d) by Caller
```

---

### Answer:

You should complete the query as follows:

```
AzureActivity 
| where OperationName == "Create Storage Account 
| where ActivityStatusValue == "Succeed"
| make-series dcount (Resourceld) default=0 on EventSubmissionTimestamp in range (ago (7d), now(), id) by Caller
```

You should use OperationName in the first line. This expression is a required expression in the query for the
rule being created. OperationName is the expression that is used to define the operation that the IT
coordinator should be notified about. You can see that the expression is followed by the Create Storage Account expression, so the coordinator will be notified upon the creation of a storage account, as requested.
You should not use Update cases in the first line. This expression defines the action of updating a case when you investigate it. This is part of the Security Insights category, not Azure Activity.
You should not use Create case comments in the first line. This expression defines the action of creating comments for cases being investigated, which is a beneficial activity while investigating a case. This activity is also part of the Security Insights category and not Azure Activity.
You should use Activity Status Value in the second line. This expression is required in the above query to define if the activity performed by the user succeeded and, for example, if account storage is created. In such a way, the rule would detect that the activity has been done successfully in order to inform the IT coordinator about it. The Activity Status Value expression can be followed by succeeded or failed expressions. The last portion of the provided query is also required to count all the records within your Azure that match the conditions you specify related to the defined activity of creating a storage account during the specified time frame.
You should not use OperationName in the second line. This expression is used to define the activity performed by a user, as seen in the first line. There is no 'succeeded' operation or activity in the query.
You should not use Update settings in the second line. This expression defines the activity of updating settings in Security Insights. It cannot be used here for two reasons: the first is that this is not the required activity, and the second is that this expression cannot be used to define if the operation succeeded or not.

---

### References

[Audit Microsoft Sentinel queries and activities](https://learn.microsoft.com/en-us/azure/sentinel/audit-sentinel-data)  
[Azure Sentinel Create custom analytics rules to detect threats](https://connectioncloudsupport.zendesk.com/hc/en-us/articles/900006664846-Azure-Sentinel-Create-custom-analytics-rules-to-detect-threats#:~:text=Azure%20Sentinel%20-%20Create%20custom%20analytics%20rules%20to,5%20View%20the%20rule%20and%20its%20output%20)  

---

## Q011:

You need to use the AzureActivity table query to fulfill the manager's request of viewing delete operations.

```
AzureActivity
| where OperationNameValue contains "?"
| where OperationName contains "?"
| where ActivityStatusValue contains "Succeeded"
```

Which two sections of code should you use to complete the query? 
Each correct answer presents part of the solution.

- ago(1d)
- SecurityInsights
- Delete alert rules
- Delete data connectors
- Delete workflow
- Delete

---

### Answer:
- SecurityInsights
- Delete

You should complete the query as follows:

1. AzureActivity
2. | where OperationNameValue contains "SecurityInsights"
3. | where OperationName contains "Delete"
4. | where ActivityStatusValue contains "Succeeded"

You should use SecurityInsights in line 2. This filter condition narrows down the results to only those logs where the OperationNameValue field contains the term SecurityInsights. This ensures that only activities related to security insights are included in the results.
Additionally, you should use Delete in line 3. This further filters the logs to only include records where the Operation Name field contains the term Delete. This filters for delete operations specifically, such as deleting resources or configurations related to security insights.
You should not use ago(1d). This expression is used to define time. This expression could be used in another query that states, for example, the operations carried out in the workspace in the past 24 hours. In this scenario, you need to define where you can view delete operations.
You should not use Delete workflow. This expression defines the activity of deleting a workflow in Microsoft Sentinel performed by a user. This expression is not related to deleting a workbook. Workflows in Microsoft Sentinel are created for several reasons, such as to create an automated response for alerts where Microsoft Sentinel acts upon suspicious activity done by a user.
You should not use Delete data connectors. This expression is related to the operation of deleting a data connector. Data connectors are used to connect data resources with each other upon implementing Microsoft Sentinel. This operation is not mentioned in the scenario.
You should not use Delete alert rules. This expression is related to deleting alert rules. Alert rules are configured within analytics rules to alert the user when a match occurs. Analytic rules detect and identify threats by matching the presence of signs and signals that impact the existence of a cyber-attack. They can also identify the origin of a cyber-attack and the potential loss of data that occurred due to the attack. This is not a mentioned requirement in the scenario.


---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  
[Audit Microsoft Sentinel queries and activities](https://learn.microsoft.com/en-us/azure/sentinel/audit-sentinel-data)  

---

## Q010:

You need to find a solution that provides data for the manager about creating new role assignments.
What action should you perform?

- Use the SecurityIncident table in Microsoft Sentinel.
- Use data retention in Microsoft Defender for Endpoint.
- Use a Windows Security Events connector.
- Use Azure Lighthouse.

---

### Answer:
- Use the SecurityIncident table in Microsoft Sentinel.

You should use the SecurityIncident table in Microsoft Sentinel. This table is found in the Logs section in Microsoft Sentinel, where you can view all the incidents that are created or updated, including those related to creating role assignments by new users. This meets the scenario requirement. Every time an incident is created or updated, a new log is added to the SecurityIncident table.
You should not use data retention in Microsoft Defender for Endpoint. Data retention is used for retaining data, like documents and files, that you need, and getting rid of items that you do not need. Data retention cannot be used to view the logs of creating a new role assignment.
You should not use Azure Lighthouse. Azure Lighthouse is a solution that allows you to manage an Microsoft Sentinel workspace outside your tenant. Microsoft Sentinel is a security information event management (SIEM) system that provides security analytics for companies. Azure Lighthouse will not provide data about creating new role assignments.
You should not use a Windows Security Events connector. Windows Security Events connector is used to stream security events from any Windows server linked with your Microsoft Sentinel workspace. Nothing in the scenario mentions a Windows server.


---

### References

[Manage your SOC better with incident metrics](https://learn.microsoft.com/en-us/azure/sentinel/manage-soc-with-incident-metrics)  

[Configure general Defender for Endpoint settings](https://learn.microsoft.com/en-us/defender-endpoint/preferences-setup)  

[Using Azure Lighthouse and Microsoft Sentinel to Investigate Attacks Across Multiple Tenants](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/using-azure-lighthouse-and-azure-sentinel-to-investigate-attacks/ba-p/1043899)  

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference?tabs=LAA)  

---

## Q009:

You need to recommend a solution that enables you to run an investigation as required by the manager.

Which solution should you recommend?

- Create a hunting bookmark.
- Use Microsoft Graph.
- Create a workbook in Microsoft Sentinel.
- Use Data Loss Prevention (DLP) Policies.

---

### Answer:
- Create a workbook in Microsoft Sentinel.

You should recommend creating a workbook in Microsoft Sentinel. Workbooks in the Azure portal provide a broad canvas for data analysis and the production of sophisticated visual reports. They enable you to connect to numerous data sources throughout Azure and integrate them into cohesive interactive experiences. In addition to that, they use queries to run investigations related to incidents occurring in the company within a defined time frame, such as 10 days before the incident occurred. This option meets the scenario requirement.
You should not recommend creating a hunting bookmark. Hunting bookmarks are a Microsoft Sentinel tool that allow you to preserve queries that have already run in the Microsoft Sentinel - Logs service, in addition to the query results. This solution also allows you to add notes and tags in order to record your contextual observations for incidents. This does not meet the scenario requirement.
You should not recommend using Data Loss Prevention (DLP) policies. Using a DLP policy will allow you to ban the accidental sharing of sensitive information with people outside the organization. DLP can display a pop-up tip to employees to warn them about possible attempts to share sensitive data with people outside the organization. This solution does not allow you to run an investigation as required by the manager.
You should not recommend using Microsoft Graph. Microsoft Graph is a tool that enables users to create solutions that are authenticated once and use a single API call to act on security insights from security solutions. It does not allow you to run an investigation as required by the manager.

---

### References

[Visualize collected data](https://learn.microsoft.com/en-us/azure/sentinel/get-visibility)  

[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  

[Learn about Endpoint data loss prevention](https://learn.microsoft.com/en-us/purview/endpoint-dlp-learn-about?view=o365-worldwide)  

[Keep track of data during hunting with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/bookmarks)  

---

## Q006-Q008:

Your organization is a Managed Service Provider (MSP) tasked with managing Microsoft Sentinel workspaces for multiple customers. Many customers require the management of multiple workspaces for different environments or business units.
You need to manage Microsoft Sentinel workspaces across multiple Microsoft Entra tenants. The precise control over the delegated scopes and allowed permissions for each customer must be maintained.

---

## Q008:

Solution: Extend Microsoft Sentinel accross workspaces

Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. While extending Microsoft Sentinel across workspaces enables a unified incident view across multiple workspaces, and facilitating centralized management and monitoring of incidents, it operates seamlessly within a single Microsoft Entra tenant.

---

### References

[Extend Microsoft Sentinel across workspaces and tenants](https://learn.microsoft.com/en-us/azure/sentinel/extend-sentinel-across-workspaces-tenants)  

---

## Q007:

Solution: Use workspace manager

Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Workspace Manager is a feature within the Microsoft Sentinel service that enables organizations to manage multiple workspaces for different environments or business units within a single Microsoft Entra tenant.

---

### References

[Centrally manage multiple Microsoft Sentinel workspaces with workspace manager](https://learn.microsoft.com/en-us/azure/sentinel/workspace-manager) 

---

## Q006:

Solution: Use Azure Lighthouse

Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. Azure Lighthouse is a suitable solution for managing Microsoft Sentinel workspaces across multiple Microsoft Entra tenants. Azure Lighthouse allows Managed Service Providers (MSPs) to manage customers' Azure resources from their own Microsoft Entra tenant, including Microsof Sentinel workspaces. With Azure Lighthouse, precise control over the delegated scopes and allowed permissions for each customer is maintained.

---

### References

[What is Azure Lighthouse?](https://learn.microsoft.com/en-us/azure/lighthouse/overview)  

---

## Q001-Q005:

> Overview

You are a Security & Compliance Analyst for CompanyA, which has an existing Microsoft 365 tenant. CompanyA has recently migrated its services to Microsoft 365 and is using the following services:

- Microsoft Entra ID to manage identity
- OneDrive for Business to facilitate users' home folders
- Exchange Online for email services
- SharePoint Online for document management
- Microsoft Teams to facilitate collaboration between internal teams and external partners

Now that the services are active, your organization has asked you to look at deploying Microsoft Defender for Endpoint to help to protect and remediate security issues on end-user devices. As the Security & Compliance Analyst, you are responsible for managing the security and compliance posture of the tenant.

> Existing Environments

The following table shows details of Microsoft Defender for Endpoint permissions for users:

|   Username  | Permissions |
|------------ | ----------- |
| AdminA@companyA.com  | Full access |
| AdminB@companyA.com  | Read-only Access |
| AdminC@companyA.com  | Read-only access |
| AdminD@CompanyA.com  | Full access |


The following table shows the end-user device details:

| Device Type | Operating System | OS Version | No. of devices |
|-------------|------------------|------------|----------------|
| Laptop      | Windows 10       | 1511       | 150 |
| Laptop      | Windows 10       | 1607       | 850 |
| Desktop     | Windows 10       | 1511       | 200 |

- Old third party antivirus has been removed from Desktop devices and substituted with Microsoft Defender Antivirus.
- Microsoft Defender Antivirus has recently been deployed to all Laptop Windows 10 OS devices.
- Cloud-based protection is enabled.
- The Microsoft Defender for Endpoint blocking file features are configured.

The following table shows the device browser details:


| Operating System  | No. of Devices  | Installed Browser Details|
|-------------------|---------------------|----------------------|
| Windows 10        | 150  | Microsoft Edge, Mozilla Firefox     |
| Windows 10        | 850  | Google Chrome, Mozilla Firefox      |
| Windows 10        | 200  | Mozilla Firefox                     |

- All users have the Microsoft Defender for Endpoint Plan 2 license.
- All installed browsers are configured with Internet browsing proxy settings.
- All users can access to the internet using respective browser installed on their systems.

> Requirements:

- AdminC is new to the team and requires the relevant permissions to be assigned.
- You need to ban potentially malicious files or suspected malware.
- You need to onboard all end-user devices into the Defender for Endpoint portal.
- You need to implement real-time endpoint detection and built-in remediation via Intune to add an additional layer of protection to devices.
- You need to configure device isolation to help to prevent attackers from being able to control devices.

---

## Q005:

AdminD configures device isolation on the end-user devices. However, during testing you find that it is not working on any of the devices.
What is the cause for the device isolation failing to work?

- The Windows 10 devices need to be upgraded to Windows 11.
- You need a Microsoft 365 E5 license.
- The Windows 10 devices need to be version 1703 or later.
- AdminD needs elevated permissions to the Microsoft Defender for Endpoint portal.

---

### Answer:
- The Windows 10 devices need to be version 1703 or later.

Windows 10 devices need to be version 1703 or later. Full isolation of devices is available for devices running Windows 11, Windows 10, version 1703 or later, Windows Server 2022, Windows Server 2019, and Windows Server 2016.
The fact that AdminD requires elevated permissions to the Microsoft Defender for Endpoint portal is not the cause of the issue. As shown in the permissions table, AdminD has full access, which will allow them to successfully implement device isolation.
Windows 10 devices does not need to be upgraded to Windows 11. Although this would resolve the issue, it is not a requirement, as the devices need to be Windows 10 version 1703 or later. Upgrading to Windows 11 would be an option but not a requirement.
You do not need a Microsoft 365 E5 license. As shown in the Existing Environment section, users currently have Microsoft Defender for Endpoint Plan 2, which is sufficient to allow the implementation of device isolation.

---

### References

[Take response actions on a device](https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts?view=o365-worldwide)  


---

## Q004:

Once the end-user devices have been correctly onboarded, you need to configure additional capabilities to meet the business requirements.
Which capability should you configure to add the requirement for an additional layer of protection to devices?

- Next-Generation Protection (NGP)
- Microsoft Defender Vulnerability Management
- Microsoft Defender Experts capability
- Attack Surface Reduction

---

### Answer:
- Microsoft Defender Vulnerability Management

You should configure Microsoft Defender Vulnerability Management to meet the requirements for real-time endpoint detection and built-in remediation via Intune. This is a component of Defender for Endpoint that provides admins and operators with many features including built-in remediation.
You should not configure Next-Generation Protection (NGP) to meet the requirements for real-time endpoint detection and built-in remediation via Intune. NGP is a feature of Microsoft Defender Antivirus that enables next generation protection of end-user devices. As the requirement is for real-time endpoint detection and built-in remediation via Intune, NGP does not allow to facilitate these specific requirements.
You should not configure Attack Surface Reduction to meet the requirements for real-time endpoint detection and built-in remediation via Intune. Attack Surface Reduction enables attack surface reduction capabilities in Defender for Endpoint to help protect devices and application from new emerging threats. As the requirement is for real-time endpoint detection and built-in remediation via Intune, Attack Surface
Reduction does not allow to facilitate these specific requirements.
You should not configure Microsoft Defender Experts capability to meet the requirement for real-time endpoint detection and built-in remediation via Intune. This is a managed hunting service that enables SOC team's expert level monitoring and analysis to assist them with critical threats.

---

### References

[Configure Microsoft Defender for Endpoint capabilities](https://learn.microsoft.com/en-us/defender-endpoint/onboard-configure?view=o365-worldwide)  


---

## Q003:

AdminD is working on onboarding all end-user devices in the Microsoft Defender for Endpoint portal. However, they find that 200 of the devices are not being displayed in the portal. You need to investigate the issue.

Which two actions should you perform to successfully onboard end-user devices in the Microsoft Defender for Endpoint? Each correct answer presents part of the solution.

- Ensure the devices have an internet connection.
- Verify the Microsoft Windows HTTP (WinHTTP) settings.
- Ensure that Microsoft Defender Antivirus is not disabled by a policy.
- Ensure Google Chrome is installed.
- Ensure Internet Explorer is installed.

---

### Answer:
- Verify the Microsoft Windows HTTP (WinHTTP) settings.
- Ensure that Microsoft Defender Antivirus is not disabled by a policy.

You should Verify the Microsoft Windows HTTP (WinHTTP) settings. WinHTTP provides a standardized interface to send HTTP and HTTPS requests and receive responses from web servers. In order to report sensor data and communicate with the Microsoft Defender for Endpoint service, the use of Microsoft Windows HTTP (WinHTTP) is required by the sensor of Microsoft Defender for Endpoint. Because WinHTTP operates independently from the proxy settings used for internet browsing and other applications that are context-dependent, it is necessary for WinHTTP to identify the available proxy servers within the specific environment it is being used in.
You should also ensure that Microsoft Defender Antivirus is not disabled by a policy. To function correctly, the Microsoft Defender for Endpoint agent requires the Early Launch Antimalware (ELAM) driver to be activated. It is important to confirm that a system policy has not disabled it. Depending on the policy implementation tool being used, it is necessary to check that the Windows Defender policies listed below are not enabled:

- DisableAntiSpyware
- Disable AntiVirus

Because old third party antivirus has been removed from Desktop devices and substituted with Microsoft Defender Antivirus, it is possible, that the above mentioned policies are still activated as a previous requirement for removed third party antivirus software. As such, the policy have to be verified and disabled.
You should not ensure that devices have internet connection. According to the Existing environment section, all users can access the internet using respective browser installed on their systems.
You should not ensure that any specific browser is installed. Onboarding into Microsoft Defender for Endpoint does not specify any specific browser requirements. Specific browser only required to access Microsoft Defender for Endpoint administration portal, but not for onboarding.

---

### References

[Troubleshoot Microsoft Defender for Endpoint onboarding issues](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-onboarding)  

[About WinHTTP](https://learn.microsoft.com/en-us/windows/win32/winhttp/about-winhttp)  

[Minimum requirements for Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/minimum-requirements?view=o365-worldwide)  

---

## Q002:

You need to use PowerShell to assign AdminC the relevant permissions to the Microsoft Defender for Endpoint portal.
Which cmdlets should you use? To answer, complete the commands by selecting the correct options from the drop-down menus.

OPT1:

Add-MsolRoleMember
Get-MsolRoleMember
Add-MsolGroupMember
New-MsolUser

OPT2:

"Security Reader"
"Compliance Reader"
"Security Operator"
"Security Administrator"

OPT3:

-RoleMemberEmailAddress
-RoleMemberType
-RoleMemberObjectId
-TenantId

```
[OPT1] -RoleName [opt2] [OPT3] "AdminC@companyA.com"
```

---

### Answer:

```
Add-MsolRoleMember -RoleName "Security Reader" `
-RoleMemberEmailAddress  "AdminC@companyA.com" 
```

You should complete the PowerShell cmdlet as follows:

```
Add-MsolRoleMember -RoleName "Security Reader" -RoleMemberEmailAddress "AdminC@companyA.com"
```

You need to use the Add-MsolRoleMember cmdlet. This allows you to add a user with an administrator role. In this case, you need to grant AdminC read only permissions. Therefore, you should use the 'Security Reader' RoleName parameter. Finally, you need to use the - RoleMemberEmailAddress parameter to specify AdminC's email address so that the permissions are granted to them.
You should not use the Add-MsolGroupMember cmdlet, as this adds users to an existing security group. The Get-Msol RoleMember group should not be used as this only gives you information on a specific role, rather than allowing you to assign permissions. The New-MsolUser should not be used as this allows you to create a new user in Azure AD, rather than adding elevated permissions to a user.
You should not use the 'Security Administrator' parameter, as this would grant AdminC full access to the Microsoft Defender for Endpoint portal. The 'Security Operator' role would also give AdminC more elevated permissions than read only. The 'Compliance Admin' role would give AdminC access to the Microsoft Purview Compliance portal, not the Microsoft Defender for Endpoint portal.
You should not use the -Tenantld, RoleMember Objectld or the RoleMemberType parameter, as these parameters would not assign the relevant permissions to the user via the email address that has been used in the cmdlet.

---

### References

[Use basic permissions to access the portal](https://learn.microsoft.com/en-us/defender-endpoint/basic-permissions?view=o365-worldwide)  

Add-MsolRoleMember
Add-MsolGroup Member
Get-MsolRoleMember
New-MsolUser

---

## Q001:

AdminA tries to implement indicators for files in order to ban potential malicious files or suspected malware However, you find that it does not work on the existing user devices.

Which action should you take to implement indicators for files? 
You need to minimize administrative effort.

- Upgrade Windows 10 to Windows 11.
- Upgrade Windows 10 to version 1703 or later.
- Give AdminA more elevated permissions.
- Upgrade Microsoft Defender Antivirus to client version 4.18.1901.x or later.

---

### Answer:
- Upgrade Windows 10 to version 1703 or later.

You should upgrade Windows 10 OS to version 1703 or later. A prerequisite of implementing indicators for files is that end-user devices are required to be Windows 10, version 1703 or later. The Windows Server supported OS are Server 2016 and 2019.
You should not upgrade Windows 10 to Windows 11. Although this would resolve the issue, upgrading Windows 10 to Windows 11 would create additional administrative effort compared to upgrading the Windows 10 OS version, which is a simple Windows update.
You should not upgrade Microsoft Defender Antivirus to client version 4.18.1901.x or later. As highlighted in the existing environment section, Microsoft Defender Antivirus has recently been installed. The latest
versions are more recent than version 4.18.1901.x.
You should not elevate AdminA's permissions. AdminA currently has full access to the Microsoft Defender for Endpoint portal, which grants them the relevant permissions to implement indicators for files.

---

### References

[Manage indicators](https://learn.microsoft.com/en-us/training/modules/configure-settings-for-alerts-detections-microsoft-defender-for-endpoint/5-manage-indicators)  

---