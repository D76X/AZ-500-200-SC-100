# SC-300 Practice Test 155 Questions

[Microsoft Certified: Security Operations Analyst Associate](https://learn.microsoft.com/en-us/credentials/certifications/security-operations-analyst/?practice-assessment-type=certification)  

---

## Q07X:

---

### Answer:

---

### References

---

## Q075:

---

### Answer:

---

### References


---

## Q074:

Your organization has an Azure subscription that uses Microsoft Sentinel.
You are manually creating a Microsoft Sentinel hunting query.
You have chosen to use an Advanced Security Information Model (ASIM) normalization schema for using filtering parsers in your queries, in order to improve their performance.
You need to use schemas that support filtering parameters.

Which four ASIM normalization schemas could you select? Each correct answer presents part of the solution.

Choose the correct answers

- DHCP
- Web Session
- Authentication
- Network Session
- DNS
- File
- User Management

---

### Answer:

- Web Session
- Authentication
- Network Session
- DNS

Choosing to use an Advanced Security Information Model (ASIM) parser instead of table names in your Microsoft Sentinel queries allows you to view data in a normalized format and to include all data relevant to the schema in your query. In this scenario, you have chosen to use the ASIM normalization schema, which enables you to use filtering parsers in your queries. ASIM normalization schemas are in the public preview phase at the time of writing. It is important to note that an analyst is currently considering building a solution to utilize the ASIM schema for a filtering parser. In this scenario, all four schemas must be taken into account. Using the wrong schema will disrupt the parser's functionality. 

The following ASIM normalization schemas support filtering the following parameters:

1. The Authentication normalization schema should be used when your aim is to describe events related to user authentication, such as sign-ins and sign-outs. Authentication events are sent by many reporting devices, usually as part of the event stream alongside other events. For example, the below allows you to filter only authentication events from the last two days for a specific user called "sugh":

`imAuthentication (targetusername has = 'sugh', starttime endtime=now()) ago (2d), endtime=now())`

2. The DNS normalization schema is used to describe events reported by a DNS server or a DNS security system and is used by Microsoft Sentinel to enable source-agnostic analytics. For example, the below allows you to filter only DNS queries from the past three days that failed to resolve the domain name:

`Im Dns (responsecodename = 'NXDOMAIN', starttime ago (3d), endtime=now())`

3. The Network Session normalization schema represents an IP network activity, such as network connections and network sessions. Operating systems, routers, firewalls, and intrusion prevention systems report incidents related to this normalization schema. For example, the below allows you to filter only network sessions for a specified list of domain names:

`let torProxies=dynamic(("myTor1.com", "myTor2.com"]); (hostname_has_any torProxies) Im NetworkSession (hostname_has_any = torProxies)`

4. The Web Session normalization schema is used to describe an IP network activity. For example, IP network activities are reported by web servers, web proxies, and web security gateways.

You should not use the DHCP normalization schema. The DHCP normalization schema is used to describe
events reported by a DHCP server and is used by Microsoft Sentinel to enable source-agnostic analytics.
The DHCP schema does not support an ASIM filtering parser, which is what is required in this scenario.

You should not use the File Event normalization schema because it does not support an ASIM filtering parser. The File Event normalization schema is used to describe file activity such as creating, modifying, or deleting files or documents. Such events are reported by operating systems and file storage systems, such as Azure Files, and document management systems such as Microsoft SharePoint.

You should not use the User Management normalization schema. The user Management normalization schema is used to describe user management activities, such as creating a user or a group, changing a user attribute, or adding a user to a group. Operating systems, directory services, identity management systems, and any other system reporting on its local user management activity usually report these incidents. The User Management schema does not support an ASIM filtering parser.

---

### References


[Using the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers)  
0
[List of Microsoft Sentinel Advanced Security Information Model (ASIM) parsers (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-parsers-list)

[The Advanced Security Information Model (ASIM) Authentication normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-authentication)  

[The Advanced Security Information Model (ASIM) DNS normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-dns)  

[The Advanced Security Information Model (ASIM) Network Session normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-network)  

[The Advanced Security Information Model (ASIM) Web Session normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-web) 

[The Advanced Security Information Model (ASIM) DHCP normalization schema reference (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-dhcp)  

[Microsoft Sentinel user management normalization schema reference (preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-user-management)  

[Modify content to use the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-modify-content)  

---

## Q073:

You have an Azure subscription that uses Microsoft Sentinel.
You are developing an Advanced Security Information Model (ASIM) parser which will view data in a normalized format and retrieve all of the data relevant to the schema in a single query.
You need to map an original field to its normalized name.

Which operator should you use?

Choose the correct answer

- project-rename
- project-reorder
- project-keep
- project-away

---

### Answer:

- project-rename

You should use the project-rename operator to map an original field to its normalized name. This operator ensures that the field is still managed as a physical field and that handling the field is more performant. A usage example would be: T❘ project-rename new_column_name = column_name, wherein T is the name of the input table.
You should not use the project-reorder operator. This operator reorders columns in the result output. It cannot be used to map an original field and rename it to its normalized field. For example, you could use T project-reorder col1, col2, col3 asc, wherein T is the name of the input table, to reorder columns col1, col2 and col3 in ascending order.
You should not use the project-away operator. This operator selects which input columns should be excluded from the output. It cannot be used to map an original field and rename it to its normalized field. An usage example would be T❘ project-away ColumnName OrPattern [....], wherein T is the name of the input table and ColumnName OrPattern denotes the column name or pattern which will be excluded from the output.

You should not use the project-keep operator. This operator uses a columnname pattern matcher to select which columns from the input will be kept in the output. It cannot be used to map an original field and rename it to its normalized field.

---

### References

[Using the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers)  

[Modify content to use the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-modify-content)  

[project-rename](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/project-rename-operator)  

project-reorder
project-keep
project-away

---

## Q072:


You have an Azure subscription that uses Microsoft Sentinel.
You are trying to view data in a normalized format and get all of the data that is relevant to the schema in a single query.
You have written the following query:

```
Im_Dns (responsecodename='NXDOMAIN') summarize count() by SrcIpAddr, bin (TimeGenerated, 5m) I where count > threshold | join kind=inner (imDns (responsecodename='NXDOMAIN')) on SrcIpAddr extend timestamp TimeGenerated, IPCustomEntity = SrcIpAddr
```

For each of the following statements, select Yes if the statement is true. Otherwise, select No.

The query uses a built-in Advanced Security Information Model (ASIM) parser.
Yes

The query uses a filtering parser.
Yes

SrclpAddr can be replaced with Client_IP in the query.
No

---

### Answer:

The query uses a built-in Advanced Security Information Model (ASIM) parser. Advanced Security Information Model (ASIM) parsers allow you to use built-in parsers instead of table names in your Microsoft Sentinel queries. They enable you to view data in a normalized format and to include all data relevant to the schema in a query. At the time of writing, Advanced Security Information Model (ASIM) is in public preview.
The query uses a filtering parser. A non-filtering parser would have used the same query with a WHERE clause for checking conditions. Using normalized filtering parsers produces shorter ASIM schema queries, therefore making the writing process more efficient. Microsoft recommends always leveraging ASIM filtering parsers, since they perform better than workspace non-filtering parsers.
The SrclpAddr field cannot be replaced with Client_IP. Since the query is leveraging a built-in ASIM parser, it uses the SrclpAddr field. You could only use a Client IP field if you were using a workspace-deployed ASIM parser.

---

### References

[Using the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers)  

[Modify content to use the Advanced Security Information Model (ASIM) (Public preview)](https://learn.microsoft.com/en-us/azure/sentinel/normalization-modify-content)  

---

## Q071:

You have an Azure subscription that uses Microsoft Sentinel.
You are optimizing the way Microsoft Sentinel identifies entities in alerts from different types of data sources.
You need to implement strong identifiers for the host entity type.

Which three identifier options should you select? 
Each correct answer presents part of the solution.

Choose the correct answers

- HostName and DnsDomain
- OMSAgentID
- OSFamily
- AzurelD
- HostName
- DnsDomain
- FullName

---

### Answer:

- HostName and DnsDomain
- OMSAgentID
- AzurelD

Microsoft Sentinel supports a wide range of entity types, each with their own unique attributes. Some of these attributes can be leveraged to identify a specific entity. These attributes are represented as fields in the entity and are called identifiers. There are three kinds of identifiers: identifiers, required identifiers, and strongest identifiers. The core difference between a weak identifier and a strong identifier is the fact that a strong identifier can uniquely identify an entity without any ambiguity, whilst a weak identifier can only identify an entity under certain circumstances and cannot be guaranteed to uniquely identify an entity in all cases. For best results in terms of guaranteed unique identification, it is Microsoft's recommendation that you should always use identifiers from the strongest identifiers column, whenever possible. In this scenario, you need to select the recommended strongest identifier for the host entity type. You should therefore select the following:
1. HostName and DnsDomain: HostName represents the host name without the domain suffix. DnsDomain represents the DNS domain that this host belongs to. Hostname and DnsDomain in themselves are simple identifiers, with HostName being a required identifier as well. However, combining HostName and DnsDomain for a host gives a unique value that can identify an entity without any ambiguity. Therefore, in the given list of identifiers, this is an example of a strongest identifier.
2. AzureID: This value represents the Azure resource ID of the virtual machine (VM), if known. AzurelD gives a unique value that can identify an entity without any ambiguity, thereby making it an example of a strongest identifier.
3. OMSAgentID: This value represents the Operations Management Suite (OMS) agent ID, if the host has the OMS agent installed. OMSAgentID gives a unique value that can identify an entity without any ambiguity and it is therefore an example of a strongest identifier.
You should not select DnsDomain. Dns Domain represents the DNS domain that this host belongs to. By itself, as a standalone identifier, it is not a strongest identifier.
You should not select HostName. HostName represents the hostname without the domain suffix. As with DnsDomain, it is not a strongest identifier by itself.
You should not select OSFamily. OSFamily represents any of the following four values: Linux, Windows, Android, or IOS, which represent the host operating system. By itself, it is not a strongest identifier.
You should not select FullName. FullName is in fact, not part of schema, and is only included for backward compatibility with old versions of entity mapping in Microsoft Sentinel. By itself, it is not a strongest identifier.

---

### References

[Classify and analyze data using entities in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/entities)  
[Microsoft Sentinel entity types reference](https://learn.microsoft.com/en-us/azure/sentinel/entities-reference)  

---

## Q070:

You are currently using Microsoft Sentinel for the collection of Windows security events. You want to use Microsoft Sentinel to identify Remote Desktop Protocol (RDP) activity that is unusual for your environment.
You need to enable the Anomalous RDP Login Detection rule.
What two prerequisites do you need to ensure are in place before you can enable this rule? Each correct answer presents part of the solution.

Choose the correct answers

- Let the machine learning algorithm collect 30 days' worth of Windows Security events data.
- Select an event set other than None.
- Collect Security events or Windows Security Events with Event ID 4720.
- Collect Security events or Windows Security Events with Event ID 4624.


---

### Answer:

One of the best features of a Security information and event management (SIEM) tool like Microsoft Sentinel is correlating important data and finding events that deserve your attention. The Anomalous Remote Desktop Protocol (RDP) Login Detection rule does just that. Enabling this rule requires two prerequisites:
You should collect Security events or Windows Security Events with Event ID 4624. This is the event ID for an account successfully logging on to a machine/system. This covers many login types, including RDP. Without this data, Microsoft Sentinel would be blind to RDP logins entirely. This process would be completed in the Security Events Data Connector or Windows Security Events Data Connector pages within Microsoft Sentinel.
You should also select an event set other than None. This configuration step is completed during the data connector implementation described above. This step ensures that the aforementioned connector is actually passing data. Options other than None include All events, Common, and Minimal. Although the None event set may seem counterintuitive, it can be used to disable a connector without deleting/removing it. This can be helpful in certain troubleshooting scenarios.

You should not collect Security events or Windows Security Events with Event ID 4720. This is the Event ID for the creation of a user account, not for logging on to a machine or system. While it may seem picky to expect a security professional to memorize exact event IDs, it is incredibly helpful to recognize some of the most common ones. Logins (4624) and user creation (4720) are two that are very useful to know in the event of conducting time sensitive research of a potential compromise and privilege escalation/account creation incident response (IR) scenario.
You should not let the machine learning algorithm collect 30 days' worth of Windows Security events data. This is, however, a very important time frame as regards the time after you enable the rule. This rule relies on a machine learning algorithm that ultimately requires 30 days' worth of data before it can build a baseline. This baseline is a profile of your company's normal user behavior, so you need to allow 30 days of Windows Security events data to be ingested before the rule will result in the discovery of any incidents. Remember, however, that the scenario only refers to the process required to enable the rule and not the generation of incidents thereafter.
Finally, the actual process to enable the rule after these prerequisites are set is fairly simple. Starting in the Microsoft Sentinel portal, you should click Analytics, and then click the Rule templates tab. Next, you must choose the (Preview) Anomalous RDP Login Detection rule and simply move the Status slider from Disabled (the default) to Enabled.

---

### References

[Configure the Security Events or Windows Security Events connector for anomalous RDP login detection](https://learn.microsoft.com/en-us/azure/sentinel/configure-connector-login-detection)  

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference)  

[What's New: Azure Sentinel Machine Learning Behavior Analytics: Anomalous RDP Login Detection](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/what-s-new-azure-sentinel-machine-learning-behavior-analytics/ba-p/1521988)  

---

## Q069:

An employee reports that their data was compromised through a cyber-attack.
You need to implement a solution that detects the origin of the attack and identifies the potential data loss.

Which solution should you recommend?

Choose the correct answer

- Cloud Connectors in Microsoft Defender for Cloud
- Data Loss Prevention (DLP) policies
- Sensitivity labels
- Analytics rules in Microsoft Sentinel

---

### Answer:
- Analytics rules in Microsoft Sentinel

You should recommend analytics rules in Microsoft Sentinel. This solution can detect and identify threats by matching the presence of signs and signals that impact the existence of a cyber-attack. Using this solution, you can identify the origin of a cyber-attack and the potential loss of data that occurred due to the attack. In addition, analytics rules in Microsoft Sentinel allow you to view the timeline of the incident, in which you can review the severity of the incident and a brief description of it.
You should not recommend Cloud Connectors in Microsoft Defender for Cloud. Microsoft Defender for Cloud Connectors help organizations improve their security posture by enabling them to leverage the power of Microsoft Defender for Endpoint and other security solutions in a more integrated and seamless manner by helping to ingest log data into Microsoft Defender for Cloud workspace. The connectors themselves cannot detect and identify threats.
You should not recommend Data Loss Prevention (DLP) policies. DLP policies are a solution that bans the accidental sharing of sensitive information with people outside the organization. They cannot detect the origin of a cyber-attack nor the potential data loss resulting from it.

You should not recommend sensitivity labels. Sensitivity labels allow you to protect and classify the company's data while making sure employees can collaborate effectively. When a sensitivity label is applied to content, it can restrict access to content by adding a mark to a specific document, like watermarks applied on documents, or by using encryption.

---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  

[Using Azure Lighthouse and Microsoft Sentinel to Investigate Attacks Across Multiple Tenants](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/using-azure-lighthouse-and-azure-sentinel-to-investigate-attacks/ba-p/1043899)  

[Learn about sensitivity labels](https://learn.microsoft.com/en-us/purview/sensitivity-labels)  

[Get started with the data loss prevention alerts](https://learn.microsoft.com/en-us/purview/dlp-alerts-get-started)  

[Microsoft Defender for Cloud Recommendation.](https://learn.microsoft.com/en-us/connectors/ascassessment/)  


---

## Q068:

You administer Microsoft Defender XDR for your organization. You configure the Microsoft Defender XDR deception capability to increase the confidence of detections of human-operated lateral movement.
You need to correctly identify the components of the deception feature to manually create a deception rule.
Which components should you identify? To answer, drag the appropriate component to its description. A component may be used once, more than once, or not at all.

Drag and drop the answers

Lure
Decoy

Fake devices : Decoy
Fake accounts: Decoy
Fake documents: Lure
Fake cached credentials : Lure

---

### Answer:

Deception technology offers a security approach that notifies security teams upon the detection of a potential attack, empowering them to take immediate action. This technology fabricates counterfeit assets, such as devices, users, and hosts, that appear to be part of your network. The Microsoft Defender XDR deception capability uses rules to create decoys and lures that match your environment.
Decoys are fake devices and accounts that appear to belong to your network.
Lures are fake content planted on specific devices or accounts. The content can be a document, a configuration file, or cached credentials. It can also be any other content that an attacker can likely read or steal. Lures can be planted on decoys as well as on the valid devices or accounts.

---

### References

[Manage the deception capability in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/deception-overview)  

[Configure the deception capability in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/configure-deception)  

---

## Q067:

You have an Azure subscription that uses Microsoft Sentinel.
You are classifying and analyzing data by using entities. After connecting your data sources to Microsoft Sentinel, you have created custom analytics rules to help discover threats and anomalous behaviors in your environment.
The alerts are growing larger than 64 KB, and thus are getting truncated.
You need to customize the rule query logic to reduce the size of your alert.

Which operator should you use?

Choose the correct answer

- reduce
- parse
- partition
- project-away

---

### Answer:
- project-away

You should use the project-away operator. This operator allows you to select which specific columns from the input should be excluded from the output. This operator returns a table with columns that were not named as arguments.
You should not use the partition operator. This operator partitions the records of its input table into multiple sub-tables. The required input is composed of values in a key column, and it is then run as a subquery on each sub-table. This then produces a single output table. This resultant table is the union of the results of all subqueries. This operator is useful when you need to perform a subquery only on a subset of rows that belongs to the same partition key, instead of querying the whole dataset. This operator cannot be used to reduce the size of the output by excluding specific columns from the input, which is the desired outcome in this scenario.
You should not use the reduce operator. The reduce operator allows you to group a set of strings together based on the similarity of the values. This operator cannot be used to exclude specific input columns from the output, thereby reducing its size, which is the desired outcome in the scenario.
You should not use the parse operator. The parse operator allows you to evaluate a string expression and parse its value into one or more calculated columns. The calculated columns will have nulls, for unsuccessfully parsed strings.

---

### References

[Classify and analyze data using entities in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/entities)  

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  

[project-away operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/project-away-operator)  

Partition operator
reduce operator
parse operator

---

## Q066:

Microsoft Sentinel offers a significant amount of built-in rules, but your company has some specific use cases that require more granular control of both rule sets and alerting. You are working on creating custom rules in Microsoft Sentinel to meet these use cases.

You need to create a rule that runs every hour and stops running if there is a single alert.
Which two options should you select in the Analytics rule wizard to meet these requirements? Each correct answer presents part of the solution.

Choose the correct answers

- Under Run query every, select 1 hour.
- Under Event grouping, select Group all events into a single alert.
- Under Stop running query after alert is generated, select On.
- Under Lookup data from the last, select 1 hour.

---

### Answer:

- Under Run query every, select 1 hour.
- Under Stop running query after alert is generated, select On.

You should select 1 hour under Run query every. As the name implies, this simply runs the Kusto Query Language (KQL) query every hour. The key here is understanding the difference between Run query every and Lookup data from the last. Often, if you run a query every hour, you will also run it on data for the last hour. This latter portion represents the Lookup data from the last option. However, the scenario only mentions the frequency of the query being run, not how far back the query must look through data.

You should also select the On option under Stop running query after alert is generated. This is the way to identify a query that should stop as soon as an alert is present. Although there are other ways of limiting the number of alerts generated, this option is the way to actually cease a query once any alert occurs. This is the configuration you would choose if you know that a single alert is all you are looking for, and that running the query after that alert is generated would serve no purpose.

You should not select 1 hour under Lookup data from the last. Again, although it may be a common practice that the query frequency matches the lookup time frame, this does not have to be the case. The requirements for the rule do not state any specific lookup time. For example, it is possible to run a query hourly but have the query look back at the past six hours each time it runs. In a real-world scenario, you would need to get further information on any lookup time requirements before altering this setting.

You should not select Group all events into a single alert under Event grouping. Although the scenario mentions a single alert, it is referring to the fact that you can set a query to stop running as soon as any alert is generated. These are two different use cases. if you stop running a query upon the first alert, you are essentially saying you found what you are looking for and allowing the query to continue to run would be pointless. With grouping all events into a single alert, you are trying to reduce overall alert numbers. However, the query would continue to run if you made this selection instead of selecting the On option under Stop running query after alert is generated.

---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)    

---

## Q065:

You are an administrator of Microsoft Defender for Office 365. Your users and preset security policies in Microsoft Defender for Office 365 are configured as shown in the tables below:

> Table 1 :

| User | Groups |
|------|--------|
| User1@company.com | Group1 and Group2 |
| User2@company.com | Group3 |
| User3@company.com | Group2 and Group3 |

> Table 2 :

| Policy Name | Policy Filter |
|---|---|
| Policy1 | Users: User1, User2<br>Groups: None |
| Policy2 | Users: User1<br>Groups: Group1, Group3 |
| Policy3 | Users: User2, User3<br>Groups: Group2, Group3 |


You need to review the policies and identify the ones that are correctly applied to all users within them.

Which policy should you identify as correctly applied?

- Policy 1 only
- Policy1 and Policy2 only
- Policy2 only
- Policy1, Policy2, and Policy3

---

### Answer:
- Policy 1 only

You should identify Policy1 only as correctly applied to all of its users. Preset security policies permit you implement protective measures for users following Microsoft's suggested configurations. Unlike custom policies, preset security policies are unmodifiable and are formulated based on Microsoft's observations in data centers.
If you set up policy filters using multiple policy conditions, the policy conditions are inclusive, and not additive. It means that Policy2 applies only if User1 is a member of Group1 and Group3. All of the specified recipient filters must match. Policy 1 is the only one that meets this criteria, because it has no groups defined, and therefore it does not matter which groups User1 and User2 belong to.

---

### References

[Preset security policies in EOP and Microsoft](https://learn.microsoft.com/en-us/defender-office-365/preset-security-policies)

[Trial user guide: Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/trial-user-guide-defender-for-office-365)  

[Set up steps for the Standard or Strict preset security policies in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/step-by-step-guides/ensuring-you-always-have-the-optimal-security-controls-with-preset-security-policies)  

---

## Q064:

You manage a Microsoft 365 environment in your organization. You are requested to make sure sensitive files are not uploaded to your OneDrive storage.
You need to configure a policy in Microsoft Defender for Cloud Apps.

Which policy should you configure?

Choose the correct answer

- File policy
- Access policy
- Session policy
- Malware detection policy

---

### Answer:
- Session policy

You should configure a session policy. Session policies in Microsoft Defender for Cloud Apps allow you to define rules for controlling user access to cloud applications and services based on conditions such as user groups, device types, and IP addresses. You can use session control policies to grant access while monitoring the session. It is also possible to restrict certain session activities. When the Control file upload (with inspection) option is selected as the Session Control type in the Defender for Cloud Apps session policy, Conditional Access App Control is triggered. This mechanism prevents users from uploading a file based on the policy's file filters.
You should not configure an access policy. Access policies in Microsoft Defender for Cloud Apps allow you to define rules for controlling user access to cloud applications and services based on conditions of block or allow access completely. In this scenario, you need to restrict specific session activities.

You should not configure a file policy. File policies allow you to scan your cloud applications for specific files or file types, data, and then enforce governance actions on these files. Upon activation, the policy maintains a continuous scan of your cloud environment, pinpointing files that align with the content and context filters, and executing the prescribed automated actions. These policies identify and rectify any breaches concerning stored information.
You should not configure a malware detection policy. This type of policy identifies malicious content in your cloud storage.

---

### References

[Session policies](https://learn.microsoft.com/en-us/defender-cloud-apps/session-policy-aad)  

[Access policies in Microsoft Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/access-policy-aad)  

[File policies in Microsoft Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/data-protection-policies)  

[Anomaly detection policies in Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy)  

---

## Q063:

You have an Azure subscription with all available plans activated for all workloads in Microsoft Defender for Cloud.
You need to analyze detailed security alerts and recommendations generated by Microsoft Defender for Cloud for Key Vault. You should minimize costs.

What should you configure to meet the requirement?

Choose the correct answer

- Continuous export
- Azure Monitor Agent
- Storage account
- Log Analytics workspace

---

### Answer:
- Continuous export

You should configure continuous export. With continuous export you have the option to export the detailed security alerts and recommendations generated by Microsoft Defender for Cloud to Azure Log Analytics or Event Hubs for further analysis and examination. By default, only virtual machine (VM) based alerts are stored in a Log Analytics workspace assigned to Microsoft Defender for Cloud; specifically, alerts generated by Microsoft Defender for Servers. This implies that alerts generated by other Defender for Cloud plans, such as Microsoft Defender for Key Vault, are not stored in the workspace by default. To store these alerts in the workspace, the continuous export feature must be utilized.
You should not use a storage account. An Azure storage account is a type of Azure resource that provides a secure and scalable cloud storage solution. It serves as a central location for storing various types of data, including files, blobs (binary large objects), tables, queues, and VM disks. To further analyze and examine the Azure Key Vault alerts, they have to be continuously exported to a Log Analytics workspace.
You should not use a Log Analytics workspace. A Log Analytics workspace is a central repository in Azure that collects, stores, and analyzes data and logs from various sources, including Microsoft Defender for Cloud. It provides powerful query and analysis capabilities to gain insights into the collected data. 

In this scenario, all available plans are activated for all workloads in Microsoft Defender for Cloud, which means that at least one Log Analytics workspace must already be created. As such, to minimize the costs there is no requirement to create another one. Because, by default, alerts generated by Defender for Cloud for Key Vault plan are not stored in the Log Analytics workspace used by Defender for Cloud, the continuous export feature must be utilized.
You should not use the Azure Monitor Agent. The Azure Monitor Agent is a component that facilitates the collection and forwarding of data from various sources to an Azure Log Analytics workspace. It is designed to gather data from on-premises servers or VMs, and send that data to the Log Analytics service for analysis and monitoring. The Azure Monitor Agent is not designed to be used with Azure Key Vault.

---

### References

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[Continuously export Microsoft Defender for Cloud data](https://learn.microsoft.com/en-us/azure/defender-for-cloud/continuous-export)    

[Log Analytics workspace overview](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview)  

[Azure Monitor Agent overview](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-overview)  

[About Azure Key Vault](https://learn.microsoft.com/en-us/azure/key-vault/general/overview)  

[Introduction to Azure Storage](https://learn.microsoft.com/en-us/azure/storage/common/storage-introduction)  

---

## Q062:

You have an Azure subscription that is protected by Microsoft Defender for Cloud. To improve your Software Development Life Cycle (SDLC) you implement Azure DevOps.
You need to configure the prerequisites to activate Microsoft Defender for Cloud for your new implemented DevOps environment.
Which three actions should you perform? Each correct answer presents part of the solution.
Choose the correct answers

- Configure the Security Admin role.
- Configure the Azure DevOps service connection.
- Configure third-party applications to gain access via OAuth.
- Configure enterprise application authentication via OpenID Connect and OAuth.
- Configure the Microsoft Security DevOps extension.

---

### Answer:

- Configure the Security Admin role.
- Configure third-party applications to gain access via OAuth.
- Configure the Microsoft Security DevOps extension.

You should configure the Microsoft Security DevOps extension in Azure DevOps, configure third-party applications to gain access via OAuth, and configure the Security Admin role in Microsoft Defender for Cloud.
Configuring the Microsoft Security DevOps extension is necessary because it provides integration between your DevOps environment and Microsoft Defender for Cloud. This extension enables you to automate security-related tasks, such as scanning code repositories, analyzing security vulnerabilities, and incorporating security checks into your CI/CD pipelines. It helps to ensure that security practices are embedded within your DevOps workflows and to detect and mitigate potential security risks.
Configuring third-party applications to gain access via OAuth is essential for allowing seamless and secure integration between your DevOps environment and other Azure or external services. OAuth is an authorization protocol that enables secure and controlled access to external applications without exposing user credentials. By configuring OAuth, you can establish trusted connections between your DevOps environment and other Azure (Microsoft Defender for Cloud) or third-party services, such as vulnerability scanners, code analysis tools, or security information and event management (SIEM) systems. This integration enables the exchange of relevant security data and helps to streamline security operations within your DevOps processes.
Configuring the Security Admin role is important to ensure that the appropriate permissions and access controls are in place for managing and administering Microsoft Defender for Cloud. The Security Admin role provides granular control over security-related configurations, policies, and settings within the Defender for Cloud environment. By assigning this role to specific individuals or groups, you designate them as responsible for managing security-related aspects, such as activating required plans, defining security policies, monitoring alerts, investigating incidents, and performing administrative tasks within the Microsoft Defender for Cloud platform.
You should not configure enterprise application authentication via OpenID Connect and OAuth. Microsoft Entra enterprise application is a service provided by Microsoft Azure that allows you to integrate and manage external applications within your Microsoft Entra tenant. It enables you to control user access, apply security policies, and manage single sign-on (SSO) for a wide range of applications. By configuring Microsoft Entra enterprise application authentication via OpenID Connect and OAuth, you establish a secure and standardized method for users to authenticate with applications integrated with Microsoft Entra ID. However, configuring Microsoft Entra enterprise application authentication and authorization mechanisms is not a prerequisite for setting up Microsoft Defender for Cloud for Azure DevOps.

You should not configure the Azure DevOps service connection. By creating an Azure DevOps service connection, you can establish a secure and authenticated link between Azure DevOps and external services, such as GitHub or Bitbucket, to securely communicate and integrate with external services or platforms. It acts as a bridge between Azure DevOps and the external service, enabling various interactions and operations, such as accessing source code repositories, integrating with build and release pipelines, managing and publishing packages or artifacts. Azure DevOps service connections enable integration with external services, but they are not a requirement for activating or utilizing Microsoft Defender for Cloud within Azure DevOps.

---

### References

[Quickstart: Connect your Azure DevOps Environment to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-devops)  

[What is application management in Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/what-is-application-management)  

[Manage service connections](https://learn.microsoft.com/en-us/azure/devops/pipelines/library/service-endpoints?view=azure-devops&tabs=yaml)  

---

## Q061:

You have an Azure subscription that uses Microsoft Defender for Cloud.
You have two on-premises virtual machines as follows:

VM1 : Windows Server 2019
VM2 : Linux

You need Microsoft Defender for Cloud to monitor the security posture for VM1 and VM2.

What should you do?

Choose the correct answer

- Install Azure Connected Machine agent on VM1 and Azure Monitor Agent on VM2.
- Install Azure Monitor Agent on VM1 and VM2.
- Install Azure Connected Machine agent on VM1 and VM2.
- Install Azure Monitor Agent on VM1 and Azure Connected Machine agent on VM2.

---

### Answer:

You should install Azure Connected Machine agent on VM1 and VM2. It is recommended that you use Azure Arc enabled servers to add your non-Azure machines to Defender for Cloud. Installing the Azure Connected Machine agent on VM1 and VM2 will enable you to manage your Windows and Linux machines hosted outside of Azure on your corporate network or other cloud providers, to deploy and manage extensions on those machines, and you can also use Azure Policy to enforce policies on them.

You should not install Azure Connected Machine agent on VM1 and Azure Monitor Agent on VM2. In such a case, you will be able to add VM1 to Defender for Cloud via the Azure portal with all advantages described above, but you will not be able to do so for VM2. Azure Arc enabled servers is the preferred way of adding your non-Azure machines to Defender for Cloud. You can install Azure Monitor Agent on a Windows or a Linux VM to collect data and send them to Azure Monitor. The Azure Monitor Agent can collect data such as system performance metrics, event logs, and custom logs. It also allows you to run queries and create custom alerts based on the data collected, but you will not be able to enforce protection using Microsoft Defender for Cloud as requested in this scenario.

You should not install Azure Monitor Agent on VM1 and VM2. You can install Azure Monitor Agent on a Windows or a Linux VM and it is used to pro-actively monitor the OS and workloads running on those VMs. However, it will not enable you to monitor VM1 and VM2 via Defender for Cloud.
You should not install Azure Monitor Agent on VM1 and Azure Connected Machine agent on VM2. In such a case, you will be able to add VM2 to Defender for Cloud via the Azure portal, but you will not be able to do so for VM1. Azure Arc enabled servers is the preferred way of adding your non-Azure machines to Defender
for Cloud.

---

### References

[Connect non-Azure resources to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/training/modules/connect-non-azure-machines-to-azure-defender/)  

[Connect non-Azure machines](https://learn.microsoft.com/en-us/training/modules/connect-non-azure-machines-to-azure-defender/3-connect-non-azure-machines)  

[Overview of Azure Connected Machine agent](https://learn.microsoft.com/en-us/azure/azure-arc/servers/agent-overview)    

[Azure Monitor Agent overview](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-overview) 

---

## Q060:

One of the employees at your company runs an executable that is attached to an email and which steals the employee's credentials. Your manager requests a solution that responds to such threats.
You need to recommend a solution that fulfills the manager's request.

What solution should you recommend?

Choose the correct answer

- Azure Lighthouse
- Data Retention
- Microsoft Graph
- Microsoft Defender for Office 365

---

### Answer:
- Microsoft Defender for Office 365


You should recommend Microsoft Defender for Office 365. One of the features available within the Microsoft Defender for Office 365 suite is Safe Attachments, which adds an extra layer of protection for email attachments that have been scanned already by the anti-malware feature of Exchange Online Protection (EOP), Safe Attachments utilizes a virtual environment to check email attachments before the email is delivered to the final recipient. This process is better known as 'detonation'. Safe Attachment protection is configured and controlled via policies.

You should not recommend Azure Lighthouse. Azure Lighthouse is a solution that provides centralized control plane for service providers and large enterprises to manage the environments of multiple customers or individual subsidiaries efficiently and effectively, all at once.

You should not recommend Data Retention. Data retention refers to the process of storing and maintaining data for a specified period of time, often for legal or regulatory compliance purposes. This can include data such as emails, documents, customer information, financial records, and other types of information that an organization needs to keep for a certain amount of time. It cannot be used in constraining suspicious software behavior or to block executable content included in emails received by users.

You should not recommend Microsoft Graph. Microsoft Graph is a RESTful web API developed by Microsoft that provides a unified programmability model for accessing data and intelligence across the Microsoft 365 suite of services, including Office 365, SharePoint, OneDrive, Microsoft Entra ID, and more. It enables developers to build intelligent and contextual applications that integrate with Microsoft 365 data and services.

---

### References

[Safe Attachments in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about?view=o365-worldwide)  

[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  

[What is Microsoft Sentinel?](https://learn.microsoft.com/en-us/azure/sentinel/overview?tabs=azure-portal)  


[Application Insights overview](https://learn.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview)  

[What is Azure Lighthouse?](https://learn.microsoft.com/en-us/azure/lighthouse/overview)  

---

## Q059:

You are using Microsoft Defender for Cloud to secure a multi-cloud environment.
You are preparing your Google cloud environment in order to allow Google Cloud Platform (GCP) security data to flow to Microsoft Defender for Cloud.
You need to enable the GCP Security Command Center API to facilitate this transfer of data to Microsoft Defender for Cloud.
Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions:

From the Microsoft Defender for Cloud menu, select Cloud connectors.
Select Add GCP account.

Actions in order:

1. From Google's Cloud Console API Library, select each project in the organization you want to connect.
2. In the API Library, find and select Security Command Center API.
3. On the API's page, select ENABLE.

---

### Answer:

You should perform the following steps in order:

1. From the Google's Cloud Console API Library, select each project in the organization you want to connect
2. In the API Library, find and select Security Command Center API
3. On the API's page, select ENABLE

First, you should select each project in the organization you want to connect from the Google's Cloud Console API Library. This will allow you to scope the communication to only the projects you desire. Then, you will select the exact API needed.
Next, you should select Security Command Center API in the API library. 

This is important as you are selecting the specific API you need to facilitate communication between the Security Command Center and Microsoft Defender for Cloud.
Finally, you should select ENABLE on the API's page. This step is important because it saves and enacts the settings you configured in the previous steps.

You should not select Cloud connectors from the Microsoft Defender for Cloud menu. You are only required to enable the GCP Security Command Center API. Cloud connectors is where you would go to actually connect GCP to Microsoft Defender for Cloud.

You should not select Add GCP account. You would take this action in the Microsoft Defender for Cloud environment when selecting accounts to see in Microsoft Defender for Cloud. Although enabling the API facilitates this flow of data, it is a separate process from the workflow relevant to this scenario.

---

### References

[Connect your GCP project to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-gcp)  

[Security Command Center API](https://cloud.google.com/security-command-center/docs/reference/rest/)  


---

## Q058:

You are using Microsoft Defender for Cloud in a multi-cloud environment.
You are in the initial stages of connecting your Amazon Web Services (AWS) account to Microsoft Defender for Cloud.
You need to set up the connection to AWS Security Hub and view security recommendations across multiple regions in Microsoft Defender for Cloud as a single pane of glass.
Which three actions should you perform for each relevant region in sequence? 

To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

Possible actions:

Complete Azure Arc prerequisites.
Configure the AWS Systems Manager (SSM) Agent.

Actions in order:

1. Enable AWS Config.
2. Enable AWS Security Hub.
3. Verify that there is data flowing to the Security Hub.

---

### Answer:

You should perform the following steps in order:

1. Enable AWS Config.
2. Enable AWS Security Hub.
3. Verify that there is data flowing to the Security Hub.

There are two ways to connect Amazon Web Services (AWS) to Microsoft Defender for Cloud: Classic or Native. The Native integration provides a more streamlined and comprehensive solution for connecting AWS to Microsoft Defender for Cloud without the need for additional licensing. In this scenario, you are required to set up the connection to AWS Security Hub, therefore, you have to use the classic integration option, which requires to enable AWS Config in the first step. AWS Config is a tool used to provide an inventory of AWS resources.

Next, you should enable AWS Security Hub. As that name implies, AWS Security Hub is the AWS equivalent. to Microsoft Defender for Cloud. It is used to ensure security alerting and event data is being produced on the AWS side.

Finally, after setting these components up, the next step is to verify 
the flow of data to the Security Hub. This last step can take as long as several hours. This step is necessary as you will need to go back to the previous AWS steps and ensure proper configuration if data is not flowing.

You should not complete Azure Arc prerequisites. Azure Arc is used to get AWS resources into Azure, so this is a related process, but it is not part of the workflow to set up AWS Security Hub.

You should not configure the AWS Systems Manager (SSM) Agent. This agent is used for the automation of tasks across AWS resources. The setup of this agent may be part of the full configuration of a multi-cloud environment, but it is not a part of setting up AWS Security Hub.

---

### References

[Connect your AWS account to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-aws)  

[Setting Up AWS Config with the Console](https://docs.aws.amazon.com/config/latest/developerguide/gs-console.html)   

[Enabling Security Hub](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-settingup.html)  

---

## Q057:

You are using Microsoft Defender for Cloud to protect your cloud environment and Azure Monitor to collect data from your virtual machines (VMs).
You are not receiving data from the Azure Monitor agent on one of your VMs. You determine that this is related to the local firewall on the VM.
You need to allow communication with the required HTTPS endpoints for the Azure Monitor agent, while keeping the rules as specific as possible.
Which three HTTPS endpoints should you allow via the local firewall? Each correct answer presents part of the solution.

Choose the correct answers

- *.monitor.azure.com
- management.azure.com
- *.handler.control.monitor.azure.com
- *.ods.opinsights.azure.com
- *.opinsights.azure.com
- *.azure.com

---

### Answer:
- management.azure.com
- *.handler.control.monitor.azure.com
- *.ods.opinsights.azure.com

Note that the asterisk is a wildcard and thus you are allowing HTTPS (port 443) communication with any endpoint that ends in those domain/subdomain strings. The agent needs to communicate to these endpoints to function properly, and while this usually is not an issue on a common outgoing port like 443, a heavily locked down VM could cause issues by blocking communication to these endpoints. Although Microsoft requires these specific endpoints to be allowed for proper communication, it does not offer an explanation to the purpose of each individual endpoint. Instead, it simply states that communication with these endpoints is a prerequisite to the installation of an Azure Monitor agent.

You should not allow * opinsights.azure.com. Although this would technically include the *.ods.opinsights.azure.com range of endpoints, remember that the scenario asks for the most narrow/specific firewall entries possible. This is important because otherwise you would be allowing communication with endpoints that you do not need to communicate with. For example, the *.opinsights.azure.com exclusion would include subdomains beyond the ods subdomain that is required. Although this is unlikely to cause issues, it does open up a path to endpoints that you do not absolutely need to be communicating with. Following the principle of minimizing unnecessary communication is one way to ensure maximized system hardening, a term that refers to the most secure configuration of a system possible.

You should not allow monitor.azure.com. Although this would technically include *.control.monitor.azure.com range of endpoints, the scenario asks for the most narrow/specific firewall entries possible. The monitor.azure.com exclusion would include subdomains beyond the control subdomain that are required. Again, you would be allowing communication with endpoints that you do not need to communicate with.
You should not allow *.azure.com. This is far too broad of an exclusion as it would include all possible subdomains under the azure.com domain. Although this allow rule would include all of the options needed, it is the broadest allow exclusion that you could use while still allowing the agent to communicate as needed. Again, with this option, you would be allowing communication with endpoints that you do not need
to communicate with.

---

### References

[Manage Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal)  

[Azure Monitor agent on Windows client devices](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-windows-client)  

[Define Azure Monitor Agent network settings](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-network-configuration?tabs=PowerShellWindows)  

---

## Q056:

You are defending your hybrid cloud environment with Microsoft Defender for Cloud.
After initially enabling the solution, you have decided to manually roll out the Azure Monitor Agent to several virtual machines for testing. You used PowerShell for this process.
You need to use PowerShell to check the status of the Azure Monitor agent deployment on a specific virtual machine.

What command should you run to gather this information?

Choose the correct answer

`Get-AzVMExtension -ResourceGroupName myResourceGroup -VMName myVM -Name myExtensionName`

`Set-AzVMExtension -ResourceGroupName myResource Group -VMName myVM -Name myExtensionName`

`Get-AzVMExtension -ResourceGroupName myResourceGroup -Name myExtensionName`

`Set-AzVMExtension -ResourceGroupName myResourceGroup -Name myExtensionName`

---

### Answer:

You should run the command:

`Get-AzVMExtension -ResourceGroupName my Resource Group -VMName myVM -Name my ExtensionName` 

 This command will allow you to retrieve the Azure Monitor agent deployment status (Get-AzVMExtension), specify the resource group and name of the virtual machine you are looking for (-ResourceGroupName my Resource Group -VMName myVM), and indicate the individual extension that you want to check (-Name myExtensionName). This command should be run using the Azure PowerShell Module. It is important to note that this information could also be retrieved from the Azure portal. However, in this scenario, it is specifically requested to use PowerShell. Also, it is key to notice that while the question scenario states that the Azure Monitor agent has been manually deployed to several virtual machines, you only want to check the status of the deployment on one specific virtual machine. This is the reason for using the -VMName myVM portion of the command.

You should not run the Set-AzVMExtension -ResourceGroupName myResource Group -VMName myVM - Name myExtensionName command. By using Set instead of Get, this command is actually the PowerShell command used to deploy the agent. The question scenario states that this has been done already. Note that manual deployment of the Azure Monitor agent is the default option for deployment, but auto provisioning can be used as well.
You should not run the Get-AzVMExtension -ResourceGroupName my ResourceGroup -Name myExtensionName command. While this command correctly uses Get, it does not specify the individual virtual machine you are looking for. This might be an option you would consider if you wanted to check the deployment status of the agent to that resource group, but not for an individual virtual system.
You should not run the Set-AzVMExtension -ResourceGroupName myResource Group -Name myExtensionName command. It uses the incorrect Set option, and it is not scoped to an individual virtual machine, but rather to a resource group.

---

### References

[Azure Monitor Agent overview](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-overview)  

[Manage Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-manage?tabs=azure-portal)  


---

## Q055:

You are working in a hybrid cloud environment and you use Microsoft Defender for Cloud protection.
You have several other servers in both Amazon Web Services (AWS) and 

Google Cloud Platform (GCP,) and you would like to extend Microsoft Defender for Cloud security to those virtual machines, several of which are SQL (Structured Query Language) servers.

You need to determine how you can turn these servers into Azure resources and cause them to be displayed in the Microsoft Defender for Cloud portal.
Which two steps should you take to meet the requirement? Each correct answer presents part of the solution.

Choose the correct answers

- Use Azure Arc on the servers..
- Install the Azure Monitor Agent on the servers.
- Use Azure Migrate on the servers.
- Deploy Azure SQL Edge.

---

### Answer:
- Use Azure Arc on the servers..
- Install the Azure Monitor Agent on the servers.

You should use Azure Arc on the servers and install the Azure Monitor Agent on the servers. Using Azure Arc on the servers will turn them into Azure assets, and installing the Azure Monitor Agent will cause them to be displayed in the Microsoft Defender for Cloud portal. Azure Arc allows you to manage resources hosted outside of Azure. It provides this service by acting as a medium for communication with agents on non-Azure resources. The Azure Monitor Agent is one of these agents that can provide the data. It collects data from machines, including both Windows and Linux boxes. These machines can be in any cloud or they can be on premises. It is important to note that there are other ways of connecting non-Azure resources, SO this process of using Azure Arc and the Azure Monitor Agent is just the recommended best practice, it is not the only option.

You should not use Azure Migrate on the servers. Although Azure Migrate might sound like a good solution in a multi-cloud environment, it is actually related to moving resources from on-premises environments to the Azure cloud. This option would not turn the servers into Azure assets or make them be displayed in the Microsoft Defender for Cloud portal.
You should not deploy Azure SQL Edge. Azure SQL Edge is an Azure solution for loT/edge deployments of SQL databases. Deploying it would not turn the servers into Azure asset or cause them to appear in the Microsoft Defender for Cloud portal.

---

### References

[Azure Arc overview](https://learn.microsoft.com/en-us/azure/azure-arc/overview)  

[Connect your non-Azure machines to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines?pivots=azure-arc)  

[What is Azure SQL Edge?](https://learn.microsoft.com/en-us/azure/azure-sql-edge/overview)  

---

## Q054:

You are using Microsoft Defender for Office 365 to protect SharePoint, OneDrive, and Microsoft Teams.
Your company has seen an increase in attempts to deliver malicious content through these applications.
You need to turn on Safe Attachments for SharePoint, OneDrive, and Microsoft Teams and ensure that users are not able to download any malicious content to their systems.

Which two PowerShell commands should you run to accomplish these requirements? 
Each correct answer presents part of the solution.

Choose the correct answers

- Using the SharePoint Online PowerShell module, run Set-AtpPolicyForO365 EnableATPForSPOTeamsODB $true.

- Using the Exchange Online PowerShell module, run Set-SPOTenant - DisallowinfectedFile Download $true.

- Using the SharePoint Online PowerShell module, run Get-SPOTenant - DisallowInfectedFile Download $true.

- Using the Exchange Online PowerShell module, run Get-AtpPolicyForO365 - EnableATPForSPOTeamsODB $true.

- Using the Exchange Online PowerShell module, run Set-AtpPolicyForO365 - EnableATPForSPOTeamsODB $true.

- Using the SharePoint Online PowerShell module, run Set-SPOTenant - DisallowInfectedFile Download $true.

---

### Answer:

- Using the Exchange Online PowerShell module, run Set-AtpPolicyForO365 - EnableATPForSPOTeamsODB $true.

- Using the SharePoint Online PowerShell module, run Set-SPOTenant - DisallowInfectedFile Download $true.

You should run Set-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true using the Exchange Online PowerShell module and run Set-SPOTenant-DisallowInfectedFileDownload $true using the SharePoint Online PowerShell module. The first key to solving this problem is understanding which PowerShell module to use/connect to for each command. To turn on Safe Attachments for these applications (SharePoint, OneDrive, and Teams) you must first connect to the Exchange Online PowerShell module. This is where you are able to run the Set-AtpPolicyForO365 command and you will use -EnableATPForSPOTeams ODB $true to activate it for the selected applications.
To disallow the downloading of malicious content/attachments, you must first connect to the SharePoint Online PowerShell module. Here, you run the Set-SPOTenant command and use DisallowInfectedFileDownload Strue to activate this feature. Note that your users can still delete any malicious files, this only removes their ability to download them (for both regular users and administrators).
You should not run Set-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true using the SharePoint Online PowerShell module. To enable Safe Attachments, you need to use the Exchange Online PowerShell module.
You should not run Set-SPOTenant -DisallowinfectedFile Download $true using the Exchange Online PowerShell module. To block the downloading of malicious content/attachments, you need to use the SharePoint Online PowerShell module.
You should not run Get-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true or Get-SPOTenant - DisallowInfectedFile Download $true. Note that these two options are using Get instead of Set in the command. Get will retrieve the current settings for the command, while Set will set/alter the settings, as required in this scenario.

---

### References

[Turn on Safe Attachments for SharePoint, OneDrive, and Microsoft Teams](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-for-spo-odfb-teams-configure)  

[Safe Attachments in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about)  

[Microsoft Defender for Office 365 overview](https://learn.microsoft.com/en-us/defender-office-365/mdo-about)  

---

## Q053:

You are using Microsoft Defender for Office 365. In order to protect against malware, you decide to implement Safe Attachments. Initially, you want to simply track the results of this policy and not interfere with the delivery of attachments.
You need to create a Safe Attachments policy that fulfills the tracking requirement and sends potentially malicious attachments to an admin's email address for review.
Which three configurations should you implement to create the policy? Each correct answer presents part of the solution.

Choose the correct answers

- Select the Block option.
- Select the Dynamic Delivery option.
- Click the Add condition button.
- Enter the admin's email address.
- Click the Enable redirect checkbox.
- Select the Monitor option.

---

### Answer:

- Enter the admin's email address.
- Click the Enable redirect checkbox.
- Select the Monitor option.

To create the policy, you should select the Monitor option, click the Enable redirect checkbox, and add the admin's email address. This Safe Attachments policy ultimately needs to fulfill two requirements: monitoring without blocking attachments and delivering the suspected malicious attachment to a user of your choice (typically an admin). To track the results of the policy, you need to select the Monitor option. When enabled, the Monitor option will passively document its findings, without taking any action that could interfere with email attachments. In order to send potentially malicious attachments to an admin for review, you need to both enable the redirect feature and add the admin's email address. This is a logical fit with the monitor mode, as it will allow the indicated security professional to review the attachment in question and intervene if it is in fact malicious.
You should not select the Block option. This option has the potential to interfere with the delivery of attachments. While that can be a desired outcome, especially when the attachments are malicious, it does not meet the requirements of the scenario. Specifically, this option would block both emails and attachments with detected malware involved. This may be an option your company considers after spending some time in the monitor mode if you decide you want a Safe Attachments policy to be more proactive and secure at the cost of interfering with attachment delivery.
You should not select the Dynamic Delivery option. The requirement to not interfere with the delivery of attachments once again rules out this choice. Dynamic Delivery allows for a message to be delivered while the attachment is assessed by Microsoft Defender for Office 365. If the attachment is found to be clean, it will be reattached afterwards. If the attachment is not found to be clean, both the message and the attachment will be quarantined. In other words, in addition to never receiving the malicious attachment, the user will also have the message removed from their inbox. The only other options are Replace and Off, which will replace the attachment and turn off scanning respectively.
You should not click the Add condition button. The Add condition button is only used if you are targeting the policy. Targeting the policy allows you to narrow the focus of the individuals or groups that your policy will impact. For example, you could make the policy only apply to users in your IT department group while testing a policy, before going company-wide with the change. Even though this option is part of policy creation, the given scenario does not deal with targeting the policy.

---

### References

[Configure, protect, and detect](https://learn.microsoft.com/en-us/training/modules/m365-threat-remediate/configure-protect-detect)  

[Safe Attachments in Microsoft Defender for Office 365.](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about)    

[Microsoft Defender for Office 365 overview](https://learn.microsoft.com/en-us/defender-office-365/mdo-about)    

---

## Q052:

Your manager has resources in Google Cloud and Azure.
They ask you to connect them with each other. You are connecting the data in Google Cloud Platform (GCP) to Microsoft Defender for Cloud using classic cloud connector. You have already configured the GCP Security Command Center, enabled Security Health Analytics, and enabled the GCP Security Command Center API.
You need to perform the two remaining steps that will allow you to connect the data.
What two actions should you perform to meet the requirement? Each correct answer presents part of the solution.

Choose the correct answers

- Add Cloud Connectors from Microsoft Defender for Cloud.
- Create a dedicated service account and a private key.
- Generate an installation script.
- Register Azure resource providers.

---

### Answer:
- Add Cloud Connectors from Microsoft Defender for Cloud.
- Create a dedicated service account and a private key.

You should create a dedicated service account and a private key. There are two ways to connect Google Cloud Platform (GCP) to Microsoft Defender for Cloud: Classic or Native. Although the Native integration provides a more streamlined and comprehensive solution for connecting GCP to Microsoft Defender for Cloud without the need for additional licensing or setup, if you have already invested in Security Command Center premium service tier, the classic integration may still be a viable option. As in this scenario classic integration is used, the next step is performed on the Google Cloud Platform (GCP) console. It will allow you to select the project you want to connect to Microsoft Defender for Cloud, where you create a service account and then add a private key for the dedicated service account. This step is one of the last two steps to execute in order to complete the process of connecting the resources of GCP to Azure using classic integration. A service account needs a private key to provide encryption between GCP and Microsoft Defender for Cloud when it is downloaded as a JSON file.
You should also add Cloud Connectors from Microsoft Defender for Cloud. This step, completed on the Microsoft Defender for Cloud page, allows you to add the GCP account you want to connect Azure to. 

You should do this after creating a dedicated service account and a private key. This step is one of the final steps when connecting the resources. After performing these two steps, you will be able to connect the data in Google Cloud Platform (GCP) to Microsoft Defender for Cloud.

You should not register Azure resource providers. This action is included in the process of connecting hybrid machines with Azure Arc-enabled servers. Azure Arc-enabled servers require specific Azure resource providers, like Microsoft. HybridCompute and Microsoft. GuestConfiguration, to be enabled before users can use them.

You should not generate an installation script. This action is also part of the process of connecting hybrid machines with Azure Arc-enabled servers or GCP native integration into Microsoft Defender for Cloud. This does not meet the scenario's requirement.

---

### References

[Connect your GCP project to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-gcp)  

[Security Command Center overview](https://cloud.google.com/security-command-center/docs/concepts-security-command-center-overview)  

[Quickstart: Connect hybrid machines with Azure Arc-enabled servers](https://learn.microsoft.com/en-us/azure/azure-arc/servers/learn/quick-enable-hybrid-vm)  

[Azure resource providers and types](https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/resource-providers-and-types)  

---

## Q051:

Programmers at your company create a web application based on buying and selling products. Your manager wants the web application to be protected against malicious attacks.

You need to recommend a solution that protects the web application.

Which solution should you recommend?

Choose the correct answer

- Sensitivity labels
- Detection rules
- Microsoft Defender for Cloud
- Data Loss Prevention policies

---

### Answer:
- Microsoft Defender for Cloud

You should recommend Microsoft Defender for Cloud. Microsoft Defender for Cloud is a Microsoft's cloud workload protection feature, and it provides cloud security posture management and cloud workload protection. It is used to protect SQL databases, virtual machines, and web applications from malicious attacks.

You should not recommend Data Loss Prevention (DLP) policies. DLP policies are a solution that can prevent the accidental sharing of sensitive information with people outside an organization, but they cannot protect web applications from malicious attacks.
You should not recommend detection rules. Detection rules are used in companies to monitor misconfigured endpoints and suspected breaches, but they do not protect web applications as required. To create a detection rule, you need to be a Security Operator or a Security Administrator.
You should not recommend sensitivity labels. Sensitivity labels allow you to protect and classify the company's data while making sure that employees can effectively collaborate. When a sensitivity label is applied to content, it can restrict access to content by adding a mark to a specific document, such as watermarks applied on documents, or by using encryption. This solution cannot protect web applications from malicious attacks.

---

### References

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[Attack surface reduction rules overview](https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction?view=o365-worldwide)    

[Get started with the data loss prevention alerts](https://learn.microsoft.com/en-us/purview/dlp-alerts-get-started?view=o365-worldwide)  

[Create and manage custom detections rules](https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules?view=o365-worldwide)  

---

## Q050:

You implement an additional layer of security for your company's emails using Safe Attachments policies.
Employees in the accounting team report that they are having a problem with emails from customers, including attachments being delayed.
You need to configure the settings in Safe Attachments in order for the emails to be received directly, without compromising the security of your company.

Which option should you configure in the Safe Attachments settings?

Choose the correct answer

- Monitor
- Dynamic Delivery
- Off
- Block

---

### Answer:
- Dynamic Delivery

You should configure the Dynamic Delivery option. This option will allow you to cancel the delay of messages while protecting the employees in the accounting team from malicious files. Safe Attachments is a Microsoft Defender for Office 365 feature that is used to check the attachments found in emails before receiving them. This feature will cause a delay in receiving the email since it takes time to scan the attachments. Configuring Dynamic Delivery allows the immediate delivery of messages containing attachments by replacing the attachments in emails with placeholders until the scanning of all files included in an email is completed.
You should not configure the Off option. Configuring this option will allow you to avoid the scanning of files included in emails through Safe Attachments. This will avoid delays, but it may lead to compromising the security of the company. This option should be used only when receiving emails from trusted senders.
You should not configure the Block option. This option prevents the delivery of emails containing malware, with messages being quarantined for administrators only to manage them. This option will not prevent messages from being delayed.
You should not configure the Monitor option. This option allows you to track the path of detected malware
in your company and causes a delay when receiving messages until the scanning of Safe Attachments is complete.

---

### References

[Safe Attachments in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/safe-attachments-about)  

[Microsoft Defender for Office 365 overview](https://learn.microsoft.com/en-us/defender-office-365/mdo-about)  

---

## Q049:

Your custom application, App1, generates custom log data to text files. You are requested to ingest these data into the Microsoft Sentinel Log Analytics workspace for further analysis.
To prepare your Microsoft Sentinel Log Analytics workspace to store the log data, you need to create a custom table in the Log Analytics workspace first.
What file format, along with at least one sample record, should you use to create your custom table?

Choose the correct answer

- TXT
- XML
- CSV
- JSON

---

### Answer:
- JSON

You should use the JSON file format. JSON (JavaScript Object Notation) is a lightweight data-interchange format that is easy for humans to read and write and easy for machines to parse and generate. It is commonly used for structuring data in log files due to its simplicity and flexibility. To create a custom table in the Microsoft Sentinel Log Analytics workspace, you need to provide a JSON file with at least one sample record.
You should not use the CSV file format. CSV (Comma-Separated Values) is a simple file format used to store tabular data, such as a spreadsheet or database. Each line in a CSV file represents a record, and each field in the record is separated by a comma. This file format is not suitable for custom table creation in the Microsoft Sentinel Log Analytics workspace according to Microsoft's design.
You should not use the XML file format. XML (eXtensible Markup Language) is a markup language that defines a set of rules for encoding documents in a format that is both human-readable and machine- readable. While XML can be used to structure log data, it is less common in log files compared to JSON or CSV. This file format is not suitable for custom table creation in the Microsoft Sentinel Log Analytics workspace according to Microsoft's design.
You should not use the TXT file format. TXT (plain text) files contain unformatted text and do not have a specific structure like JSON, CSV, or XML. While it is possible to store log data in TXT files, it is not suitable for custom table creation in the Microsoft Sentinel Log Analytics workspace according to Microsoft's design.

---

### References

[Add or delete tables and columns in Azure Monitor Logs](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/create-custom-table?tabs=azure-portal-1%2Cazure-portal-2%2Cazure-portal-3)  
[Collect data in custom log formats to Microsoft Sentinel with the Log Analytics agent](https://learn.microsoft.com/en-us/azure/sentinel/connect-custom-logs?tabs=DCG)  

---

## Q048:

You are managing Linux servers both on-premises and in Microsoft Azure cloud. To prepare for incident response, you plan to collect Common Event Format (CEF) logs in Microsoft Sentinel Log Analytics.
You first need to identify components of the data ingestion process using the Azure Monitor Agent.
Which component should you identify in each scenario? To answer, select the appropriate options from the drop-down menus.

Choose the correct options

CEF logs generation : Log source
CEF logs transformation : Log forwarder
CEF logs storage : Log analytics

---

### Answer:

Systems with installed Linux operating system (OS) transmit their system logs using the Syslog protocol, which employs a specialized format called the Common Event Format (CEF). This format provides a more comprehensive set of data than the conventional Syslog format and organizes the information in a parsed key-value format. The Azure Monitor Agent (a sub-component of CEF Log forwarder) is designed to receive CEF logs, reformat them specifically for integration with Microsoft Sentinel, and then transmit them to your Microsoft Sentinel workspace.
In this scenario, the CEF log source is Linux VMs that generate CEF logs in response to specific operating system or application activities or conditions.
The CEF Log forwarder receives logs from the CEF log source, transforms, and forwards them to a central location. In this scenario, the central location is the Microsoft Sentinel (Log Analytics) workspace.
The Microsoft Sentinel (Log Analytics) workspace serves as a central location where logs are collected and analyzed for security-related events and incident response.


---

### References

[Ingest Syslog and CEF messages to Microsoft Sentinel with the Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/sentinel/connect-cef-syslog-ama?tabs=portal)  

[Best Practices for Common Event Format (CEF) collection in Azure Sentinel](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/best-practices-for-common-event-format-cef-collection-in-azure/ba-p/969990)

[Get CEF-formatted logs from your device or appliance into Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-common-event-format)  

---

## Q047:

Your organization uses Microsoft Sentinel.
To enhance cyber attack prevention, you are tasked with gathering indicators of compromise (IOC) from different threat intelligence platform (TIP) solutions and add them to your Microsoft Sentinel instance. You decided to implement Threat Intelligence Upload Indicators API data connector.
You need to identify the configuration values required by the Threat Intelligence Upload Indicators API of your integrated TIP or custom solution.

Which three configuration values should you identify? 
Each correct answer presents part of the solution.

Choose the correct answers

- Object ID
- Client secret
- Microsoft Sentinel workspace ID
- Directory (tenant) ID
- Application (client) ID

---

### Answer:
- Microsoft Sentinel workspace ID
- Client secret
- Application (client) ID

The configuration values required by the Threat Intelligence Upload Indicators API of your integrated TIP or custom solution are:

- Application (client) ID: This is a unique identifier for your application or client within Microsoft Entra ID. It is used to authenticate your application when accessing Microsoft Sentinel.

- Client secret: This is a string (sometimes called application password) that is used to authenticate your application when accessing Microsoft Sentinel. It should be kept confidential and not shared with anyone. 

- Microsoft Sentinel workspace ID: This is the unique identifier for your Microsoft Sentinel workspace. It is used to specify the target workspace where the indicators of compromise (IOCs) will be uploaded.

The two other configuration values are also important for authentication and access control purposes, but they are not directly related to the integration of the Threat Intelligence Upload Indicators API with Microsoft Sentinel:

- Directory (tenant) ID: This is the unique identifier for your Microsoft Entra tenant. It is used to specify the Microsoft Entra tenant associated with your Microsoft Sentinel workspace.

- Object ID: This is the unique identifier for the object (such as a user, group, or service principal) within your Microsoft Entra tenant. It is used to specify the object that has permissions to access and upload indicators of compromise (IOCs) to Microsoft Sentinel.

---

### References

[Connect your threat intelligence platform to Microsoft Sentinel with the upload indicators API](https://learn.microsoft.com/en-us/azure/sentinel/connect-threat-intelligence-upload-api)   

[Understand threat intelligence in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/understand-threat-intelligence)  

[Reference the upload indicators API (Preview) to import threat intelligence to Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/upload-indicators-api)    

---

## Q046:

Your organization has configured bidirectional synchronization between Microsoft Sentinel and Microsoft Defender XDR. Your Security Operation Center (SOC) team complains about duplicate incidents for the same alerts.
You need to ensure that the alerts are not duplicated.
Which four actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.

Create a list in the correct order

Possible actions
Install the Microsoft Defender XDR solution for Microsoft Sentinel
Uninstall the Microsoft Defender XDR solution for Microsoft Sentinel

Actions in order

1. Navigate to the Microsoft Defender XDR connector page.
2. In the configuration section, select the Disconnect button.
3. Mark the Turn off all Microsoft incident creation rules for these products. Recommended check box.
4. In the configuration section, select the Connect incidents & alerts button.

---

### Answer:

You should perform the following tasks in order:

1. Navigate to the Microsoft Defender XDR connector page.
2. In the configuration section, select the Disconnect button.
3. Mark the Turn off all Microsoft incident creation rules for these products. Recommended check box.
4. In the configuration section, select the Connect incidents & alerts button.

First, you need to navigate to the Microsoft Defender XDR connector page. You can do it in Microsoft Sentinel by selecting Data connectors, Microsoft Defender XDR, and Open connector page.
Next, in the configuration section, select the Disconnect button. By doing this, you can fade in the check box again, which disappears once the Microsoft Defender XDR connector is connected.  

After that, you have to Turn off all Microsoft incident creation rules for these products. Recommended. option by marking the corresponding check box.
Finally, in the configuration section, select the Connect incidents & alerts button.
Incidents triggered by Microsoft Defender XDR are generated using unique Microsoft Defender XDR logic. In parallel, Microsoft Sentinel incident-creation rules also generate incidents from these alerts, utilizing a distinct Microsoft Sentinel logic. Although utilizing both mechanisms simultaneously is fully supported, this approach will result in duplicate incidents for the same alerts. To avoid this, Microsoft recommends turning off all Microsoft incident creation rules for Microsoft Defender XDR-integrated products.
You should not install the Microsoft Defender XDR solution for Microsoft Sentinel. In this scenario, bidirectional synchronization between Microsoft Sentinel and Microsoft Defender XDR has already been configured. Therefore, it is assumed that the Microsoft Defender XDR solution has already been installed.
You should not uninstall the Microsoft Defender XDR solution for Microsoft Sentinel. There is no need to uninstall the solution to disable all Microsoft incident creation rules. According to Microsoft's design, the check box disappears once the Microsoft Defender XDR connector is connected.

---

### References

[Connect data from Microsoft Defender XDR to Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-microsoft-365-defender?tabs=MDE)  

[Microsoft Defender XDR Integration with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration?tabs=azure-portal)  

---

## Q045:

You are administering Microsoft Azure cloud in your organization.
Your assigned custom role provides you with read and write permissions on your Microsoft Sentinel workspace. You are requested to configure bi-directional alert synchronization between Microsoft Sentinel and Microsoft Defender for Cloud.
In Microsoft Sentinel, you navigate to the connector page of Subscription-based Microsoft Defender for Cloud (Legacy), select the requested subscription, and try to connect Subscription-based Microsoft Defender for Cloud (Legacy) to Microsoft Sentinel, You receive the following error message: Failed to connect, access denied.

What two roles could you request to perform the task? Each correct answer presents a complete solution.

Choose the correct answers

- Contributor role on the subscription
- Security Admin role on the subscription
- Microsoft Sentinel Contributor
- Contributor on the resource group
- Log Analytics Contributor

---

### Answer:
- Contributor role on the subscription
- Security Admin role on the subscription

You should request either the Contributor role or the Security Admin role on the subscription. The Subscription-based Microsoft Defender for Cloud (Legacy) connector facilitates the ingestion of security alerts from Microsoft Defender for Cloud into Microsoft Sentinel. As Microsoft Defender for Cloud Defender plans are enabled per subscription, you need to request roles on the respective subscription you want to connect to Microsoft Sentinel.
You should not request the Log Analytics Contributor role. This role is typically required when you need to grant users permissions to manage Log Analytics workspaces and related resources. This role is used to perform tasks specifically related to managing and analyzing log data within Azure Log Analytics only.
You should not request the Contributor on the Resource Group role. This role is a broader role that grants full access to all resources within that resource group only. This role is typically used when you need individuals or groups to have control over all resources within a specific resource group, regardless of their specific functionalities.

You should not request the Microsoft Sentinel Contributor role, as you have already assigned the custom role with the related permissions.

---

### References

[Ingest Microsoft Defender for Cloud alerts to Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-defender-for-cloud)  

[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)    

[Assign Azure roles using the Azure portal](https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-portal)  

---

## Q044:

You have an Azure subscription with Microsoft Sentinel activated and the UEBA feature enabled.
You need to select data sources for User and Entity Behavior Analytics.

What should you do first?

Choose the correct answer

- Connect data sources to Microsoft Defender for Identity.
- Connect data sources to Microsoft Defender for Endpoint.
- Connect data sources to Microsoft Sentinel.
- Connect data sources to Microsoft Defender for Cloud.

---

### Answer:
- Connect data sources to Microsoft Sentinel.

You should first connect the relevant data sources to Microsoft Sentinel. Microsoft Sentinel is the central platform for collecting, analyzing, and detecting security events and incidents. By connecting the necessary data sources, you allow Microsoft Sentinel to ingest the data and apply UEBA analytics to identify behavioral patterns and potential threats.
You should not connect data sources to Microsoft Defender for Cloud. Microsoft Defender for Cloud
primarily focuses on securing cloud resources, such as Azure, Microsoft 365, and other cloud services. Although it can provide valuable security insights, it is not directly related to enabling data sources for entity behavior analytics in Microsoft Sentinel.
You should not connect data sources to Microsoft Defender for Identity. Microsoft Defender for Identity is a solution specifically designed to detect and investigate advanced attacks and insider threats in on-premises Active Directory environments. Although it can provide insights into user behavior, it is not directly related to enabling data sources for UEBA in Microsoft Sentinel.
You should not connect data sources to Microsoft Defender for Endpoint. Microsoft Defender for Endpoint is focused on endpoint security and threat detection on individual devices. Although it provides valuable telemetry and security data from endpoints, it is not directly related to enabling UEBA data sources in Microsoft Sentinel.

---

### References

[Enable User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics?tabs=azure)  

[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  

[What is Microsoft Defender for Identity?](https://learn.microsoft.com/en-us/defender-for-identity/what-is)   

[Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/microsoft-defender-endpoint)    

[Advanced threat detection with User and Entity Behavior Analytics (UEBA) in Microsoft Sentine](https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior-analytics)  

---

## Q043:

You have an Azure subscription with Microsoft Sentinel activated. You are requested to protect your on- premises Active Directory users. As part of your solution you need to collect Event Tracing for Windows (ETW) logs entries that provide the data for multiple detections. While enabling UEBA for your on-premises Active Directory, you encounter the error shown in the exhibit.
You need to troubleshoot the issue.

Which two actions should you perform? 
Each correct answer presents part of the solution.

Choose the correct answers

- Upgrade Active Directory domain controllers to the latest version.
- Install the sensor on Active Directory Domain member server.
- Onboard your Azure tenant to MDI.
- Activate a special license to add the UEBA functionality.
- Install the sensor on your Active Directory domain controller.

![image info](./Q43.PNG)

---

### Answer:
- Install the sensor on Active Directory Domain member server.
- Onboard your Azure tenant to MDI.

You should onboard your Azure tenant to Microsoft Defender for Identity (MDI) and install the MDI sensor.

User and Entity Behavior Analytics (UEBA) is a security capability that focuses on detecting and analyzing
patterns of behavior exhibited by users and entities within an organization's environment. It leverages
advanced analytics and machine learning algorithms to identify anomalies, deviations from normal behavior, and potential security threats.

The error message indicates that enabling UEBA for your on-premises Active Directory requires MDI. Onboarding your Azure tenant to MDI involves setting up and configuring MDI for your Azure tenant. This onboarding process establishes the connection between your Azure subscription and MDI, allowing you to utilize its security capabilities. Once your Azure tenant is onboarded to MDI, you need to install the MDI sensor in your on-premises Active Directory environment. The MDI sensor is responsible for collecting the necessary security-related data from your Active Directory environment and forwarding it to the MDI service for analysis.

To collect Event Tracing for Windows (ETW) logs for UEBA and other detections, you need to install the sensor on your Active Directory Domain Controllers. The sensor is a component provided by MDI that captures the required log data and forwards it to Microsoft Sentinel for analysis. Installing the sensor on the Domain Controllers ensures that the necessary logs are collected and made available for UEBA functionality.
You should not upgrade Active Directory domain controllers to the latest version. Although upgrading domain controllers may be beneficial for general security improvements, it is not a specific requirement to enable UEВА.
You should not activate a special license to add the UEBA functionality. Adding UEBA functionality to Microsoft Sentinel does not require a special license, and there is no extra cost associated with using it. However, it is important to note that UEBA generates new data and stores it in dedicated tables within your Log Analytics workspace. As a result, there may be additional data storage charges applied.
You should not install the sensor on Active Directory Domain member server. To achieve comprehensive coverage of your environment and collect Event Tracing for Windows (ETW) log entries that are crucial for multiple detections, it is important to note that Defender for Identity standalone sensors do not support this capability. To address this, Microsoft highly recommends deploying the Defender for Identity sensor on all your domain controllers. By doing so, you ensure that the necessary data is captured from all domain controllers, enabling a more comprehensive and effective detection capability.

---

### References

[Enable User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics?tabs=azure)  
[Identify advanced threats with User and Entity Behavior Analytics (UEBA) in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior-analytics)  
[Microsoft Defender for Identity prerequisites](https://learn.microsoft.com/en-us/defender-for-identity/deploy/prerequisites)  

---

## Q042:

You have an Azure subscription that uses Microsoft Sentinel.
You are using the custom logs data source for the Azure Monitor agent in Azure Monitor to collect events from text files on a Windows virtual machine (VM).


The custom log entries are exhibited below:

```
Time=2022-07-10 01:34:36 Event Code=207 Status=Success Message=Client 06b33b79- 272a-4bc9-8f34-269d154b0e39 connected
Time=2022-07-10 01:33:33 Event Code=208 Status=Warning Message=Client ec53d95d-
1c88-41ae-8174-92104212de6d disconnected
Time=2022-07-10 01:35:44 Event Code=209 Status=Success Message=Transaction
11d43671-c0043-761c-3cab-9v56b51189c8 succeeded
Time=2022-07-10 01:38:22 Event Code=302 Status=Error Message Application could not connect to database
Time=2022-07-10 01:31:34 Event Code=303 Status=Error Message=Application lost connection to database
```

You need to identify simple text patterns in the log entries.
How should you complete the query? 
To answer, select the appropriate options from the drop-down menus.

Choose the correct options

OPT1: parse | order | scan | search 
OPT2: RawData | ManagementGroupName | SourceSystem | TimeGenerated

```
MyCustomLog_CL
| [OPT1] [OPT2] with * "Time=" EventTime Event Code=" Code " Status="status" Message=" Message 
| project EventTime, Code, Status, Message
```

```
MyCustomLog_CL
| parse RawData with * "Time=" EventTime Event Code=" Code " Status="status" Message=" Message 
| project EventTime, Code, Status, Message
```

---

### Answer:

You should complete the query as follows:

```
MyCustomLog_CL
parse RawData with Message=" Message "Time" EventTime Event Code=" Code Status" Status
| project EventTime, Code, Status, Message
```

In this scenario, you need to identify simple text patterns in the log entries. This requires you to parse the custom log entries using the parse operator. A parse operator allows you to evaluate a string expression and parse its value into one or more calculated columns. When a column has no parsed strings, you will see a null in the calculated column.

You should also use the RawData custom log record property. You have four custom log record properties that you could assign: TimeGenerated, SourceSystem, RawData and ManagementGroupName. A RawData property provides the full text of the collected entry.
You should not use the order operator. The order operator allows you to sort the rows of the input table into order by one or more columns; however, you need to parse the RawData log entries.
You should not use the scan operator. The scan operator allows you to scan data, formulate matches, and build sequences based on the predicates. A predicate can depend on the state that is generated by previous steps.

You should not use the search operator. The search operator allows you to search for a text pattern in multiple tables and columns, but you need to parse the RawData log entries.
You should not use the SourceSystem custom log record property. This property shows the type of agent that the record was collected from. There are two possible values for this property: OpsManager for Windows agent (either direct connect or System Center Operations Manager), and Linux for all Linux agents. In this scenario, since you are required to parse the entire log entry, you should use the RawData property.

You should not use the TimeGenerated custom log record property. This property provides the date and time at which Azure Monitor collected the record. If the log uses a time-based delimiter, this is the time collected from the entry.
You should not use the ManagementGroupName custom log record property. This property provides the name of the management group for System Center Operations Manager agents.

---

### References

[Collect logs from a text or JSON file with Azure Monitor Agent](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/data-collection-log-text?tabs=portal)  
[Parse text data in Azure Monitor logs](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/parse-text)  
[parse operator](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/parse-operator)  
order operator
scan operator
search operator


---

## Q041:

Your managers travel to another country. They are connected to the company's Windows cloud server. which is linked to its Microsoft Sentinel workspace. While they are abroad, they hire a new employee to work online for the company. Your manager wants to be able to be notified if you create the user account for the new employee locally in the Windows cloud server.
You need to implement a solution that can enable the manager to be notified if the creation of user accounts is done from any Windows cloud server linked with the company's Microsoft Sentinel workspace.

What should you do?

Choose the correct answer

- Create a Microsoft Defender for Office 365 (Preview) connector.
- Use a Windows Security Events via AMA connector.
- Create a Cloud Connector.
- Use Microsoft Defender for Cloud.

---

### Answer:
- Use a Windows Security Events via AMA connector.

You should use a Windows Security Events via AMA connector. A Windows Security Events via AMA connector is used to stream security events from any Windows server (virtual, physical, in a cloud) linked with your Microsoft Sentinel workspace. This means that the manager can use these event in the single location to view or be notified when the new user account is created, as this activity is considered to be al security event. To set a Windows Security Events via AMA connector, you should access the Microsoft Sentinel portal then navigate to the Open connector page button, where you will verify that you have permission to create the connector before downloading the Azure Monitor Agent, which will finish the process. Microsoft Sentinel is a Security Information Event Management (SIEM) system used to provide security analytics for companies.
You should not create a Cloud Connector. Cloud connector is a bridge between an organization's on- premises infrastructure and the cloud-based services provided by Office 365 or Microsoft 365. You cannot use a Cloud Connector to view how the creation of user accounts is done from any Windows cloud server.
You should not create a Microsoft Defender for Office 365 (Preview) connector. Microsoft Defender for Office 365 (Preview) connectors are used to connect Microsoft Defender for Office 365 security solutions to a Microsoft Sentinel workspace. This does not meet the scenario requirement.
You should not use Microsoft Defender for Cloud. Microsoft Defender for Cloud is a cloud workload protection feature that provides cloud security posture management and cloud workload protection. It is used to protect SQL databases, virtual machines, and web applications from malicious attacks. This solution does not allow you to view if the creation of user accounts is done in any Windows cloud server linked with the company's Microsoft Sentinel workspace.

---

### References

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference)  
[Configure Cloud Connector integration with your Microsoft 365 or Office 365 organization](https://learn.microsoft.com/en-us/microsoftteams/cloud-voice-landing-page)  
[What is Microsoft Defender for Cloud?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction)  
[Microsoft Defender XDR integration with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration?tabs=azure-portal)   

---

## Q040:

You are in the process of connecting data sources to Microsoft Sentinel.
You want to ingest Microsoft Entra ID Protection data into Microsoft Sentinel.
You need to identify the prerequisites for making this connection.

Where can you find this list of prerequisites?

Choose the correct answer

- On the Data Connectors page for Microsoft Entra ID. under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID, under the Configuration heading.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Next Steps tab.

---

### Answer:

You can find the list of prerequisites on the Data Connectors page for Microsoft Entra ID Protection, under Instructions. The first key is knowing that Microsoft Entra ID Protection has its own data connector. You can choose to connect Microsoft Entra ID on its own, as well. However, the Microsoft Entra ID Protection connector is what you need to use to retrieve risky sign-in and risky user data. The prerequisites, once you are on the Data Connectors page, are under the Instructions tab.
You should not navigate to the Data Connectors page for Microsoft Entra ID Protection and then to the Next Steps tab. This tab offers information/suggestions on activities after making the connection, not the prerequisites required before making the connection.
You should not navigate to the Data Connectors page for Microsoft Entra ID and then to the Instructions tab. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. This is, however, where you could find the prerequisites for the Microsoft Entra ID data connector.
You should not navigate to the Data Connectors page for Microsoft Entra ID and look under the Configuration heading. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. The Configuration heading is on the Instructions tab, and it simply has the ability to connect or disconnect based on log type. This is an important area for setting up data connectors, but the prerequisites are actually displayed on the same tab in the section labeled Prerequisites, which is above Configuration.

---

### References

[Microsoft Entra ID Protection connector for Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/connect-azure-windows-microsoft-services)  
[Connect data sources](https://learn.microsoft.com/en-us/azure/sentinel/create-incidents-from-alerts)  
[What is Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/fundamentals/whatis)  

---

## Q039:

You are in the process of connecting data sources to Microsoft Sentinel.
You want to ingest Microsoft Entra ID Protection data into Microsoft Sentinel.
You need to identify the prerequisites for making this connection.

Where can you find this list of prerequisites?

Choose the correct answer

- On the Data Connectors page for Microsoft Entra ID. under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID, under the Configuration heading.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Instructions tab.
- On the Data Connectors page for Microsoft Entra ID Protection, under the Next Steps tab.

---

### Answer:
- On the Data Connectors page for Microsoft Entra ID Protection, under the Instructions tab.

You can find the list of prerequisites on the Data Connectors page for Microsoft Entra ID Protection, under Instructions. The first key is knowing that Microsoft Entra ID Protection has its own data connector. You can choose to connect Microsoft Entra ID on its own, as well. However, the Microsoft Entra ID Protection connector is what you need to use to retrieve risky sign-in and risky user data. The prerequisites, once you are on the Data Connectors page, are under the Instructions tab.
You should not navigate to the Data Connectors page for Microsoft Entra ID Protection and then to the Next Steps tab. This tab offers information/suggestions on activities after making the connection, not the prerequisites required before making the connection.
You should not navigate to the Data Connectors page for Microsoft Entra ID and then to the Instructions tab. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. This is, however, where you could find the prerequisites for the Microsoft Entra ID data connector.
You should not navigate to the Data Connectors page for Microsoft Entra ID and look under the Configuration heading. Microsoft Entra ID Protection has its own data connector separate from Microsoft Entra ID. The Configuration heading is on the Instructions tab, and it simply has the ability to connect or disconnect based on log type. This is an important area for setting up data connectors, but the prerequisites are actually displayed on the same tab in the section labeled Prerequisites, which is above Configuration.

---

### References

[Microsoft Entra ID Protection connector for Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors/microsoft-entra-id-protection)  
[Connect data sources](https://learn.microsoft.com/en-us/training/modules/create-manage-azure-sentinel-workspaces/)  
[What is Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/fundamentals/whatis)  

---

## Q038:

You have deployed Microsoft Sentinel and are currently connecting data sources.
You need to connect Microsoft Entra ID, as you would like to ingest Microsoft Entra sign-in logs and audit logs into Microsoft Sentinel.
Which five actions should you perform in sequence? To answer, move the appropriate actions from the list of possible actions to the answer area and arrange them in the correct order.
Create a list in the correct order

> Possible actions

On the Data Connectors page, select the Microsoft Entra ID Protection tile.

In Microsoft Defender for Cloud, go to the Getting Started page.

In the Azure portal, under the All services option, select Microsoft Sentinel.

From the navigation menu, select Data Connectors.

On the Data Connectors page, select the Microsoft Entra ID tile.

Click the Open connector page button and then follow the instructions to connect the data source.

Select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs.

> Actions in order

In the Azure portal, under the All services option, select Microsoft Sentinel.

From the navigation menu, select Data Connectors.

On the Data Connectors page, select the Microsoft Entra ID tile.

Click the Open connector page button and then follow the instructions to connect the data source.

Select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs.

---

### Answer:

You need to complete the following steps in order:

1. In the Azure portal, under the All services option, select Microsoft Sentinel.
2. From the navigation menu, select Data Connectors.
3. On the Data Connectors page, select the Microsoft Entra ID tile.
4. Click the Open connector page button and then follow the instructions to connect the data source.
5. Select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs.

First, you should select Microsoft Sentinel from the All services option in the Azure portal. This is the way you navigate to Microsoft Sentinel, where you can set up data connectors.
Next, you should select Data Connectors from the side navigation menu. Microsoft Sentinel needs to ingest data to be an effective Security Information and Event Management (SIEM) tool, and data connectors are the way that information reaches Sentinel.
Then, you should select the Microsoft Entra ID tile on the Data Connectors page. This will narrow down the list to the specific data connector needed to send the data you want to Microsoft Sentinel. As the scenario mentions Microsoft Entra sign-in and audit logs, this is the tile you should select.
Next, you should click the Open connector page button and then follow the instructions to connect the data source. Each data source may have different directions, so you should follow the instructions specific to your chosen data connector.
Finally, you should select both Microsoft Entra Sign-in logs and Microsoft Entra Audit logs. These are the logs/data specifically mentioned in the scenario. Selecting them allows for this specific data to flow to Microsoft Sentinel.
You should not select the Microsoft Entra ID Protection tile on the Data Connectors page. This tile is for the connector for Microsoft Entra ID Protection, which monitors risky users and risky sign-ins. While this is valuable data to ingest, it is not the process you are required to complete in this scenario.
You should not go to the Getting Started page in Microsoft Defender for Cloud. You can deploy Microsoft Defender for Cloud from this page, along with other important security tasks, but it is not the location which will enable you to connect Microsoft Entra to Microsoft Sentinel.

---

### References

[Connect data sources](https://learn.microsoft.com/en-us/training/modules/create-manage-azure-sentinel-workspaces/)  
[What is Microsoft Entra ID?](https://learn.microsoft.com/en-us/entra/fundamentals/whatis)  

---

## Q037:

You enable Microsoft Sentinel in your company.
Your manager wants to integrate log data from Microsoft 365 and non-Azure virtual machines.
You need to recommend a solution to fulfill the manager's request.

What solution should you recommend?

Choose the correct answer

- Using Data Loss Prevention policies
- Using Microsoft Graph
- Adding a playbook in Microsoft Sentinel
- Creating data connectors in Microsoft Sentinel

---

### Answer:
- Creating data connectors in Microsoft Sentinel

You should recommend creating data connectors in Microsoft Sentinel. Microsoft Sentinel data connectors are used by companies to integrate the log data from several sources like Microsoft 365, Azure resources, Microsoft Defender for Office 365, and non-Azure virtual machines. To use data connectors, you have to choose the Data Connectors tab on the left-hand side of the Microsoft Sentinel portal, then select the connector you want from a list. There are several types of connectors for different purposes, such as connecting Vectra Al Detect to Microsoft Sentinel or connecting Amazon Web Services to Microsoft Sentinel. Upon selecting the appropriate connector, you will be able to collect log data from the source that you choose.
You should not recommend adding a playbook in Microsoft Sentinel. Playbooks are sets of processes that may be executed in response to an alert or event from Microsoft Sentinel. A playbook uses automation in response to alerts, attaching an analysis rule or an automation rule when certain alerts or occurrences are produced. They cannot integrate log data from Microsoft 365 and non-Azure virtual machines.
You should not recommend using Microsoft Graph. Microsoft Graph uses a single API call to act on security insights from security solutions. It is a tool that enables users to create solutions that are authenticated once. This solution does not allow you to integrate log data. Microsoft Graph includes features like the calendar feature for Outlook, which allows users to set up appointments, and the files feature for SharePoint and OneDrive, which enables users to manage files on SharePoint and OneDrive.

You should not recommend using Data Loss Prevention (DLP) policies. Using a DLP policy will allow you to ban the accidental sharing of sensitive information with people outside the organization. Data loss prevention can display a pop-up tip to employees to warn them about possible attempts to share sensitive data with people outside the organization, but it cannot integrate log data as required in the scenario.

---

### References

[Microsoft Sentinel data connectors](https://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources?tabs=azure-portal)  
[Get started with the data loss prevention alerts](https://learn.microsoft.com/en-us/purview/dlp-alerts-get-started)  
[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  
[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)  

---

## Q036:

The coordinator of the finance team reports that the Microsoft 365 data of a team member is compromised.
Your manager wants you to implement a solution that enables the company to collect log data.
You need to recommend a solution that fulfills the manager's request.

What solution should you recommend?

Choose the correct answer

- Microsoft Sentinel connectors
- Attack surface reduction rules
- Exemption rules
- Windows Security Events connector

---

### Answer:

You should recommend Microsoft Sentinel connectors. Through Microsoft Sentinel connectors, you can connect your data resources, such as Microsoft 365, to connectors found in Microsoft Sentinel. This will enable you to keep track of log data connected to the connectors, protecting this data from being compromised. Microsoft Sentinel is a Security Information Event Management (SIEM) system that provides security analytics for companies.
You should not recommend Exemption rules. Exemption rules are a part of Microsoft Defender for Cloud and they allow you to have precise control over the recommendations that influence the resources in your subscriptions and management groups. This solution does not enable you to collect Microsoft 365 data or log data.
You should not recommend the Windows Security Events connector. The Windows Security Events connector is used to stream security events from any Windows server linked with your Microsoft Sentinel workspace. This solution does not enable you to collect Microsoft 365 data or log data.
You should not recommend Attack Surface Reduction rules. These rules are used to protect an organization from being compromised through malicious scripts and executable files. This solution does not enable you to collect Microsoft 365 data or log data.

---

### References

[Microsoft Sentinel data connectors](https://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources?tabs=azure-portal)  

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference)  

[Enable attack surface reduction rules](https://learn.microsoft.com/en-us/defender-endpoint/enable-attack-surface-reduction)  

[Exempt resources from recommendations](https://learn.microsoft.com/en-us/azure/defender-for-cloud/exempt-resource)  

---

## Q035:

Your manager asks you to configure alerts in Microsoft Defender for Endpoint so that the members of the accounting team can receive alerts when a vulnerability is detected. You configure the alerts as requested. One of the employees reports that they are not receiving email notifications when a vulnerability is detected like their colleagues.
You need to make sure the employee receives the email notifications.

What should you do?

Choose the correct answer

- Delete the notification rule.
- Edit the created notification rule.
- Modify the Include tenant-specific portal link field of the notification rule.
- Check the employee's Junk Email folder and mark the security emails as Not Junk.

---

### Answer:
- Check the employee's Junk Email folder and mark the security emails as Not Junk.

You should check the employee's Junk Email folder for the security emails. Emails from Defender for Endpoints are occasionally sent to the Junk Email folder. Accessing this folder and marking the security emails as Not Junk will resolve the problem. Other potential causes of this problem include your email security product blocking email notifications from Defender for Endpoints, or your email application rules. catching and moving these notifications.
You should not edit the created rule for alert notifications. This action, done in the Microsoft Defender for Endpoint will allow you to edit a created rule for email notifications by accessing the email notifications page and then selecting the rule you want to edit. There are several fields that you can edit in the created rule, like the rule name and the alert severity that will be displayed for the user receiving an email about the alert.
You should not delete the notification rule. Deleting the rule will prevent the employee from receiving any email notification related to a detected vulnerability.
You should not modify the Include tenant-specific portal link field of the notification rule. This action will allow you to reset a new link with a specific tenant ID to allow the notification to pass to a user in a specific tenant.

---

### References

[Configure alert notifications in Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/configure-email-notifications)  

[Configure vulnerability email notifications in Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/configure-vulnerability-email-notifications)  

---

## Q034:

Your organization uses Microsoft Azure cloud, with resources located in the United States and Europe. Every geography has regulatory requirements for data retention.
You need to implement Microsoft Sentinel for your Security Operations Center (SOC) team. The estimated log data ingestion will exceed 100 GB per day per geography.

How many workspaces should you plan for your Microsoft Sentinel solution?

Choose the correct answer

- One
- Two
- Three
- Four

---

### Answer:
- Four

You should plan four workspaces for your Microsoft Sentinel solution. When you plan the implementation of Microsoft, it is essential to outline the architecture for your Log Analytics workspace. The design of the workspace architecture is usually influenced by both business and technical needs.
Based on Microsoft's best practices for Microsoft Sentinel workspace architecture, you should consider the following, among other factors:
• cost implications for different scenarios
any compliance requirements for data collection and storage
Considering the factors mentioned above, Microsoft recommends using a separate workspace for every 100 GB of data for cost efficiency. Additionally, it is suggested to separate the workspaces by geography. In this scenario, there are two geographies: the United States and Europe. Furthermore, due to log data ingestion exceeding 100 GB per day per geography, it will be necessary to implement two separate workspaces for each geography, respectively.
Note that while a geography in Azure represents a larger area encompassing multiple regions and ensuring data residency and compliance, a region refers to a specific geographical location where Azure resources such as Microsoft Sentinel workspace can be deployed and hosted.

---

### References

[Design your Microsoft Sentinel workspace architecture](https://learn.microsoft.com/en-us/azure/sentinel/design-your-workspace-architecture)   

[Microsoft Sentinel workspace architecture best practices](https://learn.microsoft.com/en-us/azure/sentinel/best-practices-workspace-architecture)  

[Geographical availability and data residency in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/geographical-availability-data-residency)  

---

## Q033:

You have a Microsoft Sentinel security information and event management (SIEM) and security orchestration, automation, and response (SOAR) solution running in an Azure subscription.
You are assigning Azure role-based access control (Azure RBAC) permissions for the below users in Microsoft Sentinel:

- User1, a security analyst, needs to attach playbooks to analytics and automation rules, as well as run playbooks.
- User2, a security engineer, needs to manage incidents, such as assigning or dismissing them.

User3, a service principal, needs to manage automated configuration for management tasks (e.g., creating and updating support tickets), create and edit analytics rules.
You need to assign the appropriate roles for the users as per their user type and according to Microsoft's recommendations.

Which role should you assign to each user? 
To answer, drag the appropriate role to each user. A role may be used once, more than once, or not at all.

Drag and drop the answers

Sentinel Playbook Operator
Sentinel Contributor
Sentinel Responder
Logic App Contributor

User1: Sentinel Playbook Operator
User2: Sentinel Responder
User3: Sentinel Contributor

---

### Answer:

Microsoft Sentinel uses Azure role-based access control (Azure RBAC) to provide built-in roles that can be assigned to users, groups, and services in Azure. There are five Microsoft Sentinel-specific roles: Microsoft Sentinel Reader, Microsoft Sentinel Responder, Microsoft Sentinel Contributor, Microsoft Sentinel Playbook Operator and Microsoft Sentinel Automation Contributor. In addition to these roles, the Logic App Contributor role can also be assigned to allow the user to view, run, create or edit playbooks.
In this scenario, User1 is a security analyst and needs to attach playbooks to analytics and automation rules and, additionally, to run playbooks. According to Microsoft's recommendations, this user should be assigned the Microsoft Sentinel Playbook Operator role.
User2 is a security engineer and needs to manage incidents, which includes tasks such as assigning or dismissing incidents. According to Microsoft's recommendations, this user should be assigned the Microsoft Sentinel Responder role.
User3 is a service principal and can manage automated configuration for management tasks, create and edit analytics rules. According to Microsoft's recommendations, this user should be assigned the Microsoft Sentinel Contributor role.
You should not assign the Logic App Contributor role to any of these users. According to Microsoft's recommendations, this role is targeted towards the Security Engineer user type for Microsoft Sentinel's resource group, or the resource group where your playbooks are stored. This role also allows a user to attach playbooks to analytics and automation rules, in addition to running and modifying the playbooks.

---

### References

[What is Microsoft Sentinel?](https://learn.microsoft.com/en-us/azure/sentinel/overview?tabs=azure-portal)  
[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)  

---

## Q032:

Your company starts using Microsoft Sentinel.
The manager wants the administration of the implemented solution to be divided into two groups, Group A and Group B, where:
Group A is responsible for replacing tags in Threat Intelligence Indicator.
Group B is responsible for adding playbooks to automation rules.
You need to assign the appropriate roles for both groups to fulfill the manager's request.
How should you assign the roles? To answer, drag the appropriate role to each group. A role may be used once, more than once, or not at all.

Drag and drop the answers

Responder
Sentinel Automation Contributor
Reader
Security Assessment Contributor

Group A: Responder
Group B: Sentinel Automation Contributor

---

### Answer:

You should assign the Responder role to Group A. This role gives the user permission to manage incidents (assign users to incidents, dismiss alerts, etc.) in Microsoft Sentinel and to view several Microsoft Sentinel resources, including reports, incidents, and workbooks. This role also gives users permission to replace tags in Threat Intelligence Indicator. It does not give users permission to add playbooks to automation rules. Threat Intelligence Indicator is a cloud-based solution used within companies to analyze and act upon threat activities.
You should assign the Microsoft Sentinel Automation Contributor role to Group B. In addition to viewing Microsoft Sentinel resources, managing incidents, and working with workbooks, this role allows users to add playbooks to automation rules in Microsoft Sentinel.
You should not assign the Reader role to either group. This role gives a user permission to view incidents in Microsoft Sentinel, but not the permission to replace tags in Threat Intelligence Indicator or to add playbooks to automation rules as required in the scenario.
You should not assign the Security Assessment Contributor role to either group. This role gives users permission to create security assessments on the company's Microsoft Sentinel subscription, which is useful for finding out whether the company needs another Microsoft Sentinel subscription. This role does not give the permission to replace tags of Threat Intelligence Indicator or to add playbooks to automation rules as required in the scenario.

---

### References

[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)    
[Azure built-in roles](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles)

---

## Q031:

You are deploying Microsoft Sentinel and want to assign roles to users.
You need to ensure that all users are able to create and edit workbooks, analytics rules, and other Microsoft Sentinel resources.

Which two roles could you assign to these users to meet the requirements?
Each correct answer presents a complete solution.

Choose the correct answers

- Microsoft Sentinel Reader
- Microsoft Sentinel Contributor and Logic App Contributor
- Microsoft Sentinel Contributor
- Microsoft Sentinel Responder

---

### Answer:
- Microsoft Sentinel Contributor and Logic App Contributor
- Microsoft Sentinel Contributor

You should assign users either the Microsoft Sentinel Contributor role or the Microsoft Sentinel Contributor and Logic App Contributor role. Both of these options allow users to create and edit workbooks, analytics rules, and other Microsoft Sentinel resources. The Microsoft Sentinel Contributor and Logic App Contributor role also adds the ability to create and run playbooks.
You should not assign users the Microsoft Sentinel Responder role. Users with this role can manage incidents (dismissing and assigning incidents, for example) and also view data incidents, workbooks, and other Microsoft Sentinel resources.
You should not assign users the Microsoft Sentinel Reader role. Users with this role only have the permissions to view data incidents, workbooks, and other Microsoft Sentinel resources. It is the least privileged of all the Microsoft Sentinel roles.

---

### References

[Create and manage Microsoft Sentinel workspaces](https://learn.microsoft.com/en-us/training/modules/create-manage-azure-sentinel-workspaces/)  

---

## Q030:

You are in the process of implementing Microsoft Sentinel.
Your manager wants the log data to be kept in the company's workspace for 550 days.
You need to recommend a solution that fulfills the manager's request.

What should you recommend?

Choose the correct answer

- Create sensitivity labels in the Microsoft Purview compliance portal.
- Use security extensions in Microsoft Defender for Cloud.
- Use data retention in the Azure portal.
- Create a workbook in the Azure portal.

---

### Answer:
- Use data retention in the Azure portal.

You should recommend using data retention in the Azure portal. Data retention is an option in the Azure portal that allows you to adjust the log retention days. This solution is applied by accessing the Data Retention window on the Usage and estimated costs page, where a blade for retention days will be displayed for you to adjust. Using this blade, you can set the data retention period to 30, 31, 60, 90, 120, 180, 270, 365, 550, or 730 days. 31 days is the default setting and 730 is the maximum number of days allowed. Data will be retained in Microsoft Azure servers
You should not recommend creating a workbook in the Azure portal. Workbooks provide a broad canvas for data analysis and the production of sophisticated visual reports. They enable you to connect to numerous data sources throughout Azure and integrate them into cohesive interactive experiences. However, workbooks will not allow you to keep log data for a defined period of time.
You should not recommend creating sensitivity labels in the Microsoft Purview compliance portal. Sensitivity labels allow you to protect and classify the company's data while making sure that employees can effectively collaborate. When a sensitivity label is applied to content, it can restrict access to content by adding a mark to a specific document (like watermarks applied on documents) or by using encryption.
You should not recommend using security extensions in Microsoft Defender for Cloud. This solution is used to collect data and send information on specific resource kinds after being scanned by the Log Analytics Agent tool. It will not allow you to keep log data as the manager requests.

---

### References

[Azure Monitor Logs cost calculations and options](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/cost-logs)  

[Create and configure sensitivity labels and their policies](https://learn.microsoft.com/en-us/purview/create-sensitivity-labels?view=o365-worldwide)  

[Azure Workbooks](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-overview)  

[How does Defender for Cloud collect data?](https://learn.microsoft.com/en-us/azure/defender-for-cloud/monitoring-components)  

---


## Q029:

Your manager wants an employee in the human resources department to be able to manage incidents and view resources in Microsoft Sentinel, but they should have no other permissions.
You need to grant the employee the appropriate permissions.

What role should you assign to the employee?

Choose the correct answer

- Microsoft Sentinel Reader
- Microsoft Sentinel Responder
- Microsoft Sentinel Contributor and Logic App Contributor
- Microsoft Sentinel Contributor

---

### Answer:
- Microsoft Sentinel Responder

You should assign the employee the Microsoft Sentinel Responder role. This role gives them permission to manage incidents (assign users to incidents, dismiss alerts, etc.) in Microsoft Sentinel and to view several Microsoft Sentinel resources, including reports, incidents, and workbooks. It does not give them any other permissions, so they could not create playbooks or analytics rules, for example.
You should not assign the employee the Microsoft Sentinel Contributor role. This role would give them permission to manage and view incidents in Microsoft Sentinel, but it also grants users permission to create and edit analytics rules.
You should not assign the employee the Microsoft Sentinel Reader role. This role would give them permission to view incidents in Microsoft Sentinel, but not permission to manage incidents.
You should not assign the employee the Microsoft Sentinel Contributor and Logic App Contributor roles. These roles would allow them to manage and view incidents in Microsoft Sentinel, and it would also give them the ability to create playbooks and analytics rules.

---

### References


[Roles and permissions in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/roles)  

---

## Q028:

You have been tasked with enabling Microsoft Sentinel in an Azure tenant with multiple resource groups.
You need the correct role to be able to complete this task, while following the principle of least privilege and minimizing administrative effort.

What role should you be assigned?

Choose the correct answer

- Reader on the subscription that contains the Microsoft Sentinel workspace
- Reader on the resource group that contains the Microsoft Sentinel workspace
- Contributor on the subscription that contains the Microsoft Sentinel workspace
- Contributor on the resource group that contains the Microsoft Sentinel workspace

---

### Answer:
- Contributor on the subscription that contains the Microsoft Sentinel workspace

You should be assigned the Contributor role on the subscription that contains the Microsoft Sentinel workspace. In addition to all of the permissions provided with the Reader role, with the Contributor role, you can create and edit all Microsoft Sentinel resources. It is the only role that allows a user to deploy Microsoft Sentinel, and it must be applied at the subscription level as that is where Sentinel must be deployed. Assigning the permissions at the subscription level will propagate down to all resource groups, which means less administrative effort.
You should not be assigned the Reader role on the subscription that contains the Microsoft Sentinel workspace or on the resource group that contains the Microsoft Sentinel workspace. The Reader role is not enough to enable Microsoft Sentinel regardless of where those permissions are granted. This only allows for the review of Sentinel data after it has been deployed. Although it is often a great choice for least privilege, in this scenario, it would not be enough to get the task completed.
You should not be assigned the Contributor role on the resource group only, as this role will need to be assigned for the entire subscription. As Microsoft Sentinel will be aggregating data from across your entire subscription, having the Contributor role at that level is critical for the specific task of initially deploying the solution.

---

### References

[Roles and permissions in Microsoft Sentinel]()
Create a Microsoft Sentinel workspace

---

## Q027:

Your organization uses Microsoft Azure and Amazon Web Services (AWS) cloud platforms.
You implement Microsoft Defender for Cloud CSPM service to scan vulnerabilities and compliance issues in your environment.
You need to identify the process by which the AWS Identity provider validates the Microsoft Entra token against the Microsoft Entra ID before a vulnerabilities and compliance scan can take place.

Which three validation conditions are included in this process? 
Each correct answer presents part of the solution.

Choose the correct answers

- audience validation
- expiration check
- token digital signature validation
- certificate thumbprint
- Issuer validation

---

### Answer:
- audience validation
- token digital signature validation
- certificate thumbprint

Cloud security posture management (CSPM) is part of the broader Microsoft Defender for Cloud suite, which also includes services for threat protection, identity and access management, and data protection. It supports various cloud platforms, including Microsoft Azure, Amazon Web Services (AWS), and Google Cloud Platform (GCP).
Validation conditions for AWS identity provider include:

- audience validation
- token digital signature validation
- certificate thumbprint

Audience validation ensures that the token is intended for the specific application or service that is trying to
use it. This helps prevent token misuse or replay attacks.
Token digital signature validation ensures that the token was indeed issued by a trusted authority and has not been tampered with.

Certificate thumbprint validation checks whether the thumbprint of the certificate used to sign the token matches the expected thumbprint. This helps ensure that the certificate used to sign the token is the one expected by the system.

Issuer validation and expiration check are not directly related to the validation of the Microsoft Entra token against Microsoft Entra ID, as they pertain to different aspects of token validation or management.

---

### References

[Connect your AWS account to Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-aws)  
[Cloud Security Posture Management (CSPM)](https://learn.microsoft.com/de-de/azure/defender-for-cloud/concept-cloud-security-posture-management)  
[New AWS connector in Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/defender-for-cloud/episode-one)  

---

## Q026:

You manage a complex heterogeneous infrastructure across various clouds, data centers, edge locations, and on-premises servers in a centralized, unified way. The IT department faces challenges in implementing a centralized, unified way of protecting this diverse environment.
You need a solution to streamline management and reduce complexity.
What is the most efficient solution that you should implement to meet the requirements?

Choose the correct answer

- Windows Server Update Services
- Operations Manager
- Azure Arc
- Configuration manager

---

### Answer:
- Azure Arc

You should implement Azure Arc. Azure Arc is the most efficient solution for managing a complex infrastructure across various clouds, data centers, and edge locations, with on-premises servers. Azure Arc is a set of technologies that extends Azure management and services to any infrastructure. It enables you to manage servers, Kubernetes clusters, and Azure data services across multiple environments, including on- premises, multi-cloud, and edge locations. With Azure Arc, you can use Azure management tools, such as Azure Policy, Azure Monitor, and Azure Security Center to manage resources consistently and centrally. This helps to streamline management, reduce complexity, and improve security and compliance across your entire infrastructure.
You should not implement Configuration Manager and Operations Manager. These solutions are part of Microsoft System Center, which is a suite of management tools for on-premises data centers. While these tools can help manage on-premises infrastructure, they may not be as effective for managing resources across various clouds, data centers, and edge locations.
You should not implement Windows Server Update Services (WSUS), WSUS is a tool for deploying updates to Windows servers in an on-premises environment. While this is an important aspect of managing on- premises servers, it does not address the broader challenges of managing a diverse infrastructure across multiple environments.

---

### References

[Azure Arc overview](https://learn.microsoft.com/en-us/azure/azure-arc/overview)  
[What is Configuration Manager?](https://learn.microsoft.com/en-us/mem/configmgr/core/understand/introduction)  
[Operations Manager](https://learn.microsoft.com/en-us/system-center/scom/welcome?view=sc-om-2022)  
[Windows Server Update Services (WSUS)](https://learn.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus)  

---

## Q025:

To reduce the attack surface, a company's security department initiated a project to discover unmanaged network devices by leveraging the new network device discovery capabilities available in the Device inventory of Microsoft Defender for Endpoint.
After several days, you notice that no new discovered devices are visible in the scan results.

Which three actions should you perform to resolve the issue? Each correct answer presents part of the solution.

Choose the correct answers

- Verify special configuration for Web Proxy Auto-discovery Protocol (WPAD).
- Verify that SNMP write access is enabled.
- Verify SNMP credentials.
- Verify that SNMP read-only access is enabled.
- Verify that SNMP traffic is allowed.

---

### Answer:

- Verify SNMP credentials.
- Verify that SNMP read-only access is enabled.
- Verify that SNMP traffic is allowed.

You should verify that SNMP traffic is allowed. SNMP (Simple Network Management Protocol) is used by Microsoft Defender for Endpoint to discover unmanaged network devices. If SNMP traffic is blocked or not allowed in the network, the discovery process will not work properly. Verifying that SNMP traffic is allowed ensures that the necessary communication can take place for device discovery.

You should also verify that SNMP read-only access is enabled. SNMP read-only access is typically sufficient for device discovery. Enabling only read access ensures that no unauthorized changes can be made to the devices being discovered. This is important for security reasons.

You should verify SNMP credentials too. The correct SNMP credentials are crucial for successful device discovery. If the credentials provided are incorrect or outdated, the discovery process will fail. Verifying that the correct credentials are being used ensures that the discovery process can access the devices.
You should not verify that SNMP write access is enabled. SNMP write access allows for the modification of device settings. However, write access is not typically needed for device discovery and can pose security risks. Therefore, it is recommended to only enable read-only access for SNMP.
You should not verify special configuration for Web Proxy Auto-discovery Protocol (WPAD). WPAD is used to automatically configure proxy settings for devices on a network. If Transparent proxy or WPAD is part of your network topology, no additional configuration settings are required.

---

### References

[Network device discovery and vulnerability assessments](https://techcommunity.microsoft.com/t5/microsoft-defender-vulnerability/network-device-discovery-and-vulnerability-assessments/ba-p/2267548)  

[Endpoint Discovery - Navigating your way through unmanaged devices](https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/endpoint-discovery-navigating-your-way-through-unmanaged-devices/ba-p/2248909)  

[Network device discovery and vulnerability management](https://learn.microsoft.com/en-us/defender-endpoint/network-devices)  

[Configure device discovery](https://learn.microsoft.com/en-us/defender-endpoint/configure-device-discovery)    

[Device discovery overview](https://learn.microsoft.com/en-us/defender-endpoint/device-discovery)  

[STEP 2: Configure your devices to connect to the Defender for Endpoint service using a proxy](https://learn.microsoft.com/en-us/defender-endpoint/configure-proxy-internet)  


---

## Q024:

You work for an organization that uses multiple Azure subscriptions to host Azure Cloud resources and has activated Microsoft Defender for Cloud. Defender for Cloud has identified unprotected resources, which you have remediated.

You utilize the Microsoft Defender for Cloud REST API to list secure scores for all your Cloud initiatives, and it provides the following output:

```
{
    "value": [ 
    {
        "id": "/subscriptions/10ac6cf1-d234-23ac-fk82x- a12547asgd31/providers/Microsoft.Security/secureScores/ascScore",
        "name": "ascScore",
        "type": "Microsoft.Security/secureScores",
        "properties": {
            "displayName": "ASC score",
            "score": {
                "max": 43,
                "current": 29.12,
                "percentage": 0.6772
            },        
        "weight": 77}
        }
    ]
}
```

Based on the security principle "Trust but verify," you need to verify the security posture using the Microsoft Defender for Cloud Secure Score.

For each of the following statements, select Yes if the statement is true. Otherwise, select No.

The current score is calculated using [Score per resource] * [Number of healthy resources]/[Number of unhealthy resources].
No

The relative weight for the Azure subscription 10ac6cf1-d234-23ac-fk82x- a12547asgd31 is 77.
Yes

To improve the Secure Score, you need to calculate the potential score increase and then apply remediation steps.
Yes

---

### Answer:

In the output provided, the current score is not calculated using: 

`[Score per resource] [Number of healthy resources]/[Number of unhealthy resources) `

The properties.score.current property, which provides the subscription's current score is calculated using: 

`[Score per resource] * [Number of healthy resources)`

The relative weight for the Azure subscription `10ac6cf1-d234-23ac-fk82x-a12547asgd31` is 77. 

The weight property is the relative weight of a specific Azure subscription. This weight property is used when we want to calculate an aggregated Microsoft Defender for Cloud Secure Score for multiple subscriptions.

To improve the Secure Score, you need to calculate the potential score increase and then apply remediation steps. Potential Score is calculated using [Score per resource] [Number of unhealthy resources]. The remaining points that are available within the control are provided by the potential score increase.

---

### References

[Remediate security risks in Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/azure/well-architected/security/monitor-threats)  

[Secure score](https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls)  

[Microsoft Defender for Cloud](https://learn.microsoft.com/en-us/rest/api/defenderforcloud/)

[Secure Scores - List](https://learn.microsoft.com/en-us/rest/api/defenderforcloud/secure-scores/list?view=rest-defenderforcloud-2020-01-01&tabs=HTTP)  

---

## Q023:

You are using Microsoft Defender for Endpoint and configuring roles for users. You are configuring roles for a Microsoft Entra group.
You need to assign a permission for a user that will allow them to manage email notifications in the Microsoft Defender XDR portal.

Which permission should you assign to the user?

Choose the correct answer

- View data - Defender Vulnerability Management
- View data - Security operations
- Active remediation actions - Security operations
- Manage security settings in Security Center

---

### Answer:
- Manage security settings in Security Center

You should assign Manage security settings in Security Center. This permission will allow the user to
manage the security settings in the Security Center, including permission to manage email notifications for
users in the Microsoft Defender XDR portal. With this permission, the user could enable an option to send
an email to users when an attack occurs, for example. The security settings also include the option to
implement folder exclusion for automation, which is used when an automated investigation is carried out
regarding specific folders where you can mark the folders that you want the automated investigation to skip.
You should not assign the View Data - Security operations permission. This permission would allow the user to view the data of security operations performed in the Microsoft Defender XDR portal.
You should not assign the View Data - Defender Vulnerability Management permission. This permission would allow the user to view data related to threat and vulnerability management in the Microsoft Defender XDR portal.
You should not assign the Active remediation actions Security operations permission. This permission. would allow the user to approve remediation actions or decline them in the Microsoft Defender XDR portal.

---

### References

[Create and manage roles for role-based access control](https://learn.microsoft.com/en-us/defender-endpoint/user-roles?view=o365-worldwide)   

[What is Microsoft Defender XDR?](https://learn.microsoft.com/en-us/defender-xdr/microsoft-365-defender)  

---

## Q022:

You use Microsoft 365 for Business in your organization.

To enhance security incident visibility, you have integrated Microsoft Defender XDR by connecting it to Microsoft Sentinel. Following an identity compromise, you acquired Microsoft Entra ID Protection licenses.
You need to ensure that the alerts and incidents from the newly purchased product are directed to Microsoft Sentinel.

For each of the following statements, select Yes if the statement is true. Otherwise, select No.


The newly purchased product will be automatically connected to Microsoft Sentinel in the background.
Yes

Connecting the newly purchased product to Microsoft Sentinel incurs additional fees.
No

The alerts and incidents from the new product will flow into Microsoft Sentinel without the need for further configuration.
Yes

---

### Answer:

The newly purchased product will be automatically connected to Microsoft Sentinel in the background. All integrated components and services are connected in the background when Microsoft Defender XDR is connected to Microsoft Sentinel. Therefore, when Microsoft Entra ID Protection is acquired, it is seamlessly integrated with Microsoft Sentinel without the need for additional configuration.
Connecting the newly purchased product to Microsoft Sentinel does not incur additional fees. When Microsoft Entra ID Protection licenses are acquired after the integration of Microsoft Defender XDR, the alerts and incidents from this new product are directed to Microsoft Sentinel without incurring extra fees. No additional charges are applied for connecting the newly purchased product with Microsoft Sentinel.
The alerts and incidents from the new product will flow into Microsoft Sentinel without the need for further configuration. The integration process is straightforward and does not need manual intervention.

---

### References

[Microsoft Defender XDR integration with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration?tabs=azure-portal)  

[Explore security solutions in Microsoft Defender XDR](https://learn.microsoft.com/en-us/training/modules/explore-security-solutions-microsoft-365-defender/)  

[What is Microsoft Defender for Identity?](https://learn.microsoft.com/en-us/defender-for-identity/what-is)  

---

## Q019-Q021:

Your company uses Microsoft Sentinel for threat detection.
Your manager reports that a significant number of Azure Storage account keys were recently enumerated without anyone being notified about the incident.
You need to configure Microsoft Sentinel to immediately alert you when such an incident occurs.

---

## Q021:

Solution: Create a hunting bookmark.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Hunting bookmarks are a Microsoft Sentinel tool that allows you to preserve queries that have already run in the Microsoft Sentinel Logs service, in addition to the query results. This solution also allows you to add notes and tags in order to record your contextual observations for incidents, but it does not allow you to send alerts upon detecting the enumeration of Azure Storage keys.

---

### References

[Keep track of data during hunting with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/bookmarks)  


---

## Q020:

Solution: Create a hunting livestream.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. To receive immediate alerts when Azure Storage account keys are enumerated, you should create a hunting livestream. Hunting livestreams are a tool in Microsoft Sentinel that allows you to use hunting queries for events, then receive a notification when an event matches the specification in a query. This solution means that you can create a livestream for the event of Azure Storage keys being enumerated and receive notifications whenever this incident occurs. To create a hunting livestream, you should access the Hunting page in the Microsoft Sentinel portal, locate a hunting query to use on the Queries tab, and then add a livestream to it.

---

### References

[Use hunting livestream in Microsoft Sentinel to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/livestream)  

---

## Q019:

Solution: Create an analytics rule.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Microsoft Sentinel Analytics Rules are a feature of Microsoft Sentinel, a cloud-native security information and event management (SIEM) platform. These rules are used to detect security threats and unusual activity in your environment by analyzing the data that flows through Azure
Sentinel.
Microsoft Sentinel Analytics Rules are created using a query language called Kusto Query Language (KQL), which is used to define the logic for identifying specific security events or patterns of activity that may indicate a security breach. These rules can be configured to trigger alerts, create incidents, or take other automated actions in response to specific security events. Although Microsoft Sentinel Analytics Rules can trigger alerts for your security operation center (SOC) team to triage, investigate and respond to threats, the alert is not triggered immediately, as requested in this scenario.

---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  

---

## Q016-Q018:

Your manager wants Microsoft Teams to send a message to the Security channel whenever there is an intended sign-in from a suspicious IP address. They ask you to find a solution.
You need to fulfill the manager's request.

---

## Q018:

Solution: Create a Palybook and assign it to an incident.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. To complete the manager's request, you should create a playbook in Microsoft Sentinel and assign it to an incident. Playbooks are sets of processes that may be executed in response to an alert or event. A playbook uses automation in responding to alerts by attaching an analysis rule or an automation rule when certain alerts or occurrences are produced. Assigning a playbook to an incident will allow you to use the playbook to provide the desired response, such as having a message sent from Microsoft Teams when a suspicious login is detected. In order to associate or assign a playbook to an incident, an automation rule should be created on the Microsoft Sentinel portal.

---

### References

[Tutorial: Respond to threats by using playbooks with automation rules in Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/automation/tutorial-respond-threats-playbook)  


---

## Q017:


Solution: Create a Workbook.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Workbooks in the Azure portal provide a broad canvas for data
analysis and the production of sophisticated visual reports. They enable you to connect to numerous data
sources throughout Azure and integrate them into cohesive interactive experiences. Workbooks do not
allow Microsoft Teams to send a message upon an incident occurring as required in the scenario.

---

### References

[Azure Workbooks](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-overview)  

---

## Q016:


Solution: Use the Microsoft Graph security API.
Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Microsoft Graph is a tool that enables users to create solutions that are authenticated once and use a single API call to act on security insights from security solutions. The Microsoft Graph security API connects Microsoft security products, services, and partners in order to improve threat protection, detection, and response capabilities. Microsoft Graph includes features like the calendar feature for Outlook, which allows users to set up appointments, and the files feature for SharePoint and OneDrive, which enables users to manage files on SharePoint and OneDrive.

---

### References

[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  
[Microsoft Graph security API overview](https://learn.microsoft.com/en-us/graph/security-concept-overview)  

---

## Q013-Q015:

You use Microsoft Defender for Office 365 in your organization. Your organization is overwhelmed with suspicious emails containing potentially harmful attachments. You configure an automated investigation in Microsoft Defender for Office 365 to deescalate the situation, but suspicious emails flood is not reduced.

You need to resolve the issue.

---

## Q015:

Solution: You configure a policy alert trigger based on unusual activity.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. By configuring a policy alert trigger based on unusual activity, you can effectively address the issue of an overwhelming flood of suspicious emails containing potentially harmful attachments. Microsoft sets a baseline value to determine the typical frequency of the chosen activity. This baseline is established over a period of up to seven days, during which no alerts will be generated. Once the baseline is set, an alert will be activated if the frequency of the activity monitored by the alert policy significantly surpasses the established baseline value.
This alert trigger will enable Microsoft Defender for Office 365 to detect and respond to unusual patterns or behaviors associated with suspicious emails, helping to reduce the flood of such emails and enhance overall security posture.

---

### References

[Alert policies in Microsoft 365](https://learn.microsoft.com/en-us/purview/alert-policies)  

[Automated investigation and response (AIR) in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/air-about)  

[Address compromised user accounts with automated investigation and response](https://learn.microsoft.com/en-us/defender-office-365/address-compromised-users-quickly)    

---

## Q014:


Solution: You customize and enable an alert policy.
Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. Customizing and enabling an alert policy can effectively address the challenge of managing the influx of suspicious emails with potentially harmful attachments. By tailoring alert policies to detect and respond to such threats, organizations can enhance their ability to identify and mitigate security risks more efficiently.
Microsoft Defender for Office 365 generates billions of signals daily to detect various types of malicious emails. If an email is automatically blocked, deleted, or otherwise neutralized, no alert is generated, as no further action is required from the security team.
In cases where suspicious emails are not identified and neutralized before delivery, no alert is generated. Several typical reasons for this include Zero-hour Auto Purge (ZAP), user-initiated security incidents resulting from inadvertent engagement with malicious content (such as clicking on phishing links or downloading malware), URLs weaponized at the time of click, and other factors.
To address this issue, specific alert policies need to be configured to trigger alerts when suspicious activities are detected. These alerts can then be investigated by the security team, or an automated investigation can be initiated.

---

### References

[Investigating Alerts in Defender for Office 365](https://techcommunity.microsoft.com/t5/microsoft-defender-for-office/investigating-alerts-in-defender-for-office-365/ba-p/1824188)  
[Threat investigation and response](https://learn.microsoft.com/en-us/defender-office-365/office-365-ti)  

---

## Q013:

Solution: You create a security playbook.
Does this solution meet the goal?

---

### Answer:
No

The solution does not meet the goal. A security playbook is a predefined set of procedures or actions that are triggered automatically or manually in response to specific security incidents or events. These playbooks outline the steps to be taken to investigate, mitigate, and remediate security threats or breaches effectively and efficiently. They typically include a sequence of actions, such as gathering additional information, analyzing logs or data, notifying relevant stakeholders, applying containment measures, and initiating remediation actions. While creating a security playbook is a useful measure in reducing suspicious emails flood, some additional steps must occur, before a security playbook can start running.


---

### References

[Email analysis in investigations for Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/email-analysis-investigations)  

[Automated investigation and response (AIR) in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/air-about)    

[Investigating Alerts in Defender for Office 365]()

---

## Q009-Q012:

> General Backgrounf

You work at a company that specializes in managing information systems. The company's main office is based in your region and has several branches outside your country. The company uses Microsoft Sentinel.

> Current Environment

- A user in the IT department has created a storage account in Azure for their own personal use without their coordinator noticing.

- A member of the accounting team reports that several workbooks related to customers' data have been deleted in the Microsoft Sentinel workspace of the company.

- A member of the IT department reports that five incidents of high severity occurred in the past week.

- A new employee starts working at your company. You create a new account for the employee in Microsoft Entra ID. A colleague of the new employee reports that the new employee created a role assignment the moment they started working on their company device.

> New Environment

- An analytics rule should be created where the rule query logic will alert the IT coordinator when any user creates a storage account.

- The manager wants to view all delete operations performed in the company's Microsoft Sentinel workspace.

- The manager wants to run an investigation about the incidents occurring within the past 10 days so better analysis can be achieved.

- The manager wants to know when any new user in Microsoft Entra ID creates a role assignment.

---

## Q012:

You need to create a query for the rule logic to alert the IT coordinator when a storage account is created, as requested.
How should you complete the query? To answer, complete the commands by selecting the correct parts from the drop-down menus.

OPT1:
OperationName
Update Case Comments
Update Cases

OPT2:
ActivityStatusValue
OperationName
Update Settings

```
AzureActivity
| where [OPT1] == "Create Storage Account"
| where [OPT2] == "Succeeded"
| make-series dcount (ResourceId) default=0 on EventSubmissionTimestamp
in range (ago (7d), now(), 1d) by Caller
```

```
AzureActivity
| where OperationName == "Create Storage Account"
| where ActivityStatusValue == "Succeeded"
| make-series dcount (ResourceId) default=0 on EventSubmissionTimestamp
in range (ago (7d), now(), 1d) by Caller
```

---

### Answer:

You should complete the query as follows:

```
AzureActivity 
| where OperationName == "Create Storage Account 
| where ActivityStatusValue == "Succeed"
| make-series dcount (Resourceld) default=0 on EventSubmissionTimestamp in range (ago (7d), now(), id) by Caller
```

You should use OperationName in the first line. This expression is a required expression in the query for the
rule being created. OperationName is the expression that is used to define the operation that the IT
coordinator should be notified about. You can see that the expression is followed by the Create Storage Account expression, so the coordinator will be notified upon the creation of a storage account, as requested.
You should not use Update cases in the first line. This expression defines the action of updating a case when you investigate it. This is part of the Security Insights category, not Azure Activity.
You should not use Create case comments in the first line. This expression defines the action of creating comments for cases being investigated, which is a beneficial activity while investigating a case. This activity is also part of the Security Insights category and not Azure Activity.
You should use Activity Status Value in the second line. This expression is required in the above query to define if the activity performed by the user succeeded and, for example, if account storage is created. In such a way, the rule would detect that the activity has been done successfully in order to inform the IT coordinator about it. The Activity Status Value expression can be followed by succeeded or failed expressions. The last portion of the provided query is also required to count all the records within your Azure that match the conditions you specify related to the defined activity of creating a storage account during the specified time frame.
You should not use OperationName in the second line. This expression is used to define the activity performed by a user, as seen in the first line. There is no 'succeeded' operation or activity in the query.
You should not use Update settings in the second line. This expression defines the activity of updating settings in Security Insights. It cannot be used here for two reasons: the first is that this is not the required activity, and the second is that this expression cannot be used to define if the operation succeeded or not.

---

### References

[Audit Microsoft Sentinel queries and activities](https://learn.microsoft.com/en-us/azure/sentinel/audit-sentinel-data)  
[Azure Sentinel Create custom analytics rules to detect threats](https://connectioncloudsupport.zendesk.com/hc/en-us/articles/900006664846-Azure-Sentinel-Create-custom-analytics-rules-to-detect-threats#:~:text=Azure%20Sentinel%20-%20Create%20custom%20analytics%20rules%20to,5%20View%20the%20rule%20and%20its%20output%20)  

---

## Q011:

You need to use the AzureActivity table query to fulfill the manager's request of viewing delete operations.

```
AzureActivity
| where OperationNameValue contains "?"
| where OperationName contains "?"
| where ActivityStatusValue contains "Succeeded"
```

Which two sections of code should you use to complete the query? 
Each correct answer presents part of the solution.

- ago(1d)
- SecurityInsights
- Delete alert rules
- Delete data connectors
- Delete workflow
- Delete

---

### Answer:
- SecurityInsights
- Delete

You should complete the query as follows:

1. AzureActivity
2. | where OperationNameValue contains "SecurityInsights"
3. | where OperationName contains "Delete"
4. | where ActivityStatusValue contains "Succeeded"

You should use SecurityInsights in line 2. This filter condition narrows down the results to only those logs where the OperationNameValue field contains the term SecurityInsights. This ensures that only activities related to security insights are included in the results.
Additionally, you should use Delete in line 3. This further filters the logs to only include records where the Operation Name field contains the term Delete. This filters for delete operations specifically, such as deleting resources or configurations related to security insights.
You should not use ago(1d). This expression is used to define time. This expression could be used in another query that states, for example, the operations carried out in the workspace in the past 24 hours. In this scenario, you need to define where you can view delete operations.
You should not use Delete workflow. This expression defines the activity of deleting a workflow in Microsoft Sentinel performed by a user. This expression is not related to deleting a workbook. Workflows in Microsoft Sentinel are created for several reasons, such as to create an automated response for alerts where Microsoft Sentinel acts upon suspicious activity done by a user.
You should not use Delete data connectors. This expression is related to the operation of deleting a data connector. Data connectors are used to connect data resources with each other upon implementing Microsoft Sentinel. This operation is not mentioned in the scenario.
You should not use Delete alert rules. This expression is related to deleting alert rules. Alert rules are configured within analytics rules to alert the user when a match occurs. Analytic rules detect and identify threats by matching the presence of signs and signals that impact the existence of a cyber-attack. They can also identify the origin of a cyber-attack and the potential loss of data that occurred due to the attack. This is not a mentioned requirement in the scenario.


---

### References

[Create custom analytics rules to detect threats](https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal)  
[Audit Microsoft Sentinel queries and activities](https://learn.microsoft.com/en-us/azure/sentinel/audit-sentinel-data)  

---

## Q010:

You need to find a solution that provides data for the manager about creating new role assignments.
What action should you perform?

- Use the SecurityIncident table in Microsoft Sentinel.
- Use data retention in Microsoft Defender for Endpoint.
- Use a Windows Security Events connector.
- Use Azure Lighthouse.

---

### Answer:
- Use the SecurityIncident table in Microsoft Sentinel.

You should use the SecurityIncident table in Microsoft Sentinel. This table is found in the Logs section in Microsoft Sentinel, where you can view all the incidents that are created or updated, including those related to creating role assignments by new users. This meets the scenario requirement. Every time an incident is created or updated, a new log is added to the SecurityIncident table.
You should not use data retention in Microsoft Defender for Endpoint. Data retention is used for retaining data, like documents and files, that you need, and getting rid of items that you do not need. Data retention cannot be used to view the logs of creating a new role assignment.
You should not use Azure Lighthouse. Azure Lighthouse is a solution that allows you to manage an Microsoft Sentinel workspace outside your tenant. Microsoft Sentinel is a security information event management (SIEM) system that provides security analytics for companies. Azure Lighthouse will not provide data about creating new role assignments.
You should not use a Windows Security Events connector. Windows Security Events connector is used to stream security events from any Windows server linked with your Microsoft Sentinel workspace. Nothing in the scenario mentions a Windows server.


---

### References

[Manage your SOC better with incident metrics](https://learn.microsoft.com/en-us/azure/sentinel/manage-soc-with-incident-metrics)  

[Configure general Defender for Endpoint settings](https://learn.microsoft.com/en-us/defender-endpoint/preferences-setup)  

[Using Azure Lighthouse and Microsoft Sentinel to Investigate Attacks Across Multiple Tenants](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/using-azure-lighthouse-and-azure-sentinel-to-investigate-attacks/ba-p/1043899)  

[Find your Microsoft Sentinel data connector](https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference?tabs=LAA)  

---

## Q009:

You need to recommend a solution that enables you to run an investigation as required by the manager.

Which solution should you recommend?

- Create a hunting bookmark.
- Use Microsoft Graph.
- Create a workbook in Microsoft Sentinel.
- Use Data Loss Prevention (DLP) Policies.

---

### Answer:
- Create a workbook in Microsoft Sentinel.

You should recommend creating a workbook in Microsoft Sentinel. Workbooks in the Azure portal provide a broad canvas for data analysis and the production of sophisticated visual reports. They enable you to connect to numerous data sources throughout Azure and integrate them into cohesive interactive experiences. In addition to that, they use queries to run investigations related to incidents occurring in the company within a defined time frame, such as 10 days before the incident occurred. This option meets the scenario requirement.
You should not recommend creating a hunting bookmark. Hunting bookmarks are a Microsoft Sentinel tool that allow you to preserve queries that have already run in the Microsoft Sentinel - Logs service, in addition to the query results. This solution also allows you to add notes and tags in order to record your contextual observations for incidents. This does not meet the scenario requirement.
You should not recommend using Data Loss Prevention (DLP) policies. Using a DLP policy will allow you to ban the accidental sharing of sensitive information with people outside the organization. DLP can display a pop-up tip to employees to warn them about possible attempts to share sensitive data with people outside the organization. This solution does not allow you to run an investigation as required by the manager.
You should not recommend using Microsoft Graph. Microsoft Graph is a tool that enables users to create solutions that are authenticated once and use a single API call to act on security insights from security solutions. It does not allow you to run an investigation as required by the manager.

---

### References

[Visualize collected data](https://learn.microsoft.com/en-us/azure/sentinel/get-visibility)  

[Overview of Microsoft Graph](https://learn.microsoft.com/en-us/graph/overview)  

[Learn about Endpoint data loss prevention](https://learn.microsoft.com/en-us/purview/endpoint-dlp-learn-about?view=o365-worldwide)  

[Keep track of data during hunting with Microsoft Sentinel](https://learn.microsoft.com/en-us/azure/sentinel/bookmarks)  

---

## Q006-Q008:

Your organization is a Managed Service Provider (MSP) tasked with managing Microsoft Sentinel workspaces for multiple customers. Many customers require the management of multiple workspaces for different environments or business units.
You need to manage Microsoft Sentinel workspaces across multiple Microsoft Entra tenants. The precise control over the delegated scopes and allowed permissions for each customer must be maintained.

---

## Q008:

Solution: Extend Microsoft Sentinel accross workspaces

Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. While extending Microsoft Sentinel across workspaces enables a unified incident view across multiple workspaces, and facilitating centralized management and monitoring of incidents, it operates seamlessly within a single Microsoft Entra tenant.

---

### References

[Extend Microsoft Sentinel across workspaces and tenants](https://learn.microsoft.com/en-us/azure/sentinel/extend-sentinel-across-workspaces-tenants)  

---

## Q007:

Solution: Use workspace manager

Does this solution meet the goal?

---

### Answer:
No

This solution does not meet the goal. Workspace Manager is a feature within the Microsoft Sentinel service that enables organizations to manage multiple workspaces for different environments or business units within a single Microsoft Entra tenant.

---

### References

[Centrally manage multiple Microsoft Sentinel workspaces with workspace manager](https://learn.microsoft.com/en-us/azure/sentinel/workspace-manager) 

---

## Q006:

Solution: Use Azure Lighthouse

Does this solution meet the goal?

---

### Answer:
Yes

This solution meets the goal. Azure Lighthouse is a suitable solution for managing Microsoft Sentinel workspaces across multiple Microsoft Entra tenants. Azure Lighthouse allows Managed Service Providers (MSPs) to manage customers' Azure resources from their own Microsoft Entra tenant, including Microsof Sentinel workspaces. With Azure Lighthouse, precise control over the delegated scopes and allowed permissions for each customer is maintained.

---

### References

[What is Azure Lighthouse?](https://learn.microsoft.com/en-us/azure/lighthouse/overview)  

---

## Q001-Q005:

> Overview

You are a Security & Compliance Analyst for CompanyA, which has an existing Microsoft 365 tenant. CompanyA has recently migrated its services to Microsoft 365 and is using the following services:

- Microsoft Entra ID to manage identity
- OneDrive for Business to facilitate users' home folders
- Exchange Online for email services
- SharePoint Online for document management
- Microsoft Teams to facilitate collaboration between internal teams and external partners

Now that the services are active, your organization has asked you to look at deploying Microsoft Defender for Endpoint to help to protect and remediate security issues on end-user devices. As the Security & Compliance Analyst, you are responsible for managing the security and compliance posture of the tenant.

> Existing Environments

The following table shows details of Microsoft Defender for Endpoint permissions for users:

|   Username  | Permissions |
|------------ | ----------- |
| AdminA@companyA.com  | Full access |
| AdminB@companyA.com  | Read-only Access |
| AdminC@companyA.com  | Read-only access |
| AdminD@CompanyA.com  | Full access |


The following table shows the end-user device details:

| Device Type | Operating System | OS Version | No. of devices |
|-------------|------------------|------------|----------------|
| Laptop      | Windows 10       | 1511       | 150 |
| Laptop      | Windows 10       | 1607       | 850 |
| Desktop     | Windows 10       | 1511       | 200 |

- Old third party antivirus has been removed from Desktop devices and substituted with Microsoft Defender Antivirus.
- Microsoft Defender Antivirus has recently been deployed to all Laptop Windows 10 OS devices.
- Cloud-based protection is enabled.
- The Microsoft Defender for Endpoint blocking file features are configured.

The following table shows the device browser details:


| Operating System  | No. of Devices  | Installed Browser Details|
|-------------------|---------------------|----------------------|
| Windows 10        | 150  | Microsoft Edge, Mozilla Firefox     |
| Windows 10        | 850  | Google Chrome, Mozilla Firefox      |
| Windows 10        | 200  | Mozilla Firefox                     |

- All users have the Microsoft Defender for Endpoint Plan 2 license.
- All installed browsers are configured with Internet browsing proxy settings.
- All users can access to the internet using respective browser installed on their systems.

> Requirements:

- AdminC is new to the team and requires the relevant permissions to be assigned.
- You need to ban potentially malicious files or suspected malware.
- You need to onboard all end-user devices into the Defender for Endpoint portal.
- You need to implement real-time endpoint detection and built-in remediation via Intune to add an additional layer of protection to devices.
- You need to configure device isolation to help to prevent attackers from being able to control devices.

---

## Q005:

AdminD configures device isolation on the end-user devices. However, during testing you find that it is not working on any of the devices.
What is the cause for the device isolation failing to work?

- The Windows 10 devices need to be upgraded to Windows 11.
- You need a Microsoft 365 E5 license.
- The Windows 10 devices need to be version 1703 or later.
- AdminD needs elevated permissions to the Microsoft Defender for Endpoint portal.

---

### Answer:
- The Windows 10 devices need to be version 1703 or later.

Windows 10 devices need to be version 1703 or later. Full isolation of devices is available for devices running Windows 11, Windows 10, version 1703 or later, Windows Server 2022, Windows Server 2019, and Windows Server 2016.
The fact that AdminD requires elevated permissions to the Microsoft Defender for Endpoint portal is not the cause of the issue. As shown in the permissions table, AdminD has full access, which will allow them to successfully implement device isolation.
Windows 10 devices does not need to be upgraded to Windows 11. Although this would resolve the issue, it is not a requirement, as the devices need to be Windows 10 version 1703 or later. Upgrading to Windows 11 would be an option but not a requirement.
You do not need a Microsoft 365 E5 license. As shown in the Existing Environment section, users currently have Microsoft Defender for Endpoint Plan 2, which is sufficient to allow the implementation of device isolation.

---

### References

[Take response actions on a device](https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts?view=o365-worldwide)  


---

## Q004:

Once the end-user devices have been correctly onboarded, you need to configure additional capabilities to meet the business requirements.
Which capability should you configure to add the requirement for an additional layer of protection to devices?

- Next-Generation Protection (NGP)
- Microsoft Defender Vulnerability Management
- Microsoft Defender Experts capability
- Attack Surface Reduction

---

### Answer:
- Microsoft Defender Vulnerability Management

You should configure Microsoft Defender Vulnerability Management to meet the requirements for real-time endpoint detection and built-in remediation via Intune. This is a component of Defender for Endpoint that provides admins and operators with many features including built-in remediation.
You should not configure Next-Generation Protection (NGP) to meet the requirements for real-time endpoint detection and built-in remediation via Intune. NGP is a feature of Microsoft Defender Antivirus that enables next generation protection of end-user devices. As the requirement is for real-time endpoint detection and built-in remediation via Intune, NGP does not allow to facilitate these specific requirements.
You should not configure Attack Surface Reduction to meet the requirements for real-time endpoint detection and built-in remediation via Intune. Attack Surface Reduction enables attack surface reduction capabilities in Defender for Endpoint to help protect devices and application from new emerging threats. As the requirement is for real-time endpoint detection and built-in remediation via Intune, Attack Surface
Reduction does not allow to facilitate these specific requirements.
You should not configure Microsoft Defender Experts capability to meet the requirement for real-time endpoint detection and built-in remediation via Intune. This is a managed hunting service that enables SOC team's expert level monitoring and analysis to assist them with critical threats.

---

### References

[Configure Microsoft Defender for Endpoint capabilities](https://learn.microsoft.com/en-us/defender-endpoint/onboard-configure?view=o365-worldwide)  


---

## Q003:

AdminD is working on onboarding all end-user devices in the Microsoft Defender for Endpoint portal. However, they find that 200 of the devices are not being displayed in the portal. You need to investigate the issue.

Which two actions should you perform to successfully onboard end-user devices in the Microsoft Defender for Endpoint? Each correct answer presents part of the solution.

- Ensure the devices have an internet connection.
- Verify the Microsoft Windows HTTP (WinHTTP) settings.
- Ensure that Microsoft Defender Antivirus is not disabled by a policy.
- Ensure Google Chrome is installed.
- Ensure Internet Explorer is installed.

---

### Answer:
- Verify the Microsoft Windows HTTP (WinHTTP) settings.
- Ensure that Microsoft Defender Antivirus is not disabled by a policy.

You should Verify the Microsoft Windows HTTP (WinHTTP) settings. WinHTTP provides a standardized interface to send HTTP and HTTPS requests and receive responses from web servers. In order to report sensor data and communicate with the Microsoft Defender for Endpoint service, the use of Microsoft Windows HTTP (WinHTTP) is required by the sensor of Microsoft Defender for Endpoint. Because WinHTTP operates independently from the proxy settings used for internet browsing and other applications that are context-dependent, it is necessary for WinHTTP to identify the available proxy servers within the specific environment it is being used in.
You should also ensure that Microsoft Defender Antivirus is not disabled by a policy. To function correctly, the Microsoft Defender for Endpoint agent requires the Early Launch Antimalware (ELAM) driver to be activated. It is important to confirm that a system policy has not disabled it. Depending on the policy implementation tool being used, it is necessary to check that the Windows Defender policies listed below are not enabled:

- DisableAntiSpyware
- Disable AntiVirus

Because old third party antivirus has been removed from Desktop devices and substituted with Microsoft Defender Antivirus, it is possible, that the above mentioned policies are still activated as a previous requirement for removed third party antivirus software. As such, the policy have to be verified and disabled.
You should not ensure that devices have internet connection. According to the Existing environment section, all users can access the internet using respective browser installed on their systems.
You should not ensure that any specific browser is installed. Onboarding into Microsoft Defender for Endpoint does not specify any specific browser requirements. Specific browser only required to access Microsoft Defender for Endpoint administration portal, but not for onboarding.

---

### References

[Troubleshoot Microsoft Defender for Endpoint onboarding issues](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-onboarding)  

[About WinHTTP](https://learn.microsoft.com/en-us/windows/win32/winhttp/about-winhttp)  

[Minimum requirements for Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/minimum-requirements?view=o365-worldwide)  

---

## Q002:

You need to use PowerShell to assign AdminC the relevant permissions to the Microsoft Defender for Endpoint portal.
Which cmdlets should you use? To answer, complete the commands by selecting the correct options from the drop-down menus.

OPT1:

Add-MsolRoleMember
Get-MsolRoleMember
Add-MsolGroupMember
New-MsolUser

OPT2:

"Security Reader"
"Compliance Reader"
"Security Operator"
"Security Administrator"

OPT3:

-RoleMemberEmailAddress
-RoleMemberType
-RoleMemberObjectId
-TenantId

```
[OPT1] -RoleName [opt2] [OPT3] "AdminC@companyA.com"
```

---

### Answer:

```
Add-MsolRoleMember -RoleName "Security Reader" `
-RoleMemberEmailAddress  "AdminC@companyA.com" 
```

You should complete the PowerShell cmdlet as follows:

```
Add-MsolRoleMember -RoleName "Security Reader" -RoleMemberEmailAddress "AdminC@companyA.com"
```

You need to use the Add-MsolRoleMember cmdlet. This allows you to add a user with an administrator role. In this case, you need to grant AdminC read only permissions. Therefore, you should use the 'Security Reader' RoleName parameter. Finally, you need to use the - RoleMemberEmailAddress parameter to specify AdminC's email address so that the permissions are granted to them.
You should not use the Add-MsolGroupMember cmdlet, as this adds users to an existing security group. The Get-Msol RoleMember group should not be used as this only gives you information on a specific role, rather than allowing you to assign permissions. The New-MsolUser should not be used as this allows you to create a new user in Azure AD, rather than adding elevated permissions to a user.
You should not use the 'Security Administrator' parameter, as this would grant AdminC full access to the Microsoft Defender for Endpoint portal. The 'Security Operator' role would also give AdminC more elevated permissions than read only. The 'Compliance Admin' role would give AdminC access to the Microsoft Purview Compliance portal, not the Microsoft Defender for Endpoint portal.
You should not use the -Tenantld, RoleMember Objectld or the RoleMemberType parameter, as these parameters would not assign the relevant permissions to the user via the email address that has been used in the cmdlet.

---

### References

[Use basic permissions to access the portal](https://learn.microsoft.com/en-us/defender-endpoint/basic-permissions?view=o365-worldwide)  

Add-MsolRoleMember
Add-MsolGroup Member
Get-MsolRoleMember
New-MsolUser

---

## Q001:

AdminA tries to implement indicators for files in order to ban potential malicious files or suspected malware However, you find that it does not work on the existing user devices.

Which action should you take to implement indicators for files? 
You need to minimize administrative effort.

- Upgrade Windows 10 to Windows 11.
- Upgrade Windows 10 to version 1703 or later.
- Give AdminA more elevated permissions.
- Upgrade Microsoft Defender Antivirus to client version 4.18.1901.x or later.

---

### Answer:
- Upgrade Windows 10 to version 1703 or later.

You should upgrade Windows 10 OS to version 1703 or later. A prerequisite of implementing indicators for files is that end-user devices are required to be Windows 10, version 1703 or later. The Windows Server supported OS are Server 2016 and 2019.
You should not upgrade Windows 10 to Windows 11. Although this would resolve the issue, upgrading Windows 10 to Windows 11 would create additional administrative effort compared to upgrading the Windows 10 OS version, which is a simple Windows update.
You should not upgrade Microsoft Defender Antivirus to client version 4.18.1901.x or later. As highlighted in the existing environment section, Microsoft Defender Antivirus has recently been installed. The latest
versions are more recent than version 4.18.1901.x.
You should not elevate AdminA's permissions. AdminA currently has full access to the Microsoft Defender for Endpoint portal, which grants them the relevant permissions to implement indicators for files.

---

### References

[Manage indicators](https://learn.microsoft.com/en-us/training/modules/configure-settings-for-alerts-detections-microsoft-defender-for-endpoint/5-manage-indicators)  

---